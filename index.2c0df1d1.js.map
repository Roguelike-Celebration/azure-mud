{"mappings":"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","sources":["server/src/types.ts","src/storage.ts","src/components/feature/RainbowGateViews.tsx","src/components/feature/DullDoorViews.tsx","src/components/feature/FullRoomIndexViews.tsx","src/linkActions.ts","src/utils.ts","src/videochat/mediaChatContext.tsx","src/components/HeldItemView.tsx","src/components/NameView.tsx","src/components/PresenceView.tsx","src/components/Rainway/StreamSelector.tsx","src/components/Rainway/Widget.tsx","src/components/Rainway/RainwayStreamView.tsx","src/components/RoomView.tsx","src/message.ts","src/components/MessageView.tsx","src/components/ChatView.tsx","src/components/InputView.tsx","src/SlashCommands.ts","src/reducer.ts","src/components/ProfileView.tsx","src/components/LocalMediaView.tsx","src/videochat/twilio/AudioTrack.tsx","src/videochat/twilio/VideoTrack.tsx","src/videochat/twilio/useMediaStreamTrack.ts","src/videochat/twilio/useVideoTrackDimensions.ts","src/videochat/twilio/Publication.tsx","src/videochat/twilio/useTrack.tsx","src/videochat/twilio/ParticipantTracks.tsx","src/videochat/twilio/usePublications.ts","src/components/ParticipantChatView.tsx","src/components/MediaChatButtonView.tsx","src/components/MediaChatView.tsx","src/components/ProfileEditView.tsx","src/components/MenuButtonView.tsx","src/components/MapView.tsx","src/components/MiniMapView.tsx","src/components/SideNavView.tsx","src/components/NoteView.tsx","src/components/NoteWallView.tsx","src/components/ModalView.tsx","src/components/VideoAudioSettingsView.tsx","src/components/SettingsView.tsx","src/components/MediaSelectorView.tsx","src/components/CodeOfConductView.tsx","src/components/ScheduleView.tsx","src/components/HelpView.tsx","src/components/MapModalView.tsx","src/components/LoggedOutView.tsx","src/components/WelcomeModalView.tsx","src/components/GoHomeView.tsx","src/components/YouAreBannedView.tsx","src/components/RoomListView.tsx","src/components/ServerSettingsView.tsx","src/components/ClientDeployedModal.tsx","src/components/HappeningNowView.tsx","src/components/VerifyEmailView.tsx","src/components/EmailVerifiedView.tsx","src/components/RiddleModal.tsx","src/speechRecognizer.ts","src/videochat/twilioChatContext.tsx","src/App.tsx","src/index.tsx"],"sourcesContent":["import { Room } from './rooms'\nimport { User, MinimalUser, PublicUser } from './user'\nimport { RoomNote } from './roomNote'\n\nexport interface HappeningNowEntry {\n  text: string,\n  roomId?: string,\n  externalLink?: string\n}\n\nfunction isHappeningNowEntry (obj: any): obj is HappeningNowEntry {\n  return obj.text && (typeof obj.text === 'string' || obj.text instanceof String) &&\n    obj.roomId ? (typeof obj.roomId === 'string' || obj.roomId instanceof String) : true &&\n    obj.externalLink ? (typeof obj.externalLink === 'string' || obj.externalLink instanceof String) : true\n}\n\nexport interface ServerSettings {\n  movementMessagesHideThreshold: number;\n  movementMessagesHideRoomIds: string[];\n  happeningNowEntries: HappeningNowEntry[];\n  spaceIsClosed: boolean\n  webhookDeployKey?: string\n}\n\nexport const DEFAULT_SERVER_SETTINGS: ServerSettings = {\n  movementMessagesHideThreshold: 20,\n  movementMessagesHideRoomIds: ['theater'],\n  happeningNowEntries: [],\n  spaceIsClosed: false\n}\n\n// There's 100% a more elegant way to do this, but I think this works and want to actually get this feature finally done.\nexport function toServerSettings (obj: Partial<ServerSettings>): ServerSettings | null {\n  try {\n    if (obj.movementMessagesHideThreshold === undefined || obj.movementMessagesHideRoomIds === undefined ||\n        (obj.happeningNowEntries && !obj.happeningNowEntries.every(isHappeningNowEntry))) {\n      console.log('Returning null in toServerSettings')\n      return null\n    } else {\n      return {\n        movementMessagesHideThreshold: obj.movementMessagesHideThreshold,\n        movementMessagesHideRoomIds: obj.movementMessagesHideRoomIds,\n        happeningNowEntries: obj.happeningNowEntries || [],\n        spaceIsClosed: !!obj.spaceIsClosed\n      }\n    }\n  } catch (e) {\n    console.log('Error in toServerSettings', e)\n    return null\n  }\n}\n\nexport interface RoomResponse {\n  roomId: string;\n  presenceData?: { [roomId: string]: string[] };\n  users?: { [userId: string]: MinimalUser };\n  roomData?: { [roomId: string]: Room };\n  profile?: PublicUser;\n  roomNotes?: RoomNote[]\n}\n\nexport interface ErrorResponse {\n  error: string;\n}\n\nexport interface ProfileResponse {\n  user: User;\n}\n\nexport enum ValidColors {\n  Blue = 'Blue',\n  Cyan = 'Cyan',\n  Green = 'Green',\n  Magenta = 'Magenta',\n  Orange = 'Orange',\n  Red = 'Red',\n  Violet = 'Violet',\n  Yellow = 'Yellow'\n}\n\nexport enum ValidFontRewards {\n  Comic = 'Comic',\n  Classic = 'Classic',\n  Impactful = 'Impactful'\n}\n","import { Message, WhisperMessage } from './message'\nimport localforage from 'localforage'\n\n// Message cache\n\nexport async function getMessages (): Promise<{messages: Message[], whispers: WhisperMessage[]}|undefined> {\n  try {\n    const timestamp: Date = await localforage.getItem(messageTimestampKey)\n    const messages: Message[] = await localforage.getItem(messagesKey)\n    const whispers: WhisperMessage[] = await localforage.getItem(whisperKey)\n\n    // A janky way to say \"Is it older than an hour\"\n    if (timestamp && new Date().getTime() - timestamp.getTime() < 1000 * 60 * 60) {\n      console.log(messages, whispers)\n      return { messages, whispers }\n    }\n\n    // If we haven't returned yet, there's either no valid timestamp, or too old a timestamp\n  } catch (err) {\n    console.log('Storage error', err)\n  }\n}\n\nexport async function setMessages (messages: Message[], timestamp?: Date) {\n  await localforage.setItem(messagesKey, messages)\n  await localforage.setItem(messageTimestampKey, timestamp || new Date())\n}\n\nexport async function setWhispers (whispers: WhisperMessage[]) {\n  await localforage.setItem(whisperKey, whispers)\n}\n\n// Rainbow gate\n\nexport async function getGateVisits (): Promise<number> {\n  return await localforage.getItem(rainbowGateKey) || 0\n}\n\nexport async function incrementGateVisits () {\n  const visits = await getGateVisits() + 1\n  await localforage.setItem(rainbowGateKey, visits)\n  return visits\n}\n\n// Username coloring\n\nexport async function getWasColoredEntering (): Promise<boolean> {\n  return await localforage.getItem(wasColoredEnteringKey) || false\n}\n\nexport async function setWasColoredEntering (value: boolean) {\n  await localforage.setItem(wasColoredEnteringKey, value)\n}\n\n// Settings page\nexport async function setTheme (theme: string) {\n  await localforage.setItem(themeKey, theme)\n}\n\nexport async function currentTheme (): Promise<string> {\n  return await localforage.getItem(themeKey) || 'default'\n}\n\nexport async function setUseSimpleNames (useSimpleNames: boolean) {\n  await localforage.setItem(useSimpleNamesKey, useSimpleNames)\n}\n\nexport async function getUseSimpleNames (): Promise<boolean> {\n  return await localforage.getItem(useSimpleNamesKey) || false\n}\n\n// Video chat settings\nexport async function setKeepCameraWhenMoving (keepCameraWhenMoving: boolean) {\n  await localforage.setItem(keepCameraWhenMovingKey, keepCameraWhenMoving)\n}\n\nexport async function getKeepCameraWhenMoving (): Promise<boolean> {\n  const keepCameraWhenMoving: boolean = await localforage.getItem(keepCameraWhenMovingKey)\n  return keepCameraWhenMoving === null ? false : keepCameraWhenMoving\n}\n\nexport async function setTextOnlyMode (textOnlyMode: boolean) {\n  await localforage.setItem(textOnlyModeKey, textOnlyMode)\n}\n\nexport async function getTextOnlyMode (): Promise<boolean> {\n  const textOnlyMode: boolean = await localforage.getItem(textOnlyModeKey)\n  return textOnlyMode == null ? false : textOnlyMode\n}\n\nexport async function setCaptionsEnabled (enabled: boolean) {\n  await localforage.setItem(captionsEnabledKey, enabled)\n}\n\nexport async function getCaptionsEnabled (): Promise<boolean> {\n  const captionsEnabled: boolean = await localforage.getItem(captionsEnabledKey)\n  return captionsEnabled == null ? false : captionsEnabled\n}\n\n// Keys\n\nconst messagesKey = 'messages'\nconst messageTimestampKey = 'messageTimeStamp'\nconst whisperKey = 'whispers'\nconst rainbowGateKey = 'FeatureRainbowGateVisited'\nconst wasColoredEnteringKey = 'WasColoredEntering'\nconst themeKey = 'UserSelectedTheme'\nconst useSimpleNamesKey = 'UseSimpleNames'\nconst keepCameraWhenMovingKey = 'KeepCameraWhenMoving'\nconst textOnlyModeKey = 'TextOnlyMode'\nconst captionsEnabledKey = 'CaptionsEnabled'\n","import React, { useContext, useEffect, useState } from 'react'\nimport { DispatchContext, UserMapContext } from '../../App'\nimport { ValidColors } from '../../../server/src/types'\nimport { UpdateProfileColorAction, ShowModalAction } from '../../Actions'\nimport { Modal } from '../../modals'\nimport { getGateVisits, incrementGateVisits } from '../../storage'\n\n// When you pass through the ranbow door enough times, you get a randomly colored username\nexport const RainbowGateRoomView = () => {\n  function randomEnum<T> (anEnum: T): T[keyof T] {\n    const enumValues = (Object.values(anEnum) as unknown) as T[keyof T][]\n    const randomIndex = Math.floor(Math.random() * enumValues.length)\n    return enumValues[randomIndex]\n  }\n\n  const dispatch = React.useContext(DispatchContext)\n\n  const jumpThroughGate = async () => {\n    const newVisits = await incrementGateVisits()\n    dispatch(UpdateProfileColorAction(randomEnum(ValidColors)))\n    dispatch(ShowModalAction(Modal.FeatureRainbowGate))\n  }\n\n  return <div id=\"rainbow-gate-div\" className=\"feature-room-view\">\n    <p>Do you, in fact, approach the chair? <button id=\"rainbow-gate-button\" className='link-styled-button' onClick={jumpThroughGate}>Approach the chair.</button></p>\n  </div>\n}\n\nexport default function RainbowGateModalView () {\n  const { userMap, myId } = useContext(UserMapContext)\n\n  const [visits, setVisits] = useState(0)\n\n  useEffect(() => {\n    (async () => {\n      setVisits(await getGateVisits())\n    })()\n  }, [])\n\n  if (visits === 1) {\n    return (\n      <div>\n        <h1>It&apos;s a miracle of modern science!</h1>\n        <p>&quot;Oho! Why, you&apos;ve arrived just in time for the most amazing experience you&apos;ll ever... experience! Just sit in this chair, pull that lever, and you&apos;ll in for a truly eye-opening journey. Why, it&apos;s a miracle of modern science!&quot;</p>\n        <p>You sit in the chair (it&apos;s not especially comfortable and it&apos;s... slightly wet?) and pull the lever. There&apos;s a shudder as the machine rumbles to life and things start happening. Gears spin, lightning arcs up two metal trusses you hadn&apos;t noticed. Your hair begins to stand on end. The doctor (you didn&apos;t see any diplomas, so who&apos;s to say?) starts to cackle wildly, yelling, &quot;It works! It WORKS!&quot; to no one in particular. The machine&apos;s hum hits a crescendo when suddenly everything comes to a stop. All is silence. You wait for a moment when you hear a buzz above you.</p>\n        <p>Looking up, you see a mechanical arm holding a bucket extend out and rotate, spilling a bucket of paint all over you. &quot;Yes!&quot; yells the doctor (?) &quot;They said it couldn&apos;t be done! Now... if you&apos;ll excuse me, I need to clean the paint off the chair.&quot; They hold up a sponge and bucket of water and gesture at you to make yourself scarce.</p>\n        <p><em>Your chat name color is now <span className={`name ${userMap[myId].nameColor}`}>{userMap[myId].nameColor}</span></em>.</p>\n      </div>\n    )\n  } else {\n    return (\n      <div>\n        <h1>Back for more?</h1>\n        <p>The ambiguously credentialed operator gives you a nod. &quot;Back for more, huh? Er, wait, no. I mean... *ahem* So! You&apos;ve returned for another glimpse at the uncanny realities beyond human perception! Well sit right down and pull yon lever, my friend.&quot; They floridly gesture to the chair at the center of the paint-dumping apparatus.</p>\n        <p>You pull the lever and nothing appears to happen. Then the machine operator runs up with a bucket of paint and spills it all over you. &quot;So sorry, we only have the aetheric budget to do the big show once per person. Grant writing, am I right?&quot; They look you over. &quot;You know, you don&apos;t look that different to me, but what do I know?&quot; They tap the multi-lensed googles obscuring most of their face. &quot;With these things on it&apos;s a wonder I can see at all. Everything is coming through like an original Game Boy screen.&quot;</p>\n        <p><em>Your chat name color is now <span className={`name ${userMap[myId].nameColor}`}>{userMap[myId].nameColor}</span></em>.</p>\n      </div>\n    )\n  }\n}\n","import React, { useContext, useEffect, useState } from 'react'\nimport { DispatchContext, UserMapContext } from '../../App'\nimport { UpdateProfileColorAction, ShowModalAction, HideModalAction } from '../../Actions'\nimport { Modal } from '../../modals'\nimport * as Storage from '../../storage'\n\n// When you pass through the rainbow door enough times, you get a randomly colored username.\n// This undoes that.\nexport const DullDoorRoomView = () => {\n  const dispatch = React.useContext(DispatchContext)\n  const { userMap, myId } = useContext(UserMapContext)\n\n  const user = userMap[myId]\n\n  const walkThroughDoor = () => {\n    if (user.nameColor) {\n      Storage.setWasColoredEntering(true)\n    } else {\n      Storage.setWasColoredEntering(false)\n    }\n    dispatch(ShowModalAction(Modal.FeatureDullDoor))\n  }\n\n  return <div id=\"dull-door-div\" className=\"feature-room-view\">\n    <p>Inside the glass tube there&apos;s nothing in particular, though you note that there&apos;s a grate on the floor. A damp sign next to the tube&apos;s opening says &quot;Secondarily-Hydrogenated Oxygen Weighted Emulsion Remover&quot;. A smaller sign below that reads &quot;For Dirts, Dyes, and Distress!&quot; <button id=\"dull-door-button\" className='link-styled-button' onClick={walkThroughDoor}>Step on the grate</button>.</p>\n  </div>\n}\n\nexport default function DullDoorModalView () {\n  const dispatch = React.useContext(DispatchContext)\n\n  const [wasColoredEntering, setWasColoredEntering] = useState(false)\n\n  useEffect(() => {\n    (async () => {\n      setWasColoredEntering(await Storage.getWasColoredEntering())\n    })()\n  }, [])\n\n  const giveColor = () => {\n    dispatch(UpdateProfileColorAction(null))\n    dispatch(HideModalAction())\n  }\n  const leave = () => {\n    dispatch(HideModalAction())\n  }\n\n  if (!wasColoredEntering) {\n    return (\n      <div>\n        <h1>Refreshing!</h1>\n        <p>As you step into the tube, the grating beneath you depresses and clicks. Suddenly the machine gurgles and from openings the top of the tube, warm Secondarily-Hydrogenated Oxygen (miracle of the modern age!) streams down on you and rinses any Dirts, Dyes, or Distress you may have accrued away. It&apos;s soothing, in its own odd way, but you aren&apos;t sure this so-called S.H.O.W.E.R. will catch on with the masses.</p>\n      </div>\n    )\n  } else {\n    return (\n      <div>\n        <h1>Could be refreshing?</h1>\n        <p>You tentatively press a toe onto the grate. Suddenly the machine gurgles and from openings the top of the tube, warm Secondarily-Hydrogenated Oxygen (miracle of the modern age!) streams down! It certainly seems like any Dirts, Dyes, or Distress you may have accrued will be washed away if you step in fully. It&apos;ll probably be refreshing, but it will <em>definitely</em> take the paint from the doctor(?) with it.</p>\n        <p><strong>Fully enter the S.H.O.W.E.R.?</strong></p>\n        <button id='dull-door-agree' onClick={giveColor}>Enter</button>\n        <button id='dull-door-agree' onClick={leave}>Leave</button>\n      </div>\n    )\n  }\n}\n","import React from 'react'\nimport { DispatchContext } from '../../App'\nimport { ShowModalAction } from '../../Actions'\nimport { Modal } from '../../modals'\nimport { Room } from '../../room'\n\nexport const FullRoomIndexRoomView = () => {\n  const dispatch = React.useContext(DispatchContext)\n\n  const handleClick = () => {\n    dispatch(ShowModalAction(Modal.FeatureFullRoomIndex))\n  }\n\n  return <div id=\"full-room-index-div\" className=\"feature-room-view\">\n    <button id=\"full-room-index-button\" onClick={handleClick}>Read the book</button>\n  </div>\n}\n\nexport default function FullRoomIndexModalView (props: { rooms: Room[] }) {\n  return (\n    <div>\n      <h1>Unerring Teleport</h1>\n      <p>Verbal elements - either the True Name of the destination, the two common names of the destination, or the name of the destination from an adjoining location (which can only be known from that destination, and is colored in green for whatever reason). The name must exact, but the volume of the incantation is irrelevant.</p>\n      <p>Somatic elements - /go or /move</p>\n      <p>Material components - none</p>\n      <p>This spell will take you to whichever place you wish, hidden or not. The only issue is that the names of the hidden places are obscured by dark magics. I, the Great Wizard Teleportus, have researched long and hard, and at last produced a complete list of all the room in this space. Bow before my awesome intelligence!</p>\n      <p>Examples:</p>\n      <ul>\n        <li key='example-0'><em>/go hiddenPortalRoom</em> utilizes the true name to return here</li>\n        <li key='example-1'><em>/move leap into the shimmering portal</em> utilizes the name of the destination (&apos;leap into the shimmering portal&apos;) from the adjacent room (here)</li>\n        <li key='example-2'><em>/move Unconferencing: Sokoban</em> utilizes the first common name</li>\n        <li key='example-3'><em>/go the artists&apos; atelier</em> utilizes the second common name</li>\n      </ul>\n      <table>\n        <tbody>\n          <tr>\n            <th key='common-1-header'>common (first)</th>\n            <th key='common-2-header'>common (second)</th>\n            <th key='true-header'>true</th>\n          </tr>\n          {\n            props.rooms.map((e) => {\n              return <tr key={e.id}>\n                <td key={`common-1-${e.id}`}>{e.displayName}</td>\n                <td key={`common-2-${e.id}`}>{e.shortName}</td>\n                <td key={`true-${e.id}`}>{e.id}</td>\n              </tr>\n            })\n          }\n        </tbody>\n      </table>\n    </div>\n  )\n}\n","import { pickUpRandomItemFromList, pickUpItem, sendChatMessage, displayMessageFromList, updateFontReward, displayMessage } from './networking'\nimport { v4 as uuidv4 } from 'uuid'\n\nexport const linkActions = {\n  generateFood: () => {\n    pickUpRandomItemFromList('vendingMachineFood')\n  },\n  pickUpPuppy: () => {\n    pickUpItem('a tiny puppy')\n  },\n  drinkPolymorph: () => { // Listen. Is this the correct way? No. Does it save me needing to write a new httpTrigger? Yes.\n    sendChatMessage(uuidv4(), '/get colourful potion')\n  },\n  drinkCancellation: () => {\n    sendChatMessage(uuidv4(), '/get clear potion')\n  },\n  getFortune: () => {\n    sendChatMessage(uuidv4(), '/get fortune cookie')\n  },\n  readPoster: () => {\n    displayMessageFromList('motivationPosters')\n  },\n  readClosedSign: () => {\n    displayMessageFromList('closedSigns')\n  },\n  getGameRec: () => {\n    displayMessageFromList('gameRecommendations')\n  },\n  pentagramHighTech: () => {\n    pentagramAction('Impactful')\n  },\n  pentagramMinimalist: () => {\n    pentagramAction('Classic')\n  },\n  pentagramComical: () => {\n    pentagramAction('Comic')\n  },\n  pentagramNormal: () => {\n    pentagramAction('')\n  },\n  hearPickupLine: () => {\n    displayMessageFromList('pickupLines')\n  },\n  watchRobot: () => {\n    displayMessageFromList('robots')\n  }\n}\n\nconst pentagramAction = function (font: string) {\n  updateFontReward(uuidv4(), font)\n  sendChatMessage(uuidv4(), '/go ASCII')\n  displayMessage('You feel changed by your journey through the pentagram...')\n}\n","import Config from './config'\n\nexport const nie = <T extends unknown>(_: T): void => {\n  throw Error('Not Implemented')\n}\n","import React, { useContext } from 'react'\nimport { nie } from '../utils'\nimport * as Twilio from 'twilio-video'\n\nexport const MediaChatContext = React.createContext<MediaChatContextProps>({\n  prepareForMediaChat: async () => console.log('Not implemented'),\n  prepareMediaDevices: async () => console.log('Not implemented'),\n\n  publishMedia: () => console.log('Not implemented'),\n  publishAudio: () => console.log('Not implemented'),\n  unpublishMedia: () => console.log('Not implemented'),\n\n  publishingCamera: false,\n  publishingMic: false,\n\n  cameras: [],\n  mics: [],\n\n  setCurrentCamera: nie,\n  setCurrentMic: nie,\n\n  currentMic: undefined,\n  currentCamera: undefined,\n\n  localStreamView: React.createElement('div'),\n\n  inCall: false,\n  joinCallFailed: false,\n  joinCall: nie,\n  leaveCall: () => console.log('Not implemented'),\n\n  callParticipants: undefined,\n\n  cameraEnabled: false,\n  micEnabled: false,\n\n  setCameraEnabled: (enabled: boolean) => console.log('Not implemented'),\n  setMicEnabled: (enabled: boolean) => console.log('Not implemented')\n})\n\ntype MediaChatContextProps = {\n    // Request media permissions, also do any token handshaking needed\n    prepareForMediaChat: () => Promise<any>\n    prepareMediaDevices: () => Promise<any>\n\n    publishingCamera: boolean\n    publishingMic: boolean\n\n    cameras: DeviceInfo[]\n    mics: DeviceInfo[]\n\n    currentCamera?: DeviceInfo\n    currentMic?: DeviceInfo\n\n    setCurrentCamera: (deviceId: string) => void\n    setCurrentMic: (deviceId: string) => void\n\n    localStreamView: React.ReactNode\n\n    inCall: boolean\n    joinCallFailed: boolean // true if joinCall has thrown an exception\n    joinCall: (room: string, keepCameraWhenMoving: boolean) => void\n    leaveCall: () => void\n    // The Twilio implementation has an object referencing the active call.\n    // Does it conceptually make sense to add one to the public interface?\n\n    // Hide or show your camera/mic across the network\n    // Note that the Twilio implementation has publishVideo() as well,\n    // but we don't currently reference it externally.\n    publishMedia: () => void\n    publishAudio: () => void\n    unpublishMedia: () => void\n\n    callParticipants?: Map<String, Twilio.Participant>\n    cameraEnabled: boolean\n    micEnabled: boolean\n\n    setCameraEnabled: (enabled: boolean) => void\n    setMicEnabled: (enabled: boolean) => void\n}\n\nexport type Participant = {\n    userId: string\n    muted: boolean\n    streamView: React.ReactNode\n    shouldShow: boolean\n}\n\nexport type DeviceInfo = {\n    id: string\n    name: string\n}\n\nexport const useMediaChatContext = () => useContext(MediaChatContext)\n","import React, { useContext } from 'react'\n\nimport { UserMapContext } from '../App'\nimport { dropItem } from '../networking'\n\nconst HeldItemView = () => {\n  const { userMap, myId } = useContext(UserMapContext)\n  const user = userMap[myId]\n\n  const dropHeldItem = () => {\n    dropItem()\n  }\n\n  if (user.item) {\n    return (\n      <span>\n        You are holding {user.item}.{' '}\n        <button className=\"link-styled-button\" onClick={dropHeldItem}>\n          Drop it\n        </button>\n        .\n      </span>\n    )\n  } else {\n    return null\n  }\n}\n\nexport default HeldItemView\n","import React, { useContext } from 'react'\nimport { ContextMenu, MenuItem, ContextMenuTrigger } from 'react-contextmenu'\nimport { DispatchContext, SettingsContext, UserMapContext } from '../App'\nimport ReactTooltip from 'react-tooltip'\nimport {\n  BanToggleAction,\n  HideModalAction,\n  ModToggleAction\n} from '../Actions'\nimport { User } from '../../server/src/user'\n\nimport '../../style/nameView.css'\nimport { fetchProfile } from '../networking'\n\nexport default function NameView (props: { userId: string; id?: string; nowrap?: boolean }) {\n  const dispatch = useContext(DispatchContext)\n  const { useSimpleNames } = useContext(SettingsContext)\n  const { userMap, myId } = useContext(UserMapContext)\n\n  const user: User = userMap[props.userId]\n  const username = user && user.username\n  const isMod = user && user.isMod\n  const isBanned = user && user.isBanned\n\n  const player = userMap[myId]\n  const playerIsMod = player && player.isMod\n\n  const handleProfile = (e, data) => {\n    dispatch(HideModalAction())\n    fetchProfile(data.id)\n  }\n\n  const handleBan = (e, data) => {\n    const doBan = confirm(\n      `Are you sure you would like to ${isBanned ? 'unban' : 'ban'} the user '${\n        data.username\n      }'?`\n    )\n    if (doBan) {\n      dispatch(BanToggleAction(data.id))\n    }\n  }\n\n  const handleMod = (e, data) => {\n    const doMod = confirm(\n      `Are you sure you would like to ${isMod ? 'remove' : 'add'} the user '${\n        data.username\n      }' ${isMod ? 'from' : 'to'} the mod list?`\n    )\n    if (doMod) {\n      dispatch(ModToggleAction(data.id))\n    }\n  }\n\n  const banButton = playerIsMod ? (\n    <MenuItem\n      data={{ id: props.userId, username: username }}\n      onClick={handleBan}\n    >\n      {isBanned ? 'Unban' : 'Ban'}\n    </MenuItem>\n  ) : (\n    ''\n  )\n\n  const modButton = playerIsMod ? (\n    <MenuItem\n      data={{ id: props.userId, username: username }}\n      onClick={handleMod}\n    >\n      {isMod ? 'Remove Mod' : 'Make Mod'}\n    </MenuItem>\n  ) : (\n    ''\n  )\n\n  // #issue 43: Left click for dropdowns in addition to rightclick. Apparently disabling \"holdToDisplay\" can make this happen,\n  // not sure what the side effects are though.\n  // https://github.com/vkbansal/react-contextmenu/issues/50#issuecomment-335855193\n  //\n  // Tooltip: If no pronouns are set, no tooltip will show\n\n  var className = 'name'\n  if (!useSimpleNames && user && user.nameColor) {\n    className = className + ' ' + user.nameColor\n  }\n  if (!useSimpleNames && user && user.fontReward) {\n    className = className + ' font-' + user.fontReward\n  }\n  // TODO: should be best handled via css\n  const customStyle = { ['whiteSpace' as any]: props.nowrap ? 'nowrap' : undefined }\n  return (\n    <span className={className} data-tip={user && user.pronouns} style={customStyle} >\n      <ContextMenuTrigger id={props.id} renderTag=\"span\" holdToDisplay={0}>\n        <strong className={isMod ? 'mod' : ''}>\n          {isMod ? '[Mod] ' : ''}\n          {(!useSimpleNames && user && user.polymorph) || ''}\n          {username || 'unknown'}\n        </strong>\n      </ContextMenuTrigger>\n      <ContextMenu id={props.id}>\n        <MenuItem data={{ id: props.userId }} onClick={handleProfile}>\n          Profile\n        </MenuItem>\n        <MenuItem data={{ id: props.userId }} onClick={handleProfile}>\n          Whisper\n        </MenuItem>\n        {banButton}\n        {modButton}\n      </ContextMenu>\n      <ReactTooltip />\n    </span>\n  )\n}\n","import React from 'react'\nimport { FaVideo, FaVolumeUp } from 'react-icons/fa'\nimport { UserMapContext } from '../App'\nimport { useMediaChatContext } from '../videochat/mediaChatContext'\nimport HeldItemView from './HeldItemView'\nimport NameView from './NameView'\n\n// https://stackoverflow.com/questions/23618744/rendering-comma-separated-list-of-links\n/* intersperse: Return an array with the separator interspersed between\n * each element of the input array.\n *\n * > _([1,2,3]).intersperse(0)\n * [1,0,2,0,3]\n */\nfunction intersperse (arr, sep) {\n  if (arr.length === 0) {\n    return []\n  }\n\n  return arr.slice(1).reduce(\n    function (xs, x, i) {\n      return xs.concat([sep, x])\n    },\n    [arr[0]]\n  )\n}\n\nconst PresenceView = (props: {\n  users?: string[];\n  userId?: string;\n  roomId: string;\n}) => {\n  const { userMap } = React.useContext(UserMapContext)\n  let { users, userId } = props\n  const { callParticipants } = useMediaChatContext()\n\n  let audioUsers, videoUsers\n  if (callParticipants) {\n    const mediaUsers = Array.from(callParticipants.values())\n    audioUsers = mediaUsers.filter(p => p.audioTracks.size > 0).map(p => p.identity)\n    videoUsers = mediaUsers.filter((p) => p.videoTracks.size > 0).map((p) => p.identity)\n  }\n\n  // Shep: Issue 43, reminder to myself that this is the code making sure users don't appear in their own client lists.\n  if (users && userId) {\n    users = users.filter((u) => u !== userId)\n  }\n\n  if (users) {\n    // TODO: This should happen in the reducer\n    let names\n\n    if (users.length === 0) {\n      return (\n        <div id=\"dynamic-room-description\">\n          You are all alone here. <HeldItemView />\n        </div>\n      )\n    }\n\n    if (props.roomId === 'theater') {\n      return (\n        <div id=\"dynamic-room-description\">\n          There are {users.length} other people sitting in here.\n        </div>\n      )\n    }\n\n    const userViews = users.map((u, idx) => {\n      const user = userMap[u]\n      if (!user) {\n        return <span />\n      }\n      const id = `presence-${idx}`\n      return (\n        <span key={`room-presence-${id}`}>\n          <NameView userId={u} id={id} key={id} />\n          {audioUsers && audioUsers.includes(user.id) ? (\n            <FaVolumeUp className=\"has-audio\" />\n          ) : null}\n          {videoUsers && videoUsers.includes(user.id) ? (\n            <FaVideo className=\"has-video\" />\n          ) : null}\n          {user.item ? ` (holding ${user.item})` : null}\n        </span>\n      )\n    })\n\n    if (users.length === 1) {\n      names = userViews[0]\n    } else if (users.length === 2) {\n      names = (\n        <span>\n          {userViews[0]} and {userViews[1]}\n        </span>\n      )\n    } else {\n      names = (\n        <span>\n          {intersperse(userViews.slice(0, users.length - 1), ', ')}, and{' '}\n          {userViews[userViews.length - 1]}\n        </span>\n      )\n    }\n\n    return (\n      <div id=\"dynamic-room-description\">\n        Also here {users.length === 1 ? 'is' : 'are'} {names}. <HeldItemView />\n      </div>\n    )\n  } else {\n    return <div id=\"dynamic-room-description\" />\n  }\n}\n\nexport default PresenceView\n","import React, { useEffect, useState } from 'react'\nimport { RainwayStreamAnnouncement } from '@rainway/web'\n\ninterface Props {\n  announcements: RainwayStreamAnnouncement[];\n  onChosen: (e: RainwayStreamAnnouncement) => void;\n}\n\nexport const StreamSelector = (props: Props) => {\n  const { announcements, onChosen } = props\n  const [chosen, setChosen] = useState<RainwayStreamAnnouncement>()\n\n  useEffect(() => {\n    setChosen(announcements[0])\n  }, [announcements])\n\n  if (announcements.length === 0) {\n    return <></>\n  } else {\n    const identifyAndSelect = (id: string) => {\n      const selectedId = Number(id).valueOf()\n      const identified = announcements.find(\n        (e) => e.info.streamId === selectedId\n      )\n\n      if (identified) {\n        setChosen(identified)\n      }\n    }\n\n    return (\n      <div className=\"stream-selector\">\n        <select onBlur={(e) => identifyAndSelect(e.target.value)}>\n          {announcements.map((announcement) => (\n            <option\n              key={announcement.info.streamId.toString()}\n              value={announcement.info.streamId.toString()}\n            >\n              Stream {announcement.info.streamId.toString()}\n            </option>\n          ))}\n        </select>\n        <button\n          onClick={() => {\n            if (chosen) {\n              onChosen(chosen)\n            }\n          }}\n        >\n          Join Stream\n        </button>\n      </div>\n    )\n  }\n}\n","import {\n  InputLevel,\n  RainwayPeer,\n  RainwayStream,\n  RainwayStreamAnnouncement\n} from '@rainway/web'\nimport React, { useEffect, useState } from 'react'\nimport { Rainway } from '@rainway/react'\nimport { StreamSelector } from './StreamSelector'\n\nexport interface WidgetProps {\n  peerId: bigint;\n  peer: RainwayPeer | undefined;\n  announcements: RainwayStreamAnnouncement[];\n  disconnect: () => void;\n  streamStopCount: number;\n}\n\n/// A single widget in the demo app, exposing an interactive interface to a\n/// Rainway peer-to-peer connection. The user can chat and request streams.\nexport const Widget = (props: WidgetProps) => {\n  const offline = props.peer === undefined\n\n  const [chatBuffer, setChatBuffer] = useState('')\n\n  const [requestingStream, setRequestingStream] = useState(false)\n  const [stream, setStream] = useState<RainwayStream | undefined>()\n  const toggleStream = async () => {\n    if (stream) {\n      stream.leave()\n      setStream(undefined)\n      return\n    }\n    try {\n      setRequestingStream(true)\n      const result = await props.peer?.requestStream(\n        InputLevel.Gamepad | InputLevel.Mouse | InputLevel.Keyboard,\n      )\n      setStream(result)\n    } catch (e) {\n      console.log(e)\n    } finally {\n      setRequestingStream(false)\n    }\n  }\n\n  useEffect(() => {\n    stream?.leave()\n    setStream(undefined)\n  }, [props.streamStopCount])\n\n  return (\n    <div className=\"card widget\">\n      <div style={{ width: 110, marginBottom: '8px' }}>\n        {offline ? (\n          <div className=\"badge\">Disconnected</div>\n        ) : (\n          <div className=\"badge ok\">Connected</div>\n        )}\n      </div>\n      <div className=\"card-top\">\n        <h2>\n          <label htmlFor=\"peerId\">Peer ID</label>\n        </h2>\n        <input\n          id=\"peerId\"\n          type=\"text\"\n          spellCheck={false}\n          value={props.peerId.toString()}\n          disabled={true}\n        />\n        <button onClick={() => props.disconnect()}>\n          {offline ? 'Close' : 'Disconnect'}\n        </button>\n        <button\n          disabled={!props.peer || !stream}\n          onClick={() => stream?.requestFullscreen()}\n        >\n          Fullscreen\n        </button>\n        <button\n          disabled={!props.peer || requestingStream}\n          onClick={() => toggleStream()}\n        >\n          {stream ? 'Leave Stream' : 'Request New Stream'}\n        </button>\n        <StreamSelector\n          announcements={props.announcements}\n          onChosen={async (announcement) => {\n            const stream = await announcement.join()\n\n            setStream(stream)\n          }}\n        />\n      </div>\n      <div className=\"widget-body\">\n        <div className=\"stream-column m-r-16\">\n          <div className=\"stream-wrapper\">\n            <Rainway stream={stream}>No stream.</Rainway>\n          </div>\n        </div>\n      </div>\n    </div>\n  )\n}\n","import React, { useState } from 'react'\nimport { RainwayChannelMode, RainwayPeer, RainwayPeerState, RainwayError, RainwayRuntime, RainwayStreamAnnouncement } from '@rainway/web'\nimport { Widget } from './Widget'\nimport Config from '../../config'\n\ninterface DemoPeer {\n  peerId: bigint;\n  peer: RainwayPeer | undefined;\n  announcements: RainwayStreamAnnouncement[];\n  streamStopCount: number;\n}\n\nexport default function RainwayStreamView (props: {}) {\n  // TODO: The sample sets this via localStorage.\n  // We probably want to wire it up to our infra\n  const [connectingRuntime, setConnectingRuntime] = useState(false)\n  const [runtime, setRuntime] = useState<RainwayRuntime | undefined>()\n  const [peers, setPeers] = useState<DemoPeer[]>([])\n\n  // This \"peerId\" string is the value for the connect prompt.\n  const [peerId, setPeerId] = useState<string>('peerId-widget1')\n  const [connecting, setConnecting] = useState(false)\n  const [connectError, setConnectError] = useState('')\n\n  function makePeer (peer: RainwayPeer): DemoPeer {\n    return {\n      peer,\n      peerId: peer.peerId,\n      streamStopCount: 0,\n      announcements: []\n    }\n  }\n\n  function addAnnouncement (\n    peer: RainwayPeer,\n    announcement: RainwayStreamAnnouncement\n  ) {\n    setPeers((ps) =>\n      ps.map((p) =>\n        p.peerId === peer.peerId\n          ? { ...p, announcements: [...p.announcements, announcement] }\n          : p\n      )\n    )\n  }\n\n  const connectToRainway = async (): Promise<void> => {\n    // Make and attach the Rainway client.\n    let rt: RainwayRuntime\n    if (!runtime) {\n      setConnectingRuntime(true)\n      try {\n        rt = await RainwayRuntime.initialize({\n          apiKey: Config.RAINWAY_API_KEY,\n          externalId: 'web-demo-react',\n          onRuntimeConnectionLost: (rt, error) => {\n            // When the connection is fatally lost, drop all peers.\n            console.log('Connection lost:', error)\n            setRuntime(undefined)\n            setPeers([])\n          },\n          onConnectionRequest: (rt, request) => {\n            // Auto-accept every request.\n            request.accept()\n          },\n          onPeerMessage: (rt, peer, ch, data) => {\n            // Chat was here in the demo\n          },\n          onPeerDataChannel: () => {\n            // We don't particularly care about a data channel opening.\n          },\n          onPeerError: (rt, peer, error: RainwayError) => {\n            // When a peer encounters an error, log it to the console.\n            console.warn('onPeerError', peer, error)\n          },\n          onPeerStateChange: (rt, peer, state) => {\n            // on connect\n            if (state === RainwayPeerState.New) {\n              // When a peer connection is established, add a DemoPeer/widget.\n              const found = peers.find((p) => p.peerId === peer.peerId)\n              if (!found) {\n                setPeers((ps) => [...ps, makePeer(peer)])\n              }\n            } else if (state === RainwayPeerState.Failed) {\n              // When a peer connection is lost, remove a DemoPeer/widget.\n              console.warn('onPeerDisconnect', peer)\n              setPeers((ps) =>\n                ps.map((p) =>\n                  p.peerId === peer.peerId ? { ...p, peer: undefined } : p\n                )\n              )\n            }\n          },\n          onStreamAnnouncement: (rt, peer, announcement) => {\n            addAnnouncement(peer, announcement)\n          },\n          onStreamStop: (rt, stream) => {\n            // When a stream is stopped, increment that DemoPeer's\n            // \"streamStopCount\". A `useEffect` in the Widget listens for such\n            // increments and kills the stream state.\n            setPeers((ps) =>\n              ps.map((p) =>\n                [...(p.peer?.streams.values() ?? [])].some((s) => s === stream)\n                  ? { ...p, streamStopCount: p.streamStopCount + 1 }\n                  : p\n              )\n            )\n          },\n          logSink: (level, message) => {\n            // Where should log messages from Rainway go?\n            console.log(level, message)\n          }\n        })\n        setRuntime(rt)\n      } finally {\n        setConnectingRuntime(false)\n      }\n    } else {\n      rt = runtime\n    }\n  }\n\n  // TODO: Way to add peerId\n\n  return (\n    <div>\n      <div className=\"m-b-8 flex\">\n        <br/>\n        {runtime ? (\n          <div className=\"m-l-8 badge ok\">Connected to Rainway</div>\n        ) : connectingRuntime ? (\n          <div className=\"m-l-8 badge\">Connecting</div>\n        ) : (\n          <div>\n            <button\n              className=\"m-l-16\"\n              disabled={runtime !== undefined || connectingRuntime}\n              onClick={connectToRainway}\n            >\n                    Connect to Rainway\n            </button>\n          </div>\n        )}\n      </div>\n      {peers.map((p) => (\n        <Widget\n          key={p.peerId.toString()}\n          peer={p.peer}\n          peerId={p.peerId}\n          announcements={p.announcements}\n          disconnect={() => {\n            p.peer?.disconnect()\n            setPeers((ps) => ps.filter((x) => x.peerId !== p.peerId))\n          }}\n          streamStopCount={p.streamStopCount}\n        />\n      ))}\n      <div className=\"card flex\">\n        <h2>\n          <label htmlFor=\"peerId\">Peer ID</label>\n        </h2>\n        <input\n          className=\"m-l-8\"\n          id=\"peerId\"\n          type=\"text\"\n          spellCheck={false}\n          value={peerId}\n          placeholder=\"511111111111111111\"\n          disabled={!runtime || connecting}\n          onChange={(e) => setPeerId(e.target.value)}\n        />\n        <button\n          className=\"m-l-8 m-r-16\"\n          disabled={!runtime || connecting}\n          onClick={async () => {\n            console.log(peerId)\n            try {\n              setConnecting(true)\n              const peer = await runtime?.connect(BigInt(peerId))\n              if (peer) {\n                await peer.createDataChannel(\n                  'Message',\n                  RainwayChannelMode.Reliable\n                )\n\n                await peer.listStreams()\n                setConnectError('')\n              }\n            } catch (e) {\n              setConnectError(\n                (e as Error).toString().replace(/.*Rainway SDK Error: /, '')\n              )\n            } finally {\n              setConnecting(false)\n            }\n          }}\n        >\n          {connecting ? 'Connecting' : 'Connect to peer'}\n        </button>\n        {connectError}\n      </div>\n    </div>\n  )\n}\n","import * as React from 'react'\nimport { Room } from '../room'\nimport {\n  moveToRoom,\n  pickUpItem\n} from '../networking'\nimport { DispatchContext } from '../App'\nimport {\n  StopVideoChatAction,\n  ShowModalAction\n} from '../Actions'\nimport { FaChevronDown, FaChevronUp, FaCog } from 'react-icons/fa'\n\nimport '../../style/room.css'\nimport { Modal } from '../modals'\nimport { RainbowGateRoomView } from './feature/RainbowGateViews'\nimport { DullDoorRoomView } from './feature/DullDoorViews'\nimport { FullRoomIndexRoomView } from './feature/FullRoomIndexViews'\nimport { linkActions } from '../linkActions'\nimport { useState } from 'react'\nimport { useMediaChatContext } from '../videochat/mediaChatContext'\nimport PresenceView from './PresenceView'\nimport RainwayStreamView from './Rainway/RainwayStreamView'\n\nconst VIDEO_CHAT_MAX_SIZE = 8\n\ninterface Props {\n  room: Room;\n  userId: string;\n  roomData: { [roomId: string]: Room };\n  inMediaChat: boolean;\n  keepCameraWhenMoving: boolean;\n  textOnlyMode: boolean;\n  mediaChatView?: React.ReactElement\n  hasDismissedAModal: boolean\n}\n\nexport default function RoomView (props: Props) {\n  const dispatch = React.useContext(DispatchContext)\n  const {\n    prepareForMediaChat,\n    joinCall,\n    unpublishMedia\n  } = useMediaChatContext()\n  const { room } = props\n\n  const [fullDescriptionVisible, setFullDescriptionVisible] =\n      useState<boolean>(true)\n\n  // This is very silly.\n  // Since we're manually setting raw HTML, we can't get refs to add proper click handlers\n  // Instead, we just hijack ALL clicks in the description, and check if they're for a link\n  const descriptionClick = (e) => {\n    const roomId =\n      e.target && e.target.getAttribute && e.target.getAttribute('data-room')\n    if (roomId) {\n      moveToRoom(roomId)\n      return\n    }\n\n    const itemName =\n      e.target && e.target.getAttribute && e.target.getAttribute('data-item')\n    if (itemName) {\n      pickUpItem(itemName)\n    }\n\n    const actionName =\n      e.target && e.target.getAttribute && e.target.getAttribute('data-action')\n    if (actionName) {\n      linkActions[actionName]()\n    }\n  }\n\n  const toggleRoomDescriptionClick = (e) => {\n    setFullDescriptionVisible(!fullDescriptionVisible)\n  }\n\n  React.useEffect(() => {\n    if (room && room.mediaChat && !props.textOnlyMode && props.hasDismissedAModal) {\n      // HACK ALERT: This call is necessary to properly set the state variables related to leaving video chat, since\n      // our Twilio state isn't quite synchronized with our react state. We never publish if we don't want to (due to\n      // passing keepCameraWhenMoving into joinCall) so we aren't publishing and unpublishing. We still need to sync.\n      if (!props.keepCameraWhenMoving) {\n        leaveVideoChat()\n      }\n      prepareForMediaChat()\n      joinCall(props.room.id, props.keepCameraWhenMoving)\n    }\n  }, [props.room.id, props.hasDismissedAModal])\n\n  const leaveVideoChat = () => {\n    dispatch(StopVideoChatAction())\n    unpublishMedia()\n  }\n\n  const showNoteWall = () => {\n    dispatch(ShowModalAction(Modal.NoteWall))\n  }\n\n  const showRiddles = () => {\n    dispatch(ShowModalAction(Modal.Riddles))\n  }\n\n  let noteWallView\n  if (room && room.hasNoteWall) {\n    if (room.noteWallData) {\n      noteWallView = (\n        <div>\n          {room.noteWallData.roomWallDescription}{' '}\n          <button onClick={showNoteWall}>\n            {room.noteWallData.noteWallButton}\n          </button>\n        </div>\n      )\n    } else {\n      noteWallView = (\n        <div>\n          One of the walls has space for attendees to put up sticky notes.{' '}\n          <button onClick={showNoteWall}>View note wall</button>\n        </div>\n      )\n    }\n  }\n\n  console.log('ROOM', JSON.stringify(room, null, 2))\n\n  // TODO: Don't hard-code order of features\n  /* eslint-disable jsx-a11y/click-events-have-key-events */\n  /* eslint-disable jsx-a11y/no-noninteractive-element-to-interactive-role */\n  /* eslint-disable jsx-a11y/no-static-element-interactions */\n  return (\n    <div id=\"room\">\n      <h1 id=\"room-name\">\n        {room ? room.displayName : 'Loading...'}\n        <button\n          type=\"button\"\n          id=\"room-collapse-button\"\n          className=\"link-styled-button\"\n          onClick={toggleRoomDescriptionClick}\n        >\n          {fullDescriptionVisible ? (\n            <span>\n              Hide Description <FaChevronUp />\n            </span>\n          ) : (\n            <span>\n              Show Description <FaChevronDown />\n            </span>\n          )}\n        </button>\n      </h1>\n\n      <div\n        id=\"full-room-description\"\n        className={fullDescriptionVisible ? '' : 'collapsed'}\n      >\n        <div\n          id=\"static-room-description\"\n          onClick={descriptionClick}\n          dangerouslySetInnerHTML={{\n            __html: room\n              ? parseDescription(room.description, props.roomData)\n              : 'Loading current room...'\n          }}\n        />\n        {room && room.id === 'theater' ? <StreamEmbed /> : null}\n        {room && room.id === 'gamerCave' ? <RainwayStreamView /> : null}\n        {room &&\n        room.specialFeatures &&\n        room.specialFeatures.includes('RAINBOW_DOOR') ? (\n            <RainbowGateRoomView />\n          ) : (\n            ''\n          )}\n        {room &&\n        room.specialFeatures &&\n        room.specialFeatures.includes('DULL_DOOR') ? (\n            <DullDoorRoomView />\n          ) : (\n            ''\n          )}\n        {room &&\n        room.specialFeatures &&\n        room.specialFeatures.includes('FULL_ROOM_INDEX') ? (\n            <FullRoomIndexRoomView />\n          ) : (\n            ''\n          )}\n        {room && room.riddles ? (\n          <button id=\"riddle-button\" onClick={showRiddles}>\n            {room.riddles.length > 1\n              ? 'Examine the Riddles'\n              : 'Examine the Riddle'}\n          </button>\n        ) : (\n          ''\n        )}\n        {noteWallView}\n      </div>\n      {room ? (\n        <PresenceView\n          users={room.users}\n          userId={props.userId}\n          roomId={room.id}\n        />\n      ) : (\n        ''\n      )}\n      {props.mediaChatView || ''}\n    </div>\n  )\n}\n\nfunction parseDescription (\n  description: string,\n  roomData: { [roomId: string]: Room }\n): string {\n  // eslint-disable-next-line no-useless-escape\n  const complexLinkRegex = /\\[\\[([^\\]]*?)\\-\\>([^\\]]*?)\\]\\]/g\n  const simpleLinkRegex = /\\[\\[(.+?)\\]\\]/g\n\n  description = description.replace(complexLinkRegex, (match, text, roomId) => {\n    const room = roomData[roomId]\n    if (roomId === 'item') {\n      return `<a class='room-link' href='#' data-item='${text}'>${text}</a>`\n    } else if (room) {\n      const userCount =\n        room && room.users && room.users.length > 0\n          ? ` (${room.users.length})`\n          : ''\n      return `<a class='room-link' href='#' data-room='${roomId}'>${text}${userCount}</a>`\n    } else if (linkActions[roomId]) {\n      return `<a class='room-link' href='#' data-action='${roomId}'>${text}</a>`\n    } else {\n      // TODO: This warning is now expected, with room data being JIT\n      console.log(\n        `Dev warning: tried to link to room ${roomId}, which doesn't exist`\n      )\n    }\n  })\n\n  description = description.replace(simpleLinkRegex, (match, roomId) => {\n    const room = roomData[roomId]\n    if (!room) {\n      // TODO: This warning is now expected, with room data being JIT\n      console.log(\n        `Dev warning: tried to link to room ${roomId}, which doesn't exist`\n      )\n    }\n    const userCount =\n      room && room.users && room.users.length > 0\n        ? ` (${room.users.length})`\n        : ''\n    return `<a class='room-link' href='#' data-room='${roomId}'>${roomId}${userCount}</a>`\n  })\n  return description\n}\n\nexport function StreamEmbed () {\n  const streamRef = React.useRef<HTMLIFrameElement>(null)\n  const captionsRef = React.useRef<HTMLIFrameElement>(null)\n\n  return (\n    <div id=\"iframes\" style={{ margin: 'auto' }}>\n      <iframe\n        width=\"560\"\n        title=\"stream\"\n        ref={streamRef}\n        height=\"315\"\n        src=\"https://www.youtube.com/embed/live_stream?channel=UCKv_QzXft4mD6TXmQBZtzIA\"\n        frameBorder=\"0\"\n        allow=\"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture\"\n        allowFullScreen\n      ></iframe>\n      <iframe\n        id=\"captions\"\n        title=\"captions\"\n        ref={captionsRef}\n        width=\"560\"\n        height=\"100\"\n        src=\"https://www.streamtext.net/player/?event=RoguelikeCelebration&chat=false&header=false&footer=false&indicator=false&ff=Consolas&fgc=93a1a1\"\n        frameBorder=\"0\"\n        allow=\"autoplay; encrypted-media;\"\n        allowFullScreen\n      ></iframe>\n    </div>\n  )\n}\n","import { Room } from './room'\n\nexport type Message =\n  | ConnectedMessage\n  | DisconnectedMessage\n  | EnteredMessage\n  | LeftMessage\n  | MovedRoomMessage\n  | SameRoomMessage\n  | ChatMessage\n  | WhisperMessage\n  | ShoutMessage\n  | EmoteMessage\n  | DanceMessage\n  | ModMessage\n  | ErrorMessage\n  | CommandMessage\n  | CaptionMessage\n\nexport enum MessageType {\n  Connected = 'CONNECTED',\n  Disconnected = 'DISCONNECTED',\n  Entered = 'ENTERED',\n  Left = 'LEFT',\n  MovedRoom = 'MOVED',\n  SameRoom = 'SAME',\n  Chat = 'CHAT',\n  Whisper = 'WHISPER',\n  Shout = 'SHOUT',\n  Emote = 'EMOTE',\n  Dance = 'DANCE',\n  Mod = 'MOD',\n  Error = 'ERROR',\n  Command = 'COMMAND',\n  Caption = 'CAPTION'\n}\n\nexport function isDeletable (message: Message): message is ChatMessage | EmoteMessage | ShoutMessage | DanceMessage {\n  return [MessageType.Chat, MessageType.Emote, MessageType.Shout, MessageType.Dance, MessageType.Caption].includes(message.type)\n}\n\nexport interface ConnectedMessage {\n  type: MessageType.Connected;\n  userId: string;\n  roomId: string;\n  numUsersInRoom: number;\n  timestamp: Date;\n}\n\nexport const createConnectedMessage = (userId: string, roomId: string, numUsersInRoom: number): ConnectedMessage => {\n  return { type: MessageType.Connected, userId, roomId, numUsersInRoom, timestamp: new Date() }\n}\n\nexport interface DisconnectedMessage {\n  type: MessageType.Disconnected;\n  userId: string;\n  roomId: string;\n  numUsersInRoom: number;\n  timestamp: Date;\n}\n\nexport const createDisconnectedMessage = (\n  userId: string,\n  roomId: string,\n  numUsersInRoom: number\n): DisconnectedMessage => {\n  return { type: MessageType.Disconnected, userId, roomId, numUsersInRoom, timestamp: new Date() }\n}\n\nexport interface EnteredMessage {\n  type: MessageType.Entered;\n  userId: string;\n  fromId: string;\n  fromName: string;\n  roomId: string;\n  numUsersInRoom: number;\n  timestamp: Date;\n}\n\nexport const createEnteredMessage = (\n  userId: string,\n  fromId: string,\n  fromName: string,\n  roomId: string,\n  numUsersInRoom: number\n): EnteredMessage => {\n  return { type: MessageType.Entered, userId, fromId, fromName, roomId, numUsersInRoom, timestamp: new Date() }\n}\n\nexport interface LeftMessage {\n  type: MessageType.Left;\n  userId: string;\n  toId: string;\n  toName: string;\n  roomId: string;\n  numUsersInRoom: number;\n  timestamp: Date;\n}\n\nexport const createLeftMessage = (userId: string, toId: string, toName: string, roomId: string, numUsersInRoom: number): LeftMessage => {\n  return { type: MessageType.Left, userId, toId, toName, roomId, numUsersInRoom, timestamp: new Date() }\n}\n\nexport interface MovedRoomMessage {\n  type: MessageType.MovedRoom;\n  to: string;\n  timestamp: Date;\n}\n\nexport const createMovedRoomMessage = (to: string): MovedRoomMessage => {\n  return { type: MessageType.MovedRoom, to, timestamp: new Date() }\n}\n\nexport interface SameRoomMessage {\n  type: MessageType.SameRoom;\n  roomId: string;\n  timestamp: Date;\n}\n\nexport const createSameRoomMessage = (to: string): SameRoomMessage => {\n  return { type: MessageType.SameRoom, roomId: to, timestamp: new Date() }\n}\n\nexport interface ChatMessage {\n  type: MessageType.Chat;\n  messageId: string;\n  userId: string;\n  message: string;\n  timestamp: Date;\n}\n\nexport const createChatMessage = (\n  messageId: string,\n  userId: string,\n  message: string\n): ChatMessage => {\n  return { type: MessageType.Chat, messageId, userId, message, timestamp: new Date() }\n}\n\nexport interface CaptionMessage {\n  type: MessageType.Caption;\n  messageId: string;\n  userId: string;\n  message: string;\n  timestamp: Date;\n}\n\nexport const createCaptionMessage = (\n  messageId: string,\n  userId: string,\n  message: string\n): CaptionMessage => {\n  return { type: MessageType.Caption, messageId, userId, message, timestamp: new Date() }\n}\n\nexport interface WhisperMessage {\n  type: MessageType.Whisper;\n  userId: string;\n  message: string;\n  senderIsSelf: boolean;\n  timestamp: Date;\n}\n\nexport const createWhisperMessage = (\n  userId: string,\n  message: string,\n  senderIsSelf = false\n): WhisperMessage => {\n  return { type: MessageType.Whisper, userId, message, senderIsSelf, timestamp: new Date() }\n}\n\nexport interface ModMessage {\n  type: MessageType.Mod;\n  userId: string;\n  message: string;\n  senderIsSelf: boolean;\n  timestamp: Date;\n}\n\nexport const createModMessage = (\n  userId: string,\n  message: string,\n  senderIsSelf = false\n): ModMessage => {\n  return { type: MessageType.Mod, userId, message, senderIsSelf, timestamp: new Date() }\n}\n\nexport interface ShoutMessage {\n  type: MessageType.Shout;\n  messageId: string;\n  userId: string;\n  message: string;\n  timestamp: Date;\n}\n\nexport const createShoutMessage = (\n  id: string,\n  userId: string,\n  message: string\n): ShoutMessage => {\n  return { type: MessageType.Shout, messageId: id, userId, message, timestamp: new Date() }\n}\n\nexport interface EmoteMessage {\n  type: MessageType.Emote;\n  messageId: string;\n  userId: string;\n  message: string;\n  timestamp: Date;\n}\n\nexport const createEmoteMessage = (\n  id: string,\n  userId: string,\n  message: string\n): EmoteMessage => {\n  return { type: MessageType.Emote, messageId: id, userId, message, timestamp: new Date() }\n}\n\nexport interface DanceMessage {\n  type: MessageType.Dance;\n  messageId: string;\n  userId: string;\n  message: string;\n  timestamp: Date;\n}\n\nexport const createDanceMessage = (\n  id: string,\n  userId: string,\n  message: string\n): DanceMessage => {\n  return { type: MessageType.Dance, messageId: id, userId, message, timestamp: new Date() }\n}\n\nexport interface ErrorMessage {\n  type: MessageType.Error;\n  error: string;\n  timestamp: Date;\n}\n\nexport const createErrorMessage = (error: string): ErrorMessage => {\n  return { type: MessageType.Error, error, timestamp: new Date() }\n}\n\nexport interface CommandMessage {\n  type: MessageType.Command;\n  command: string;\n  timestamp: Date;\n}\n\nexport const createCommandMessage = (command: string): CommandMessage => {\n  return { type: MessageType.Command, command, timestamp: new Date() }\n}\n","/* eslint-disable jsx-a11y/no-static-element-interactions */\n/* eslint-disable jsx-a11y/click-events-have-key-events */\n\nimport React, { useContext, FunctionComponent } from 'react'\nimport ReactTooltip from 'react-tooltip'\nimport Linkify from 'react-linkify'\n\nimport { MenuItem, ContextMenuTrigger, ContextMenu } from 'react-contextmenu'\n\nimport {\n  Message,\n  MessageType,\n  ConnectedMessage,\n  DisconnectedMessage,\n  EnteredMessage,\n  LeftMessage,\n  MovedRoomMessage,\n  SameRoomMessage,\n  ChatMessage,\n  WhisperMessage,\n  ErrorMessage,\n  ShoutMessage,\n  EmoteMessage,\n  DanceMessage,\n  ModMessage,\n  CommandMessage,\n  CaptionMessage\n} from '../message'\nimport NameView from './NameView'\nimport { DispatchContext, UserMapContext, RoomDataContext } from '../App'\nimport { deleteMessage, fetchProfile, moveToRoom } from '../networking'\n\nconst formatter = new Intl.DateTimeFormat('en', { hour: 'numeric', minute: 'numeric' })\n\nexport default function MessageView (props: { message: Message; id: string, hideTimestamp: boolean, msgIndex: number }) {\n  const { message } = props\n  if (!message) { return <div/> }\n\n  const messageMap = {\n    [MessageType.Connected]: ConnectedMessageView,\n    [MessageType.Disconnected]: DisconnectedMessageView,\n    [MessageType.Entered]: EnteredView,\n    [MessageType.Left]: LeftView,\n    [MessageType.MovedRoom]: MovedView,\n    [MessageType.SameRoom]: SameView,\n    [MessageType.Chat]: ChatMessageView,\n    [MessageType.Whisper]: WhisperView,\n    [MessageType.Shout]: ShoutView,\n    [MessageType.Emote]: EmoteView,\n    [MessageType.Dance]: DanceView,\n    [MessageType.Caption]: CaptionView,\n    [MessageType.Error]: ErrorView,\n    [MessageType.Mod]: ModMessageView,\n    [MessageType.Command]: CommandView\n  }\n\n  const component = messageMap[message.type]\n  if (!component) {\n    console.log('Unexpected message type', message.type)\n    return <div />\n  }\n\n  const date = (typeof message.timestamp === 'string' ? new Date(message.timestamp) : message.timestamp)\n  let className = 'message-wrapper'\n  if (props.msgIndex % 2 === 0) {\n    className += ' even-message'\n  }\n\n  return (\n    <div className={className}>\n      <div className={`time ${props.hideTimestamp ? 'show-on-hover' : null}`}>{formatter.format(date)}</div>\n      {React.createElement(component, { ...message, id: props.id })}\n    </div>\n  )\n}\n\nconst handleDeleteMessage = (e, data) => {\n  const doDelete = confirm(`Are you sure you would like to delete the message '${data.message}'?`)\n  if (doDelete) {\n    deleteMessage(data.messageId)\n  }\n}\n\ntype DeletableMessageViewProps = {\n  messageId: string\n}\n\nconst linkDecorator = (href, text, key) => (\n  <a href={href} key={key} target=\"_blank\" rel=\"noopener noreferrer\">\n    {text}\n  </a>\n)\n\nconst DeletableMessageView: FunctionComponent<DeletableMessageViewProps> = (props) => {\n  const { userMap, myId } = useContext(UserMapContext)\n  const playerIsMod = userMap[myId] && userMap[myId].isMod\n\n  if (!playerIsMod) {\n    return <Linkify componentDecorator={linkDecorator}>{props.children}</Linkify>\n  } else {\n    return (\n      <Linkify componentDecorator={linkDecorator}>\n        <span className=\"deleteMenu\">\n          <ContextMenuTrigger id={props.messageId} mouseButton={2} renderTag=\"span\">\n            {props.children}\n          </ContextMenuTrigger>\n          <ContextMenu id={props.messageId}>\n            <MenuItem\n              data={{ messageId: props.messageId, message: props.children }}\n              onClick={handleDeleteMessage}\n            >\n              { 'Delete Message?' }\n            </MenuItem>\n          </ContextMenu>\n          <ReactTooltip />\n        </span>\n      </Linkify>\n    )\n  }\n}\n\nconst ConnectedMessageView = (props: ConnectedMessage & { id: string }) => (\n  <div className=\"message\">\n    <NameView userId={props.userId} id={props.id} /> has connected.\n  </div>\n)\n\nconst DisconnectedMessageView = (\n  props: DisconnectedMessage & { id: string }\n) => (\n  <div className=\"message\">\n    <NameView userId={props.userId} id={props.id} /> has disconnected.\n  </div>\n)\n\nconst EnteredView = (props: EnteredMessage & { id: string }) => {\n  const onClick = () => {\n    moveToRoom(props.fromId)\n  }\n  const roomData = useContext(RoomDataContext)\n\n  if (roomData[props.fromId]) {\n    const fromButton: JSX.Element = roomData[props.fromId].hidden ? <text>somewhere...</text> : <button onClick={onClick} className='link-styled-button'>{props.fromName}.</button>\n    return (\n      <div className=\"message movement-message\">\n        <NameView userId={props.userId} id={props.id}/> has entered from{' '}{fromButton}\n      </div>\n    )\n  }\n  return null\n}\n\nconst LeftView = (props: LeftMessage & { id: string }) => {\n  const onClick = () => {\n    moveToRoom(props.toId)\n  }\n  const roomData = useContext(RoomDataContext)\n\n  if (roomData[props.toId]) {\n    const toButton: JSX.Element = roomData[props.toId].hidden ? <text>somewhere...</text> : <button onClick={onClick} className='link-styled-button'>{props.toName}.</button>\n    return (\n      <div className=\"message movement-message\">\n        <NameView id={props.id} userId={props.userId} /> has wandered off to{' '}{toButton}\n      </div>\n    )\n  }\n  return null\n}\n\nconst MovedView = (props: MovedRoomMessage & { id: string }) => (\n  <div className=\"message\">You have moved to {props.to}.</div>\n)\n\nconst SameView = (props: SameRoomMessage & { id: string }) => (\n  <div className=\"message\">You are already in {props.roomId}.</div>\n)\n\nconst ChatMessageView = (props: ChatMessage & { id: string }) => (\n  <div className=\"message\">\n    <NameView userId={props.userId} id={props.id} />: <DeletableMessageView messageId={props.messageId}>{props.message}</DeletableMessageView>\n  </div>\n)\n\nconst CaptionView = (props: CaptionMessage & { id: string }) => (\n  <div className=\"message\">\n    <NameView userId={props.userId} id={props.id} /> (spoken): <DeletableMessageView messageId={props.messageId}>{props.message}</DeletableMessageView>\n  </div>\n)\n\nconst WhisperView = (props: WhisperMessage & { id: string }) => {\n  const dispatch = useContext(DispatchContext)\n  const openProfile = () => {\n    fetchProfile(props.userId)\n  }\n\n  if (props.senderIsSelf) {\n    return (\n      <div className=\"whisper\" onClick={openProfile}>\n        You whisper to <NameView id={props.id} userId={props.userId} />:{' '}\n        {props.message}\n      </div>\n    )\n  } else {\n    return (\n      <div className=\"whisper\" onClick={openProfile}>\n        <NameView userId={props.userId} id={props.id} /> whispers:{' '}\n        {props.message}\n      </div>\n    )\n  }\n}\n\nconst ModMessageView = (props: ModMessage & { id: string }) => {\n  if (props.senderIsSelf) {\n    return (\n      <div className=\"message\">\n        <em>\n          <strong>You</strong> said to the <strong>mod team</strong>:{' '}\n          {props.message}\n          <br />\n          Someone from the <strong>mod team</strong> will be in touch soon.\n        </em>\n      </div>\n    )\n  } else {\n    return (\n      <div className=\"message\">\n        <em>\n          <span role=\"img\" aria-label=\"red exclamation point\"></span><NameView userId={props.userId} id={props.id} /> says to the{' '}\n          <strong>mods</strong>:{props.message}<span role=\"img\" aria-label=\"red exclamation point\"></span>\n        </em>\n      </div>\n    )\n  }\n}\n\nconst ShoutView = (props: ShoutMessage & { id: string }) => {\n  return (\n    <div className=\"message\">\n      <NameView userId={props.userId} id={props.id} /> shouts: <DeletableMessageView messageId={props.messageId}>{props.message}</DeletableMessageView>\n    </div>\n  )\n}\n\nconst EmoteView = (props: EmoteMessage & { id: string }) => {\n  return (\n    <div className=\"message\">\n      <em><NameView userId={props.userId} id={props.id} /> <DeletableMessageView messageId={props.messageId}>{props.message}</DeletableMessageView></em>\n    </div>\n  )\n}\n\nconst DanceView = (props: DanceMessage & { id: string }) => {\n  return (\n    <div className=\"message\">\n      <em><NameView userId={props.userId} id={props.id} /> <span dangerouslySetInnerHTML={ { __html: props.message } }></span></em>\n    </div>\n  )\n}\n\nconst ErrorView = (props: ErrorMessage & { id: string }) => {\n  return <div className=\"error\">{props.error}</div>\n}\n\nconst CommandView = (props: CommandMessage & { id: string }) => {\n  return <div className=\"message\"><em><span dangerouslySetInnerHTML={ { __html: props.command } }></span></em></div>\n}\n","import React, { useContext } from 'react'\nimport { findLastIndex } from 'lodash'\n\nimport MessageView from './MessageView'\nimport { Message, MessageType, ConnectedMessage, DisconnectedMessage, EnteredMessage, LeftMessage } from '../message'\n\nimport '../../style/chat.css'\nimport { DispatchContext } from '../App'\nimport { ActivateAutoscrollAction, DeactivateAutoscrollAction } from '../Actions'\nimport { ServerSettings } from '../../server/src/types'\n\nfunction isMovementMessage (message: Message): message is ConnectedMessage | DisconnectedMessage | EnteredMessage | LeftMessage {\n  return message.type === MessageType.Connected || message.type === MessageType.Disconnected ||\n    message.type === MessageType.Entered || message.type === MessageType.Left\n}\n\ninterface Props {\n  messages: Message[],\n  autoscrollChat: boolean,\n  serverSettings: ServerSettings,\n  captionsEnabled: boolean\n}\n\nexport default function ChatView (props: Props) {\n  const dispatch = useContext(DispatchContext)\n\n  const handleScroll = () => {\n    const messageWindow = document.querySelector('#messages')\n    const isScrolledToBottom = messageWindow.scrollHeight === messageWindow.scrollTop + messageWindow.clientHeight\n\n    if (isScrolledToBottom && !props.autoscrollChat) {\n      dispatch(ActivateAutoscrollAction())\n    } else if (!isScrolledToBottom && props.autoscrollChat) {\n      dispatch(DeactivateAutoscrollAction())\n    }\n  }\n\n  React.useEffect(() => {\n    const lastMessage = document.querySelector(\n      '#messages .message-wrapper:last-of-type'\n    )\n    if (lastMessage && props.autoscrollChat) {\n      // I was using lastMessage.scrollIntoView()\n      // But I was seeing odd behavior when there was only one message on-screen.\n      // This very TS-unfriendly code fixes taht.\n      (lastMessage.parentNode as Element).scrollTop =\n        (lastMessage as any).offsetTop -\n        (lastMessage.parentNode as any).offsetTop\n    }\n  })\n\n  const [shouldShowOlderMessages, setShouldShowOlderMessages] = React.useState(false)\n\n  // This message filtering logic is kinda ugly and hard to read\n  function shouldRemoveMessage (m: Message) {\n    return isMovementMessage(m) &&\n      (\n        props.serverSettings.movementMessagesHideRoomIds.includes(m.roomId) ||\n        m.numUsersInRoom > props.serverSettings.movementMessagesHideThreshold\n      )\n  }\n  const messages = props.messages\n    .filter((msg) => {\n      // Hide movement messages if the room is busy enough\n      return !shouldRemoveMessage(msg)\n    })\n    .filter((msg) => {\n      // Don't show captions unless they're enabled\n      if (props.captionsEnabled) return true\n      return msg.type !== MessageType.Caption\n    })\n\n  const lastIndexOfMovedMessage = findLastIndex(\n    messages,\n    message => message.type === MessageType.MovedRoom\n  )\n  const currentRoomMessages = messages.slice(lastIndexOfMovedMessage)\n  const shownMessages = shouldShowOlderMessages ? messages : currentRoomMessages\n\n  return (\n    <>\n      <button\n        className=\"link-styled-button\"\n        onClick={() => setShouldShowOlderMessages(!shouldShowOlderMessages)}\n      >\n        {shouldShowOlderMessages ? 'Hide' : 'Show'} Older Messages\n      </button>\n      <div id=\"messages\" onScroll={handleScroll}>\n        {shownMessages.slice(-150).map((m, idx) => {\n          let hideTimestamp = false\n          const previousMessage = props.messages[idx - 1]\n          if (previousMessage) {\n            // TODO: Give all messages a userId for this to be meaningful\n            if (\n              (previousMessage as any).userId &&\n          (m as any).userId &&\n          (previousMessage as any).userId === (m as any).userId\n            ) {\n              const diff =\n            new Date(m.timestamp).getTime() -\n            new Date(previousMessage.timestamp).getTime()\n              // This is a bad way to calculate '3 minutes' and I should feel bad -em\n              if (diff < 1000 * 60 * 3) {\n                hideTimestamp = true\n              }\n            }\n          }\n\n          const shouldShowInterstitial = m.type === MessageType.MovedRoom\n          const id = `message-${idx}`\n\n          return (\n            <>\n              {shouldShowInterstitial ? <hr key={id + '-interstitial'}/> : null}\n              <MessageView\n                message={m}\n                key={id}\n                id={id}\n                hideTimestamp={hideTimestamp}\n                msgIndex={idx}\n              />\n            </>\n          )\n        })}\n      </div>\n    </>\n  )\n}\n","import React, { useContext, useState, useEffect } from 'react'\nimport { DispatchContext } from '../App'\nimport { SendMessageAction } from '../Actions'\n\nimport '../../style/input.css'\nconst emojifier = require('node-emoji')\n\nexport default function InputView (props: {\n  sendMessage: (message: string) => void,\n  prepopulated?: string\n}) {\n  const dispatch = useContext(DispatchContext)\n  const [input, setInput] = useState('')\n\n  const handleInputChange = (e) => {\n    const result = emojifier.emojify(e.currentTarget.value)\n    setInput(result)\n  }\n\n  const checkEnter = (e) => {\n    if (e.key === 'Enter') {\n      onClick()\n    }\n  }\n\n  const onClick = () => {\n    props.sendMessage(input)\n    setInput('')\n  }\n\n  useEffect(() => {\n    document.getElementById('chat-input').focus()\n    if (props.prepopulated) {\n      setInput(props.prepopulated)\n    }\n  }, [props.prepopulated])\n\n  return (\n    <div id=\"input\">\n      <input\n        type=\"text\"\n        id=\"chat-input\"\n        onChange={handleInputChange}\n        onKeyPress={checkEnter}\n        value={input}\n        aria-label=\"Chat text input box\"\n        autoComplete=\"off\"\n      />\n      <button id=\"send\" onClick={onClick}>\n        Send\n      </button>\n    </div>\n  )\n}\n","interface SlashCommand {\n    type: string;\n    description: string;\n    invocations: string[];\n    singleParameter: boolean;\n}\n\nconst SlashCommand = (\n  name: string,\n  description: string,\n  invocations: string[],\n  singleParameter: boolean\n): SlashCommand => { return { type: name, description: description, invocations: invocations, singleParameter: singleParameter } }\n\nexport enum SlashCommandType {\n  Help = 'HELP',\n  Move = 'MOVE',\n  Whisper = 'WHISPER',\n  Shout = 'SHOUT',\n  Emote = 'EMOTE',\n  Dance = 'DANCE',\n  Interact = 'INTERACT',\n  ContactMod = 'CONTACT_MOD',\n  Look = 'LOOK'\n}\n\nexport const SlashCommands: SlashCommand[] = [\n  SlashCommand(SlashCommandType.Help, 'Lists the available commands', ['/help'], true),\n  SlashCommand(SlashCommandType.Move, 'Move from one room to another. You can also click on the link in the room description.', ['/go', '/move'], false),\n  SlashCommand(SlashCommandType.Whisper, 'Whisper another user. You can also click directly on their name and select the whisper option.', ['/whisper'], false),\n  SlashCommand(SlashCommandType.Shout, 'Sends a message to everybody at once - has a 5 minute cooldown. Do not abuse this!', ['/shout'], false),\n  SlashCommand(SlashCommandType.Emote, 'Like a normal message, but in italics!', ['/emote', '/me'], false),\n  SlashCommand(SlashCommandType.Dance, 'Bust a move!', ['/dance'], true),\n  SlashCommand(SlashCommandType.ContactMod, 'Sends a message to the mod team. We will be in touch shortly afterwards.', ['/mod', '/mods', '/moderator', '/moderators'], false),\n  SlashCommand(SlashCommandType.Look, 'View the profile of another user. You can also click on their name and select the Profile option.', ['/look'], false),\n  SlashCommand(SlashCommandType.Interact, 'Interact with or get something in a room by referencing the name in the description - experiment as you explore!', ['/interact', '/get'], false)\n]\n\nexport function matchingSlashCommand (message: String): SlashCommand | undefined {\n  return SlashCommands.find((command) =>\n    command.invocations.find((invocation) =>\n      command.singleParameter ? message.startsWith(invocation) : message.startsWith(invocation + ' ')\n    )\n  )\n}\n","import { Action, ActionType } from './Actions'\nimport {\n  Message,\n  createConnectedMessage,\n  createDisconnectedMessage,\n  createEnteredMessage,\n  createLeftMessage,\n  createChatMessage,\n  createWhisperMessage,\n  createErrorMessage,\n  createShoutMessage,\n  createEmoteMessage,\n  createDanceMessage,\n  createModMessage,\n  createMovedRoomMessage,\n  createSameRoomMessage,\n  isDeletable,\n  createCommandMessage,\n  WhisperMessage,\n  createCaptionMessage\n} from './message'\nimport { Room } from './room'\nimport {\n  sendChatMessage,\n  toggleUserBan,\n  toggleUserMod,\n  updateProfileColor,\n  updateFontReward,\n  fetchProfile,\n  sendCaption\n} from './networking'\nimport { PublicUser, MinimalUser } from '../server/src/user'\nimport { v4 as uuidv4 } from 'uuid'\nimport { Modal } from './modals'\nimport { matchingSlashCommand, SlashCommandType } from './SlashCommands'\nimport { MESSAGE_MAX_LENGTH, MESSAGE_MAX_WORD_LENGTH } from '../server/src/config'\nimport { ServerSettings, DEFAULT_SERVER_SETTINGS } from '../server/src/types'\nimport * as Storage from './storage'\nimport firebase from 'firebase/app'\nimport Config from './config'\nexport interface State {\n  firebaseApp: firebase.app.App;\n  authenticated: boolean;\n  checkedAuthentication: boolean;\n  authenticationProvider?: string;\n  mustVerifyEmail?: boolean;\n\n  hasDismissedAModal: boolean;\n\n  hasRegistered: boolean;\n\n  roomId?: string;\n  userId?: string;\n  userMap: { [userId: string]: MinimalUser };\n  roomData: { [roomId: string]: Room };\n  profileData?: PublicUser;\n\n  messages: Message[];\n  whispers: WhisperMessage[];\n  autoscrollChat: boolean;\n\n  prepopulatedInput?: string;\n\n  // Settings data\n  useSimpleNames?: boolean;\n\n  /** This is poorly named, but being \"in media chat\" means \"is publishing audio and/or video\" */\n  inMediaChat: boolean;\n  keepCameraWhenMoving?: boolean;\n  captionsEnabled: boolean,\n\n  /** text-only mode functionally overrides audio-only mode, since we don't even connect to Twilio */\n  textOnlyMode?: boolean;\n  audioOnlyMode?: boolean;\n\n  /** Tuples of userId and when they were last the visible speaker */\n  visibleSpeakers: [string, Date][]\n  currentSpeaker?: string\n\n  // How many people (other than you) to show in media chat\n  numberOfFaces: number\n\n  // If this is set to something other than Modal.None, that will indicate\n  // which modal view should be rendered on top of the chat view\n  activeModal: Modal\n  activeModalOptions: ModalOptions,\n\n  // User ID of whose profile should be shwon\n  visibleProfile?: PublicUser;\n\n  // If the device is a portrait smartphone, we hide the menu in favor of a hamburger button\n  // In that situation, this reflects whether the side menu is visible.\n  mobileSideMenuIsVisible?: boolean\n\n  // If true, non-mods cannot access the space\n  isClosed?: boolean\n\n  isBanned: boolean\n\n  serverSettings: ServerSettings\n}\n\nconsole.log(Config.FIREBASE_CONFIG)\nexport const defaultState: State = {\n  firebaseApp: firebase.initializeApp(Config.FIREBASE_CONFIG),\n  authenticated: false,\n  checkedAuthentication: false,\n  hasRegistered: false,\n  messages: [],\n  whispers: [],\n  visibleSpeakers: [],\n  autoscrollChat: true,\n  userMap: {},\n  roomData: {},\n  inMediaChat: false,\n  activeModal: Modal.None,\n  activeModalOptions: {},\n  isBanned: false,\n  serverSettings: DEFAULT_SERVER_SETTINGS,\n  numberOfFaces: 5,\n  captionsEnabled: false,\n  hasDismissedAModal: false\n}\n\n// TODO: Split this out into separate reducers based on worldstate actions vs UI actions?\nexport default (oldState: State, action: Action): State => {\n  console.log('In reducer', action)\n\n  // TODO: This could hurt perf when we have a lot of messages\n  const state: State = JSON.parse(JSON.stringify(oldState))\n  state.prepopulatedInput = undefined\n\n  if (action.type === ActionType.ReceivedMyProfile) {\n    state.profileData = action.value\n  }\n\n  if (action.type === ActionType.ReceivedServerSettings) {\n    state.serverSettings = action.value\n  }\n\n  if (action.type === ActionType.UpdatedCurrentRoom) {\n    const oldRoomId = state.roomId\n    state.roomId = action.value.roomId\n    state.roomData = { ...state.roomData, ...action.value.roomData }\n\n    if (state.roomId === 'entryway' || !state.hasDismissedAModal) {\n      // This will show any time anyone reloads into the entryway, which\n      // might be slightly annoying for e.g. greeters.\n      // Given our time constraints, that seems an acceptable tradeoff\n      // for not needing to QA more complex logic?\n      state.activeModal = Modal.Welcome\n    }\n\n    // Add a local \"you have moved to X room\" message\n    // Don't display if we're in the same room (issue 162)\n    if (state.roomData && state.roomData[action.value.roomId]) {\n      const room = state.roomData[action.value.roomId]\n      if (state.roomId !== oldRoomId) {\n        addMessage(state, createMovedRoomMessage(room.shortName))\n      } else {\n        addMessage(state, createSameRoomMessage(room.shortName))\n      }\n    }\n\n    /** Here lies a giant hack.\n     * So, the WebRTC connection handshake lives outside of Flux.\n     * The set of peer connections are long-lived objects that shouldn't live inside React components,\n     * but they also need access to a `dispatch` function, so having them separate seems easiest.\n     *\n     * HOWEVER!\n     * When a new peer says \"hey, you can connect to me\", we need some state data.\n     * Specifically, we need to know if you're currently in a videocall.\n     * This means we need to do some state-munging to actively remove you from a call once you've left the room.\n     *\n     * TODO: There may be cases other than moving rooms where we want to disconnect you.\n     * If so, we need to dupe this logic there.\n     */\n    // (action as Action).type = ActionType.StopVideoChat\n  }\n\n  if (action.type === ActionType.UpdatedRoomData) {\n    state.roomData = { ...state.roomData, ...action.value }\n  }\n\n  if (action.type === ActionType.UpdatedPresence) {\n    Object.keys(action.value).forEach((roomId) => {\n      if (state.roomData[roomId]) {\n        state.roomData[roomId].users = action.value[roomId]\n      }\n    })\n  }\n\n  if (action.type === ActionType.PlayerConnected) {\n    const user = action.value\n    const roomData = state.roomData[state.roomId]\n    if (!roomData.users.includes(user.id)) {\n      roomData.users.push(user.id)\n      addMessage(state, createConnectedMessage(user.id, state.roomId, roomData.users.length))\n    }\n    state.userMap[user.id] = user\n  }\n\n  if (action.type === ActionType.PlayerDisconnected) {\n    const roomData = state.roomData[state.roomId]\n    roomData.users = roomData.users.filter((u) => u !== action.value)\n    addMessage(state, createDisconnectedMessage(action.value, state.roomId, roomData.users.length))\n  }\n\n  if (action.type === ActionType.PlayerEntered) {\n    const roomData = state.roomData[state.roomId]\n    if (!roomData.users.includes(action.value.name)) {\n      roomData.users.push(action.value.name)\n      addMessage(state,\n        createEnteredMessage(action.value.name, action.value.fromId, action.value.fromName, state.roomId, roomData.users.length)\n      )\n    }\n  }\n\n  if (action.type === ActionType.PlayerLeft) {\n    const roomData = state.roomData[state.roomId]\n    roomData.users = roomData.users.filter((u) => u !== action.value.name)\n    addMessage(state, createLeftMessage(action.value.name, action.value.toId, action.value.toName, state.roomId, roomData.users.length))\n  }\n\n  if (action.type === ActionType.ChatMessage) {\n    addMessage(state,\n      createChatMessage(action.value.messageId, action.value.name, action.value.message)\n    )\n  }\n\n  if (action.type === ActionType.CaptionMessage) {\n    addMessage(state,\n      createCaptionMessage(action.value.messageId, action.value.name, action.value.message)\n    )\n  }\n\n  if (action.type === ActionType.Whisper) {\n    const whisperMessage = createWhisperMessage(action.value.name, action.value.message)\n    addMessage(state, whisperMessage)\n    saveWhisper(state, whisperMessage)\n  }\n\n  if (action.type === ActionType.ModMessage) {\n    addMessage(\n      state,\n      createModMessage(\n        action.value.name,\n        action.value.message,\n        action.value.name === state.userId\n      )\n    )\n  }\n\n  if (action.type === ActionType.DeleteMessage) {\n    deleteMessage(state, action.value.targetMessageId)\n  }\n\n  if (action.type === ActionType.Shout) {\n    addMessage(state,\n      createShoutMessage(action.value.messageId, action.value.name, action.value.message)\n    )\n  }\n\n  if (action.type === ActionType.Emote) {\n    addMessage(state,\n      createEmoteMessage(action.value.messageId, action.value.name, action.value.message)\n    )\n  }\n\n  if (action.type === ActionType.Dance) {\n    addMessage(state,\n      createDanceMessage(action.value.messageId, action.value.name, action.value.message)\n    )\n  }\n\n  if (action.type === ActionType.UserMap) {\n    state.userMap = { ...state.userMap, ...action.value }\n\n    // If the actively-viewed profile updated, do a clean fetch\n    if (state.visibleProfile && state.userMap[state.visibleProfile.id]) {\n      fetchProfile(state.visibleProfile.id)\n    }\n  }\n\n  if (action.type === ActionType.PlayerBanned) {\n    if (action.value.id === state.userId) {\n      state.isBanned = true\n    } else {\n      state.userMap[action.value.id].isBanned = true\n      addMessage(state, createErrorMessage('User ' + action.value.username + ' was banned!'))\n    }\n  }\n\n  // This message is never received by the banned player.\n  if (action.type === ActionType.PlayerUnbanned) {\n    if (state.userMap[action.value.id]) {\n      state.userMap[action.value.id].isBanned = false\n    }\n    addMessage(state, createErrorMessage('User ' + action.value.username + ' was unbanned!'))\n  }\n\n  if (action.type === ActionType.UpdateProfileColor) {\n    state.userMap[state.userId].nameColor = action.color\n\n    if (action.color) {\n      addMessage(state, createErrorMessage('Your name color was changed to ' + action.color))\n    } else {\n      addMessage(state, createErrorMessage('Your name color has changed back to its original state.'))\n    }\n\n    updateProfileColor(state.userId, action.color)\n  }\n\n  if (action.type === ActionType.UpdateFontReward) {\n    state.userMap[state.userId].fontReward = action.font\n\n    // I'm following the pattern of the set colour but... I don't think the user sees these message, and they aren't errors, why do we do this?\n    if (action.font) {\n      addMessage(state, createErrorMessage('You feel invigorated, and like you\\'ve become more... ' + action.font))\n    } else {\n      addMessage(state, createErrorMessage('You feel yourself return to your normal state, like you never went riddling to begin with.'))\n    }\n\n    updateFontReward(state.userId, action.font)\n  }\n\n  if (action.type === ActionType.Error) {\n    addMessage(state, createErrorMessage(action.value))\n  }\n\n  if (action.type === ActionType.MediaReceivedSpeakingData) {\n    state.currentSpeaker = action.value\n    if (action.value !== null && action.value !== state.userId) {\n      if (!state.visibleSpeakers.find(([userId, _]) => userId === action.value)) {\n        if (state.visibleSpeakers.length < state.numberOfFaces) {\n          state.visibleSpeakers.push([action.value, new Date()])\n        } else {\n          // Find the oldest speaker and replace them\n          let oldestIndex = -1\n          let oldestTime = new Date()\n          for (let i = 0; i < state.visibleSpeakers.length; i++) {\n            if (state.visibleSpeakers[i][1] < oldestTime) {\n              oldestTime = state.visibleSpeakers[i][1]\n              oldestIndex = i\n            }\n          }\n          state.visibleSpeakers[oldestIndex] = [action.value, new Date()]\n        }\n      }\n    }\n  }\n\n  if (action.type === ActionType.SetNumberOfFaces) {\n    state.numberOfFaces = action.value\n  }\n\n  if (action.type === ActionType.StartVideoChat) {\n    state.inMediaChat = true\n  }\n\n  if (action.type === ActionType.StopVideoChat) {\n    // stopAudioAnalyserLoop()\n    state.inMediaChat = false\n  }\n\n  // UI Actions\n  if (action.type === ActionType.SendMessage) {\n    const messageId: string = uuidv4()\n    const trimmedMessage = action.value.trim()\n    const beginsWithSlash = /^\\/.+?/.exec(trimmedMessage)\n    const matching = beginsWithSlash ? matchingSlashCommand(trimmedMessage) : undefined\n\n    if (trimmedMessage.length > MESSAGE_MAX_LENGTH) {\n      addMessage(state, createErrorMessage('Your message is too long! Please try to keep it under ~600 characters!'))\n    } else if (trimmedMessage.split(' ').find((s) => s.length > MESSAGE_MAX_WORD_LENGTH)) {\n      addMessage(state, createErrorMessage('Your message has a word that is too long! Please keep it under 60 characters!'))\n    } else if (beginsWithSlash && matching === undefined) {\n      const commandStr = /^(\\/.+?) (.+)/.exec(trimmedMessage)\n      addMessage(state, createErrorMessage(`Your command ${commandStr ? commandStr[1] : action.value} is not a registered slash command!`))\n    } else if (beginsWithSlash && matching.type === SlashCommandType.Whisper) {\n      const commandStr = /^(\\/.+?) (.+)/.exec(trimmedMessage)\n      const parsedUsernameMessage = /^(.+?) (.+)/.exec(commandStr[2])\n\n      if (!parsedUsernameMessage) {\n        addMessage(state, createErrorMessage(`Your whisper to ${commandStr[2]} had no message!`))\n      } else {\n        sendChatMessage(messageId, trimmedMessage)\n\n        const [_, username, message] = parsedUsernameMessage\n        const user = Object.values(state.userMap).find(\n          (u) => u.username === username\n        )\n        const userId = user && user.id\n        if (userId) {\n          const whisperMessage = createWhisperMessage(userId, message, true)\n          addMessage(state, whisperMessage)\n          saveWhisper(state, whisperMessage)\n        }\n      }\n    } else if (beginsWithSlash && matching.type === SlashCommandType.Help) {\n      state.activeModal = Modal.Help\n      addMessage(state, createCommandMessage('You consult the help docs. (You can also find them in sidebar!)'))\n    } else if (beginsWithSlash && matching.type === SlashCommandType.Look) {\n      const commandStr = /^(\\/.+?) (.+)/.exec(trimmedMessage)\n      addMessage(state, createCommandMessage(`You attempt to examine ${commandStr[2]}. (You can also click on their username and select Profile!)`))\n      sendChatMessage(messageId, trimmedMessage)\n    } else if (beginsWithSlash) {\n      sendChatMessage(messageId, trimmedMessage)\n    } else {\n      sendChatMessage(messageId, action.value)\n      addMessage(state, createChatMessage(messageId, state.userId, action.value))\n    }\n  }\n\n  if (action.type === ActionType.SendCaption) {\n    const messageId: string = uuidv4()\n    sendCaption(messageId, action.value)\n    addMessage(state, createCaptionMessage(messageId, state.userId, action.value))\n  }\n\n  if (action.type === ActionType.StartWhisper) {\n    state.prepopulatedInput = `/whisper ${action.value} `\n  }\n\n  if (action.type === ActionType.HideModalAction) {\n    state.activeModal = Modal.None\n    state.hasDismissedAModal = true\n  }\n\n  if (action.type === ActionType.ShowProfile) {\n    state.visibleProfile = action.value\n  }\n\n  if (action.type === ActionType.HideProfile) {\n    state.visibleProfile = null\n  }\n\n  if (action.type === ActionType.ShowModal) {\n    state.activeModal = action.value\n    state.activeModalOptions = {}\n  }\n\n  if (action.type === ActionType.ShowModalWithOptions) {\n    console.log('Showing', action)\n    state.activeModal = action.value.modal\n    state.activeModalOptions = action.value.options\n  }\n\n  if (action.type === ActionType.ShowSideMenu) {\n    state.mobileSideMenuIsVisible = true\n  }\n\n  if (action.type === ActionType.HideSideMenu) {\n    state.mobileSideMenuIsVisible = false\n  }\n\n  if (action.type === ActionType.DeactivateAutoscroll) {\n    state.autoscrollChat = false\n  }\n\n  if (action.type === ActionType.ActivateAutoscroll) {\n    state.autoscrollChat = true\n  }\n\n  if (action.type === ActionType.SetUseSimpleNames) {\n    state.useSimpleNames = action.value\n    Storage.setUseSimpleNames(action.value)\n  }\n\n  if (action.type === ActionType.SetKeepCameraWhenMoving) {\n    state.keepCameraWhenMoving = action.value\n    Storage.setKeepCameraWhenMoving(action.value)\n  }\n\n  if (action.type === ActionType.SetCaptionsEnabled) {\n    state.captionsEnabled = action.value\n    Storage.setCaptionsEnabled(action.value)\n  }\n\n  if (action.type === ActionType.SetTextOnlyMode) {\n    state.textOnlyMode = action.textOnlyMode\n    if (!action.refresh) {\n      Storage.setTextOnlyMode(action.textOnlyMode)\n    } else {\n      Storage.setTextOnlyMode(action.textOnlyMode).then(() => window.location.reload())\n    }\n  }\n\n  if (action.type === ActionType.SetAudioOnlyMode) {\n    state.audioOnlyMode = action.value\n  }\n\n  if (action.type === ActionType.Authenticate) {\n    state.checkedAuthentication = true\n\n    state.authenticationProvider = action.value.provider\n    state.mustVerifyEmail = action.value.mustVerifyEmail\n\n    if (action.value.userId && action.value.name) {\n      state.authenticated = true\n      state.userId = action.value.userId\n\n      // If you haven't registered yet, we need to grab your username before we've pulled a server userMap\n      state.userMap[action.value.userId] = {\n        id: action.value.userId,\n        username: action.value.name\n      }\n    } else {\n      state.authenticated = undefined\n      state.userId = undefined\n    }\n  }\n\n  if (action.type === ActionType.IsRegistered) {\n    state.hasRegistered = true\n  }\n\n  if (action.type === ActionType.BanToggle) {\n    toggleUserBan(action.value)\n  }\n\n  if (action.type === ActionType.ModToggle) {\n    toggleUserMod(action.value)\n  }\n\n  if (action.type === ActionType.LoadMessageArchive) {\n    state.messages = action.messages\n    state.whispers = action.whispers || []\n  }\n\n  // Notes\n  if (action.type === ActionType.NoteAdd) {\n    const room = state.roomData && state.roomData[action.value.roomId]\n    if (room.hasNoteWall) {\n      if (!room.notes) room.notes = []\n\n      room.notes.push(action.value.note)\n    }\n  }\n\n  if (action.type === ActionType.NoteRemove) {\n    const room = state.roomData && state.roomData[action.value.roomId]\n    if (room.hasNoteWall) {\n      if (!room.notes) room.notes = []\n\n      room.notes = room.notes.filter(n => n.id !== action.value.noteId)\n    }\n  }\n\n  if (action.type === ActionType.NoteUpdateLikes) {\n    const room = state.roomData && state.roomData[action.value.roomId]\n    if (room.hasNoteWall) {\n      if (!room.notes) room.notes = []\n\n      const note = room.notes.find(n => n.id === action.value.noteId)\n      if (note) {\n        note.likes = action.value.likes\n      }\n    }\n  }\n\n  if (action.type === ActionType.NoteUpdateRoom) {\n    const room = state.roomData && state.roomData[action.value.roomId]\n    if (room.hasNoteWall) {\n      room.notes = action.value.notes\n    }\n  }\n\n  if (action.type === ActionType.SpaceIsClosed) {\n    state.isClosed = true\n  }\n\n  if (action.type === ActionType.SpaceOpenedOrClosed) {\n    if (state.userMap[state.userId].isMod) {\n      state.isClosed = action.value\n      addMessage(state, createCommandMessage(`The space is now ${action.value ? 'closed' : 'open'}`))\n    } else {\n      // Not reloading the page will show the 'go home' screen, but will still send SignalR data\n      // Just hard-reloading the page will stop them from getting messages\n      window.location.reload()\n    }\n  }\n\n  if (action.type === ActionType.CommandMessage) {\n    const message = createCommandMessage(action.value)\n    addMessage(state, message)\n  }\n\n  return state\n}\n\n// WARNING: These three functions modify the message state without awaiting on the result.\n// If you're seeing weird race conditions with the message store, that's probably the issue.\n\nfunction deleteMessage (state: State, messageId: String) {\n  const target = state.messages.find(m => isDeletable(m) && m.messageId === messageId)\n  // Calling isDeletable again here so TypeScript can properly cast; if there's a nicer way to do this, please inform!\n  if (isDeletable(target)) {\n    target.message = 'message was removed by moderator'\n    Storage.setMessages(state.messages)\n  }\n}\n\nasync function saveWhisper (state: State, message: WhisperMessage) {\n  state.whispers.push(message)\n  Storage.setWhispers(state.whispers)\n}\n\nasync function addMessage (state: State, message: Message) {\n  state.messages.push(message)\n  state.messages = state.messages.slice(-500)\n  Storage.setMessages(state.messages)\n}\n\n// This is intended to be a big old unreadable grab bag,\n// but seems better than alternatives\nexport interface ModalOptions {\n    hideVideo?: boolean,\n    showJoinButton?: boolean\n}\n","import React, { useContext } from 'react'\nimport Linkify from 'react-linkify'\nimport { PublicUser } from '../../server/src/user'\nimport { HideProfileAction, SendMessageAction, ReceivedMyProfileAction } from '../Actions'\nimport { DispatchContext } from '../App'\nimport { Message, WhisperMessage, MessageType } from '../message'\nimport InputView from './InputView'\nimport NameView from './NameView'\nimport ReactTooltip from 'react-tooltip'\n\nimport '../../style/profileView.css'\n\nconst ProfileWhisperView = (props: WhisperMessage & {id: string, otherUser: PublicUser}) => {\n  const { otherUser } = props\n\n  if (props.senderIsSelf) {\n    return (\n      <div className=\"whisper-message\">\n        <em>\n          You:{' '}\n          {props.message}\n        </em>\n      </div>\n    )\n  } else {\n    return (\n      <div className=\"whisper-message\">\n        <em>\n          <span data-tip={otherUser && otherUser.pronouns}>\n            {otherUser.username}\n          </span>:{' '}\n          {props.message}\n          <ReactTooltip />\n        </em>\n      </div>\n    )\n  }\n}\n\nexport default function ProfileView (props: { user: PublicUser, whispers: WhisperMessage[] }) {\n  const { user, whispers } = props\n  const dispatch = useContext(DispatchContext)\n\n  React.useEffect(() => {\n    const lastMessage = document.querySelector(\n      '#chat .whisper-message:last-of-type'\n    )\n    if (!lastMessage) return\n\n    // I was using lastMessage.scrollIntoView()\n    // But I was seeing odd behavior when there was only one message on-screen.\n    // This very TS-unfriendly code fixes taht.\n    (lastMessage.parentNode as Element).scrollTop =\n      (lastMessage as any).offsetTop -\n      (lastMessage.parentNode as any).offsetTop\n  })\n\n  const whisperMessages = (whispers || []).filter((m, _) => m.userId === user.id) as Array<WhisperMessage>\n\n  const realName = user.realName ? (\n    <div id=\"profile-realName\">{user.realName}</div>\n  ) : (\n    null\n  )\n\n  const twitterHandle = user.twitterHandle ? (\n    <div id=\"profile-twitter\">\n      <strong>Twitter</strong>:{' '}\n      <a href={`https://twitter.com/${user.twitterHandle}`} target=\"_blank\" rel=\"noreferrer\">\n      @{user.twitterHandle}\n      </a>\n    </div>\n  ) : (\n    null\n  )\n\n  const url = user.url ? (\n    <div id=\"profile-url\">\n      <strong>Web Site</strong>:{' '}\n      {user.url}\n    </div>\n  ) : (\n    null\n  )\n\n  const description = user.description ? (\n    <div id=\"profile-description\">{user.description}</div>\n  ) : (\n    null\n  )\n\n  const askMeAbout = user.askMeAbout ? (\n    <div id=\"profile-askme\">\n      <strong>Ask me about:</strong>{' '}\n      {user.askMeAbout}\n    </div>\n  ) : (\n    null\n  )\n\n  const linkDecorator = (href, text, key) => (\n    <a href={href} key={key} target=\"_blank\" rel=\"noopener noreferrer\">\n      {text}\n    </a>\n  )\n\n  return (\n    <Linkify componentDecorator={linkDecorator}>\n      <div id=\"profile\">\n        <div className='fixed'>\n          <div id=\"header\">\n            <h2 className={user.isMod ? 'mod' : ''}><NameView userId={user.id} id={`profile-nameview-${user.id}`} /></h2>\n            <button className='close-profile' onClick={() => dispatch(HideProfileAction())}>X</button>\n          </div>\n          <p>\n            {realName}\n            <div id=\"profile-pronouns\">{user.pronouns}</div>\n            {description}\n          </p>\n\n          {user.item ? <p>{user.username} is currently holding {user.item}</p> : null}\n\n          <p>\n            {twitterHandle}\n            {url}\n            {askMeAbout}\n          </p>\n          <div id=\"chat-container\">\n            <div id=\"chat-header\">Whisper Chat</div>\n            <div id=\"chat\">\n              {whisperMessages.length > 0 ? whisperMessages.map((m, idx) => {\n                const id = `whisper-message-${idx}`\n                return <ProfileWhisperView {...m} key={id} id={id} otherUser={user} />\n              }) : <em>{`This is the beginning of your whisper chat with ${user.username}`}</em>}\n            </div>\n            <InputView sendMessage={(message) => dispatch(SendMessageAction(`/whisper ${user.username} ${message}`))}/>\n          </div>\n        </div>\n      </div>\n    </Linkify>\n  )\n}\n","import React, { useState, useContext } from 'react'\nimport { FaCog, FaVolumeUp, FaVolumeMute, FaVideo, FaVideoSlash, FaUser } from 'react-icons/fa'\n\nimport { DispatchContext } from '../App'\nimport { ShowModalAction } from '../Actions'\nimport { Modal } from '../modals'\nimport { useMediaChatContext } from '../videochat/mediaChatContext'\n\ninterface Props {\n  speaking: boolean\n  hideUI?: boolean\n}\n\nexport default function LocalMediaView (props: Props) {\n  const dispatch = useContext(DispatchContext)\n  const { localStreamView, setMicEnabled, setCameraEnabled, cameraEnabled, micEnabled } = useMediaChatContext()\n\n  const onChangeVideo = (e) => {\n    setCameraEnabled(!cameraEnabled)\n  }\n\n  const onChangeAudio = (e) => {\n    setMicEnabled(!micEnabled)\n  }\n\n  const showMediaSelector = () => {\n    dispatch(ShowModalAction(Modal.MediaSelector))\n  }\n\n  if (!localStreamView) {\n    return null\n  }\n\n  return (\n    <div className=\"my-video\">\n      You\n      {cameraEnabled ? (\n        localStreamView\n      ) : (\n        <FaUser\n          size={90}\n          style={{ textAlign: 'center' }}\n          className=\"placeholder-avatar\"\n        />\n      )}\n      {props.hideUI ? (\n        ''\n      ) : (\n        <div>\n          <button\n            id=\"send-video\"\n            onClick={onChangeVideo}\n            className={`link-styled-button video-button ${\n              cameraEnabled ? 'enabled' : 'disabled'\n            }`}\n            aria-label=\"Toggle Video\"\n          >\n            {cameraEnabled ? <FaVideo /> : <FaVideoSlash />}\n          </button>\n          <button\n            id=\"send-audio\"\n            onClick={onChangeAudio}\n            className={`link-styled-button video-button ${\n              micEnabled ? 'enabled' : 'disabled'\n            }`}\n            aria-label=\"Toggle Audio\"\n          >\n            {micEnabled ? <FaVolumeUp /> : <FaVolumeMute />}\n          </button>\n          <button\n            id=\"show-media-selector\"\n            onClick={showMediaSelector}\n            className=\"link-styled-button video-button\"\n            aria-label=\"Show Media Selector\"\n          >\n            <FaCog />\n          </button>\n        </div>\n      )}\n    </div>\n  )\n}\n","import { useEffect, useRef } from 'react'\nimport { AudioTrack as IAudioTrack } from 'twilio-video'\n\ninterface AudioTrackProps {\n  track: IAudioTrack;\n}\n\n// TODO: Figure out what's up with activeSinkId\n\nexport default function AudioTrack ({ track }: AudioTrackProps) {\n//   const { activeSinkId } = useAppState()\n  const audioEl = useRef<HTMLAudioElement>()\n\n  useEffect(() => {\n    audioEl.current = track.attach()\n    audioEl.current.setAttribute('data-cy-audio-track-name', track.name)\n    document.body.appendChild(audioEl.current)\n    return () => track.detach().forEach(el => el.remove())\n  }, [track])\n\n  //   useEffect(() => {\n  //     audioEl.current?.setSinkId?.(activeSinkId)\n  //   }, [activeSinkId])\n\n  return null\n}\n","\nimport React, { useRef, useEffect } from 'react'\nimport { LocalVideoTrack, RemoteVideoTrack, Track } from 'twilio-video'\nimport useMediaStreamTrack from './useMediaStreamTrack'\nimport useVideoTrackDimensions from './useVideoTrackDimensions'\n\ninterface VideoTrackProps {\n  track: LocalVideoTrack | RemoteVideoTrack;\n  isLocal?: boolean;\n  priority?: Track.Priority | null;\n}\n\nexport default function VideoTrack ({ track, isLocal, priority }: VideoTrackProps) {\n  const ref = useRef<HTMLVideoElement>(null!)\n  const mediaStreamTrack = useMediaStreamTrack(track)\n  const dimensions = useVideoTrackDimensions(track)\n  const isPortrait = (dimensions?.height ?? 0) > (dimensions?.width ?? 0)\n  console.log('Rendering videotrack', track)\n  useEffect(() => {\n    const el = ref.current\n    el.muted = true\n    if ((track as RemoteVideoTrack).setPriority && priority) {\n      (track as RemoteVideoTrack).setPriority(priority)\n    }\n    track.attach(el)\n    return () => {\n      track.detach(el)\n      if ((track as RemoteVideoTrack).setPriority && priority) {\n        // Passing `null` to setPriority will set the track's priority to that which it was published with.\n        (track as RemoteVideoTrack).setPriority(null)\n      }\n    }\n  }, [track, priority, mediaStreamTrack])\n\n  // The local video track is mirrored if it is not facing the environment.\n  const isFrontFacing = mediaStreamTrack?.getSettings().facingMode !== 'environment'\n  const style = {\n    transform: isLocal && isFrontFacing ? 'rotateY(180deg)' : '',\n    objectFit: isPortrait || track.name.includes('screen') ? ('contain' as const) : ('cover' as const)\n  }\n\n  // eslint-disable-next-line jsx-a11y/media-has-caption\n  return <video ref={ref} style={style} />\n}\n","\nimport { useState, useEffect } from 'react'\nimport { AudioTrack, VideoTrack } from 'twilio-video'\n\n/*\n * This hook allows components to reliably use the 'mediaStreamTrack' property of\n * an AudioTrack or a VideoTrack. Whenever 'localTrack.restart(...)' is called, it\n * will replace the mediaStreamTrack property of the localTrack, but the localTrack\n * object will stay the same. Therefore this hook is needed in order for components\n * to rerender in response to the mediaStreamTrack changing.\n */\nexport default function useMediaStreamTrack (track?: AudioTrack | VideoTrack) {\n  const [mediaStreamTrack, setMediaStreamTrack] = useState(track?.mediaStreamTrack)\n\n  useEffect(() => {\n    setMediaStreamTrack(track?.mediaStreamTrack)\n\n    if (track) {\n      const handleStarted = () => { console.log('Set media stream track!'); setMediaStreamTrack(track.mediaStreamTrack) }\n      track.on('started', handleStarted)\n      return () => {\n        track.off('started', handleStarted)\n      }\n    }\n  }, [track])\n\n  return mediaStreamTrack\n}\n","\nimport { useState, useEffect } from 'react'\nimport { LocalVideoTrack, RemoteVideoTrack } from 'twilio-video'\n\ntype TrackType = LocalVideoTrack | RemoteVideoTrack;\n\nexport default function useVideoTrackDimensions (track?: TrackType) {\n  const [dimensions, setDimensions] = useState(track?.dimensions)\n\n  useEffect(() => {\n    setDimensions(track?.dimensions)\n\n    if (track) {\n      const handleDimensionsChanged = (track: TrackType) => setDimensions({\n        width: track.dimensions.width,\n        height: track.dimensions.height\n      })\n      track.on('dimensionsChanged', handleDimensionsChanged)\n      return () => {\n        track.off('dimensionsChanged', handleDimensionsChanged)\n      }\n    }\n  }, [track])\n\n  return dimensions\n}\n","import React from 'react'\nimport useTrack from './useTrack'\nimport AudioTrack from './AudioTrack'\nimport VideoTrack from './VideoTrack'\n\nimport {\n  AudioTrack as IAudioTrack,\n  LocalTrackPublication,\n  LocalVideoTrack,\n  RemoteTrackPublication,\n  RemoteVideoTrack,\n  Track\n} from 'twilio-video'\n\ninterface PublicationProps {\n  publication: LocalTrackPublication | RemoteTrackPublication;\n  isLocalParticipant?: boolean;\n  videoOnly?: boolean;\n  videoPriority?: Track.Priority | null;\n}\n\nexport default function Publication ({ publication, isLocalParticipant, videoOnly, videoPriority }: PublicationProps) {\n  const track = useTrack(publication)\n\n  if (!track) return null\n\n  switch (track.kind) {\n    case 'video':\n      return (\n        <VideoTrack\n          track={track as LocalVideoTrack|RemoteVideoTrack}\n          priority={videoPriority}\n          isLocal={track.name.includes('camera') && isLocalParticipant}\n        />\n      )\n    case 'audio':\n      return videoOnly ? null : <AudioTrack track={track as IAudioTrack} />\n    default:\n      return null\n  }\n}\n","\nimport { useEffect, useState } from 'react'\nimport { LocalTrackPublication, RemoteTrackPublication } from 'twilio-video'\n\nexport default function useTrack (publication: LocalTrackPublication | RemoteTrackPublication | undefined) {\n  const [track, setTrack] = useState(publication && publication.track)\n\n  useEffect(() => {\n    // Reset the track when the 'publication' variable changes.\n    setTrack(publication && publication.track)\n\n    if (publication) {\n      const removeTrack = () => setTrack(null)\n\n      publication.on('subscribed', setTrack)\n      publication.on('unsubscribed', removeTrack)\n      return () => {\n        publication.off('subscribed', setTrack)\n        publication.off('unsubscribed', removeTrack)\n      }\n    }\n  }, [publication])\n\n  return track\n}\n","\nimport React from 'react'\nimport { Participant, Track } from 'twilio-video'\nimport Publication from './Publication'\nimport usePublications, { TrackPublication } from './usePublications'\n\ninterface ParticipantTracksProps {\n  participant: Participant;\n  // These handle whether the video/audio is run on the client-side only - they don't change the underlying tracks\n  displayVideo: boolean;\n  displayAudio: boolean;\n  videoOnly?: boolean;\n  enableScreenShare?: boolean;\n  videoPriority?: Track.Priority | null;\n  isLocalParticipant?: boolean;\n}\n\n/*\n *  The object model for the Room object (found here: https://www.twilio.com/docs/video/migrating-1x-2x#object-model) shows\n *  that Participant objects have TrackPublications, and TrackPublication objects have Tracks.\n *\n *  The React components in this application follow the same pattern. This ParticipantTracks component renders Publications,\n *  and the Publication component renders Tracks.\n */\n\n// TODO: This should handle mute\n\nexport default function ParticipantTracks ({\n  participant,\n  displayVideo,\n  displayAudio,\n  videoOnly,\n  videoPriority,\n  isLocalParticipant\n}: ParticipantTracksProps) {\n  const publications = usePublications(participant)\n  const videoPublications = publications.filter(p => p.kind === 'video')\n  const audioPublications = publications.filter(p => p.kind === 'audio')\n\n  let finalPublications: TrackPublication[] = []\n\n  if (displayVideo && videoPublications.length > 0) {\n    finalPublications.push(videoPublications[0])\n  }\n\n  if (displayAudio) {\n    finalPublications = finalPublications.concat(audioPublications)\n  }\n\n  return (\n    <>\n      {\n        finalPublications.map(publication => {\n          return <Publication\n            key={publication.kind}\n            publication={publication}\n            isLocalParticipant={isLocalParticipant}\n            videoOnly={videoOnly}\n            videoPriority={videoPriority}\n          />\n        })\n      }\n    </>\n  )\n}\n","import { useEffect, useState } from 'react'\nimport { LocalTrackPublication, Participant, RemoteTrackPublication } from 'twilio-video'\n\nexport type TrackPublication = LocalTrackPublication | RemoteTrackPublication;\n\nexport default function usePublications (participant: Participant) {\n  const [publications, setPublications] = useState<TrackPublication[]>([])\n\n  useEffect(() => {\n    // Reset the publications when the 'participant' variable changes.\n    setPublications(Array.from(participant.tracks.values()) as TrackPublication[])\n\n    const publicationAdded = (publication: TrackPublication) =>\n      setPublications(prevPublications => [...prevPublications, publication])\n    const publicationRemoved = (publication: TrackPublication) =>\n      setPublications(prevPublications => prevPublications.filter(p => p !== publication))\n\n    participant.on('trackPublished', publicationAdded)\n    participant.on('trackUnpublished', publicationRemoved)\n    return () => {\n      participant.off('trackPublished', publicationAdded)\n      participant.off('trackUnpublished', publicationRemoved)\n    }\n  }, [participant])\n\n  return publications\n}\n","import React from 'react'\nimport { FaVolumeUp, FaVolumeMute, FaVideo, FaVideoSlash, FaUser } from 'react-icons/fa'\nimport NameView from './NameView'\n\nimport '../../style/videoChat.css'\nimport ParticipantTracks from '../videochat/twilio/ParticipantTracks'\nimport * as Twilio from 'twilio-video'\n\ninterface Props {\n  participant: Twilio.Participant\n  isDominant: boolean\n  renderAsFace: boolean\n}\n\nexport default function ParticipantChatView (props: Props) {\n  const [playVideo, setPlayVideo] = React.useState<boolean>(props.renderAsFace)\n  const [playAudio, setPlayAudio] = React.useState<boolean>(true)\n\n  const onChangeVideo = (e) => {\n    setPlayVideo(!playVideo)\n  }\n\n  const onChangeAudio = (e) => {\n    setPlayAudio(!playAudio)\n  }\n\n  const customStyle = {\n    border: props.isDominant ? 'solid' : undefined\n  }\n\n  if (!props.renderAsFace) {\n    return (\n      <ParticipantTracks\n        participant={props.participant}\n        displayVideo={false}\n        displayAudio={playAudio}\n      />\n    )\n  }\n\n  const hasVideoTracks = props.participant.videoTracks.size > 0\n  const hasAnyTracks = props.participant.audioTracks.size + props.participant.videoTracks.size > 0\n\n  if (!hasAnyTracks) {\n    return <div key={`stream-wrapper-${props.participant.identity}`} />\n  }\n\n  let placeholderAvatar\n  if (!playVideo || !hasVideoTracks) {\n    placeholderAvatar = <FaUser size={90} style={{ textAlign: 'center' }} className='placeholder-avatar'/>\n  }\n\n  return (\n    <div key={`stream-wrapper-${props.participant.identity}`} className='participant-track-square other-participant' style={customStyle}>\n      <NameView userId={props.participant.identity} id={`stream-nameview-${props.participant.identity}`} nowrap={true} />\n      <ParticipantTracks participant={props.participant} displayVideo={playVideo} displayAudio={playAudio} />\n      {hasVideoTracks\n        ? <button id='play-video'\n          onClick={onChangeVideo}\n          className={`link-styled-button video-button ${playVideo ? 'enabled' : 'disabled'}`}\n          aria-label={`Toggle Video ${props.participant.identity}`}>\n          {playVideo ? <FaVideo /> : <FaVideoSlash />}\n        </button>\n        : null}\n      {placeholderAvatar}\n      <button id='play-audio'\n        onClick={onChangeAudio}\n        className={`link-styled-button video-button ${playAudio ? 'enabled' : 'disabled'}`}\n        aria-label={`Toggle Audio ${props.participant.identity}`}>\n        {playAudio ? <FaVolumeUp /> : <FaVolumeMute />}\n      </button>\n    </div>\n  )\n}\n","import React from 'react'\nimport { FaCog } from 'react-icons/fa'\nimport { SetAudioOnlyModeAction, SetTextOnlyModeAction, ShowModalAction, ShowModalWithOptionsAction, StopVideoChatAction } from '../Actions'\nimport { DispatchContext } from '../App'\nimport { Modal } from '../modals'\nimport { useMediaChatContext } from '../videochat/mediaChatContext'\n\ninterface Props {\n  inMediaChat: boolean\n  textOnlyMode: boolean\n  offscreenCount: number\n  totalCount: number\n  audioOnlyMode: boolean\n  canJoinVideoChat: boolean\n}\nconst MediaChatButtonView = (props: Props) => {\n  const {\n    currentMic,\n    currentCamera,\n    publishingCamera,\n    publishingMic,\n    inCall,\n    publishMedia,\n    publishAudio,\n    unpublishMedia\n  } = useMediaChatContext()\n\n  const dispatch = React.useContext(DispatchContext)\n\n  const leaveVideoChat = () => {\n    dispatch(StopVideoChatAction())\n    unpublishMedia()\n  }\n\n  const joinVideoChat = async () => {\n    if (!props.canJoinVideoChat) return\n    if (currentMic || currentCamera) {\n      publishMedia()\n    } else {\n      dispatch(ShowModalAction(Modal.MediaSelector))\n    }\n  }\n\n  const showMediaSelector = () => {\n    dispatch(ShowModalAction(Modal.MediaSelector))\n  }\n\n  const joinAudioChat = async () => {\n    if (!props.canJoinVideoChat) return\n    if (currentMic) {\n      publishAudio()\n    } else {\n      dispatch(\n        ShowModalWithOptionsAction(Modal.MediaSelector, { hideVideo: true })\n      )\n    }\n  }\n\n  const enableTextOnlyMode = () => {\n    const prompt = confirm('This will disable all audio/video aspects of this space other than the ' +\n      'stream in the theater. You will no longer be able to see or hear other participants, but you can still ' +\n      'interact via text chat.\\n\\nSwitching modes will refresh your page - please be patient while it reloads.'\n    )\n    if (prompt) {\n      dispatch(SetTextOnlyModeAction(true, true))\n    }\n  }\n\n  const disableTextOnlyMode = () => {\n    const prompt = confirm('Re-enabling video and audio mode means that you will be able to see and hear video and audio from ' +\n      'other participants. Your camera and microphone will default to off when you switch modes.\\b\\n\\nSwitching modes will ' +\n      'refresh your page - please be patient while it reloads.'\n    )\n    if (prompt) {\n      dispatch(SetTextOnlyModeAction(false, true))\n    }\n  }\n\n  const toggleAudioOnlyMode = () => {\n    let text\n    if (props.audioOnlyMode) {\n      text =\n        'This will show you others&apos; webcam feeds. ' +\n        'This will not affect whether or not you are sending your own webcam feed to others.'\n    } else {\n      text = 'This will hide all video feeds from other attendees. ' +\n        \"You will still be able to hear them, but you won't see them. This may improve performance if things are slow.\\n\\n\" +\n        'Note that you will still broadcast your webcam feed to others if you enable it, and you will ' +\n        'still be able to see the talks broadcast in the Theater.'\n    }\n    const prompt = confirm(text)\n    if (prompt) {\n      dispatch(SetAudioOnlyModeAction(!props.audioOnlyMode))\n    }\n  }\n\n  let chatButtons\n  if (props.inMediaChat) {\n    let leaveButtonLabel = ''\n    if (publishingCamera && publishingMic) {\n      leaveButtonLabel = 'Turn off Webcam and Mic'\n    } else if (publishingCamera) {\n      // This case shouldn't ever exist with the current UI\n      leaveButtonLabel = 'Turn off Webcam'\n    } else if (publishingMic) {\n      leaveButtonLabel = 'Turn off Mic'\n    }\n    chatButtons = (\n      <>\n        <button onClick={leaveVideoChat} id=\"join-video-chat\">\n          {leaveButtonLabel}\n        </button>\n        <button\n          key=\"show-media-selector\"\n          id=\"big-reconfigure-media-selector\"\n          onClick={showMediaSelector}\n          className=\"link-styled-button video-button\"\n          aria-label=\"Show Media Selector\"\n        >\n          <FaCog />\n        </button>\n      </>\n    )\n  } else if (props.textOnlyMode) {\n    chatButtons = [\n      <button key=\"text-only-mode\" onClick={disableTextOnlyMode} id=\"toggle-text-only-mode\">\n          Re-Enable Audio/Video\n      </button>\n    ]\n  } else if (props.canJoinVideoChat) {\n    chatButtons = [\n      <button key=\"join-video\" onClick={joinVideoChat} id=\"join-video-chat\">\n        {inCall ? 'Turn on Webcam + Mic' : <s>Turn on Webcam + Mic</s>}\n      </button>,\n      <button key=\"join-audio\" onClick={joinAudioChat} id=\"join-audio-chat\">\n        {inCall ? 'Turn on Mic' : <s>Turn on Mic</s>}\n      </button>,\n      <button\n        key=\"show-media-selector\"\n        id=\"big-reconfigure-media-selector\"\n        onClick={showMediaSelector}\n        className=\"link-styled-button video-button\"\n        aria-label=\"Show Media Selector\"\n      >\n        <FaCog />\n      </button>\n    ]\n  }\n\n  var offscreenLabel\n  if (props.totalCount > 0) {\n    offscreenLabel = (\n      <div className=\"offscreen-count\">\n        {props.totalCount} {props.totalCount === 1 ? 'person is' : 'people are'} in the call{publishingCamera || publishingMic ? ', not including you' : ''}.\n      </div>\n    )\n  }\n\n  return (\n    <div id=\"media-chat-buttons\">\n      {offscreenLabel}\n      {chatButtons}\n      <div>\n        <button\n          key=\"audio-only-mode\"\n          onClick={toggleAudioOnlyMode}\n          id=\"toggle-audio-only-mode\"\n          className=\"link-styled-button\"\n        >\n          {props.audioOnlyMode ? 'Show' : 'Hide'} all video feeds\n        </button>\n        <button\n          key=\"text-only-mode\"\n          onClick={enableTextOnlyMode}\n          id=\"toggle-text-only-mode\"\n          className=\"link-styled-button\"\n        >\n          Mute all audio and video\n        </button>\n      </div>\n    </div>\n  )\n}\n\nexport default MediaChatButtonView\n","import React, { useEffect, VideoHTMLAttributes, useRef, useState } from 'react'\nimport LocalMediaView from './LocalMediaView'\n\nimport '../../style/videoChat.css'\nimport { useMediaChatContext } from '../videochat/mediaChatContext'\nimport ParticipantChatView from './ParticipantChatView'\nimport MediaChatButtonView from './MediaChatButtonView'\nimport { SetTextOnlyModeAction } from '../Actions'\nimport { DispatchContext } from '../App'\nimport { MinimalUser } from '../../server/src/user'\n\ninterface MediaProps {\n  visibleSpeakers: [string, Date][]\n  currentSpeaker: string\n  numberOfFaces: number\n  inMediaChat: boolean\n  textOnlyMode: boolean\n  audioOnlyMode: boolean\n  currentUser: MinimalUser\n}\n\nexport default function MediaChatView (props: MediaProps) {\n  const { publishingCamera, callParticipants, inCall, joinCallFailed } = useMediaChatContext()\n  const dispatch = React.useContext(DispatchContext)\n\n  // TODO: props.visibleSpeakers should never be undefined, but it is?!\n  const visibleSpeakers = (props.visibleSpeakers || []).map(x => x[0])\n\n  console.log('Re-rendering media chat view?')\n\n  if (!inCall) {\n    if (joinCallFailed) {\n      return (\n        <div id=\"media-wrapper\">\n          <strong>\n            Could not connect to audio/video! Rooms are max 50 chatters - if you\n            want to use audio/video, try moving to another room. Otherwise, it\n            may be a network issue.\n          </strong>\n        </div>\n      )\n    } else if (props.textOnlyMode) {\n      const disableTextMode = () => {\n        const prompt = confirm('Entering video/audio mode means that you will be able to see and hear video and audio from ' +\n          'other participants. Your camera and microphone will default to off when you switch modes. Switching modes will ' +\n          'refresh your page - please be patient while it reloads.'\n        )\n        if (prompt) {\n          dispatch(SetTextOnlyModeAction(false, true))\n        }\n      }\n\n      return (\n        <div id=\"media-wrapper\">\n          There may be a voice/video call happening here that you can&apos;t see.\n          <button className=\"link-styled-button\" onClick={disableTextMode} style={{ marginLeft: '1em' }}>Disable Text-Only Mode</button>.\n        </div>\n      )\n    } else {\n      return (\n        <div id=\"media-wrapper\">\n          <strong>Attempting to connect to room.</strong>\n        </div>\n      )\n    }\n  }\n\n  // TODO: Is this a meaningful fail state? What causes this? s\n  if (!callParticipants) {\n    return <div id=\"media-view\" />\n  }\n\n  let playerVideo\n  if (publishingCamera) {\n    playerVideo = <LocalMediaView speaking={false} />\n  }\n\n  const participants = Array.from(callParticipants.values())\n    .filter(p => p.audioTracks.size + p.videoTracks.size > 0)\n\n  const videoParticipantIds = participants\n    .filter((p) => visibleSpeakers.includes(p.identity))\n\n  const audioParticipantIds = participants\n    .filter((p) => !visibleSpeakers.includes(p.identity))\n\n  console.log('[NUM_FACES]: ', props.numberOfFaces)\n  // We might have folks on video, but no \"dominantSpeaker\" notifications generated yet.\n  // We should still flesh out the wall o' faces in that situation.\n  // NOTE: This will result in video folks being added in whatever they appear in an Arrayified callParticipants\n  // I don't know what that ordering is, or if it's deterministic.\n  while (videoParticipantIds.length < props.numberOfFaces && audioParticipantIds.length > 0) {\n    videoParticipantIds.push(audioParticipantIds.shift())\n  }\n\n  const videoParticipants = videoParticipantIds.map((p) => {\n    return (\n      <ParticipantChatView\n        key={`participant-chat-view-${p.identity}`}\n        participant={p}\n        isDominant={props.currentSpeaker === p.identity}\n        renderAsFace={!props.audioOnlyMode}\n      />\n    )\n  })\n\n  const audioParticipants = audioParticipantIds\n    .map((p) => {\n      <ParticipantChatView\n        participant={p}\n        isDominant={props.currentSpeaker === p.identity}\n        renderAsFace={false}\n      />\n    })\n\n  // TODO: This will eventually need to check for speakers as well\n  // It's unclear to me if this logic should live here\n  // (vs inside MediaChatButtonView, or in the data model proper)\n  const canJoinVideoChat = props.currentUser.isMod\n\n  // If we're showing the bar, we don't override the height; if we're hiding we force it to 0.\n  // We still want it to render the audioParticipants, so that's why we still paint it.\n  // TODO: this is jank\n  const customStyle = { height: playerVideo || (!props.audioOnlyMode && videoParticipants.length > 0) ? undefined : '0px' }\n  return (\n    <div id=\"media-wrapper\">\n      <div id=\"media-view\" style={customStyle}>\n        {playerVideo} {videoParticipants} {audioParticipants}\n      </div>\n      <MediaChatButtonView\n        textOnlyMode={props.textOnlyMode}\n        inMediaChat={props.inMediaChat}\n        totalCount={videoParticipants.length + audioParticipants.length}\n        canJoinVideoChat={canJoinVideoChat}\n        offscreenCount={\n          props.audioOnlyMode\n            ? videoParticipants.length + audioParticipants.length\n            : audioParticipants.length\n        }\n        audioOnlyMode={props.audioOnlyMode}\n      />\n    </div>\n  )\n}\n\n// via https://github.com/facebook/react/issues/11163\ntype PropsType = VideoHTMLAttributes<HTMLVideoElement> & {\n  srcObject: MediaStream;\n};\n\nexport function HtmlVideo ({ srcObject, ...props }: PropsType) {\n  const refVideo = useRef<HTMLVideoElement>(null)\n\n  useEffect(() => {\n    if (!refVideo.current) return\n    console.log(srcObject)\n    refVideo.current.srcObject = srcObject\n  }, [srcObject])\n\n  return <video ref={refVideo} {...props} autoPlay /> // eslint-disable-line jsx-a11y/media-has-caption\n}\n","/* eslint-disable react/no-unescaped-entities */\nimport React, { useState, useContext } from 'react'\nimport { updateProfile } from '../networking'\nimport { PublicUser } from '../../server/src/user'\n\nimport '../../style/profileEditView.css'\nimport { DispatchContext } from '../App'\nimport { HideModalAction } from '../Actions'\nimport config from '../config'\n\ninterface Props {\n  isFTUE: boolean;\n  defaultHandle?: string;\n  prepopulateTwitterWithDefaultHandle?: boolean\n  user?: PublicUser;\n}\n\n// shep: issue #45. Turns ' ' into '-'\nfunction crushSpaces (s: string) : string {\n  if (s.includes(' ')) {\n    console.log('spaces detected ' + s)\n    while (s.includes(' ')) {\n      s = s.replace(' ', '-')\n    }\n    console.log('spaces crushed: ' + s)\n  }\n  return s\n}\n\nexport default function ProfileEditView (props: Props) {\n  const dispatch = useContext(DispatchContext)\n\n  const { defaultHandle, user, prepopulateTwitterWithDefaultHandle } = props\n\n  const [handle, setHandle] = useState(\n    (user && user.username) || defaultHandle || ''\n  )\n  const [realName, setRealName] = useState((user && user.realName) || '')\n  const [pronouns, setPronouns] = useState((user && user.pronouns) || '')\n  const [description, setDescription] = useState(\n    (user && user.description) || ''\n  )\n  const [askMeAbout, setAskMeAbout] = useState((user && user.askMeAbout) || '')\n  const [url, setUrl] = useState((user && user.url) || '')\n  const [twitter, setTwitter] = useState(\n    (user && user.twitterHandle) ||\n    (prepopulateTwitterWithDefaultHandle && defaultHandle) ||\n    '')\n\n  const close = () => {\n    dispatch(HideModalAction())\n  }\n\n  const submit = () => {\n    updateProfile({\n      username: handle,\n      realName,\n      pronouns,\n      description,\n      askMeAbout,\n      twitterHandle: twitter,\n      url,\n      hostname: config.SERVER_HOSTNAME\n    },\n    props.isFTUE)\n  }\n  return (\n    <div id='profile-edit' className={`container ${props.isFTUE ? 'ftue' : ''}`}>\n      <div className=\"form\">\n        <h1>{`${props.isFTUE ? 'Create' : 'Edit'} Name Badge`}</h1>\n        <div style={{ marginTop: '2em', marginBottom: '2em' }}>\n          This is your virtual conference badge!<br/>\n        Whatever you enter will be visible to other attendees.<br/>\n        You can come back and change this at any time.\n        </div>\n        <div className=\"grid\">\n          <div className=\"field\">\n            <label htmlFor=\"username\">Chat Handle</label>\n            <em>What shows up when you send messages</em>\n            <input\n              type=\"text\"\n              id=\"username\"\n              value={handle}\n              onChange={(e) => {\n                // shep: issue #45, prevent spaces in usernames\n                const s = crushSpaces(e.currentTarget.value)\n                if (s.localeCompare(e.currentTarget.value) !== 0) {\n                  e.currentTarget.value = s\n                }\n                setHandle(e.currentTarget.value)\n              }}\n            />\n          </div>\n          <div className=\"field\">\n            <label htmlFor=\"realname\">Name</label>\n            <em>Optional: Your \"IRL\" name.</em>\n            <input\n              type=\"text\"\n              id=\"real-name\"\n              value={realName}\n              onChange={(e) => setRealName(e.currentTarget.value)}\n            />\n          </div>\n          <div className=\"field\">\n            <label htmlFor=\"description\">Character Description</label>\n            <em>Optional: Describe your avatar!</em>\n            <input\n              type=\"text\"\n              id=\"description\"\n              value={description}\n              onChange={(e) => setDescription(e.currentTarget.value)}\n            />\n          </div>\n          <div className=\"field\">\n            <label htmlFor=\"pronouns\">Pronouns</label>\n            <em>e.g. \"she/her\" or \"he/they\"</em>\n            <input\n              type=\"text\"\n              id=\"pronouns\"\n              value={pronouns}\n              onChange={(e) => setPronouns(e.currentTarget.value)}\n            />\n          </div>\n          <div className=\"field\">\n            <label htmlFor=\"website\">Website</label>\n            <em>Optional: Your personal site!</em>\n            <input\n              type=\"text\"\n              id=\"website\"\n              value={url}\n              onChange={(e) => setUrl(e.currentTarget.value)}\n            />\n          </div>\n          <div className=\"field\">\n            <label htmlFor=\"twitter\">Twitter Handle</label>\n            <em>Optional: Don't include the @</em>\n            <input\n              type=\"text\"\n              id=\"twitter\"\n              value={twitter}\n              onChange={(e) => setTwitter(e.currentTarget.value)}\n            />\n          </div>\n          <div className=\"field\">\n            <label htmlFor=\"ask-me-about\">Ask Me About</label>\n            <em>Optional: What are you excited to talk about?</em>\n            <input\n              type=\"text\"\n              id=\"ask-me-about\"\n              value={askMeAbout}\n              onChange={(e) => setAskMeAbout(e.currentTarget.value)}\n            />\n          </div>\n        </div>\n        <button\n          // shep: issue #45, double checking that spaces didn't sneak into handle.\n          onClick={(e) => {\n            setHandle(crushSpaces(handle))\n            submit()\n          }}\n          className=\"submit\">\n            Save Changes\n        </button>\n      </div>\n    </div>\n  )\n}\n","import React, { useContext } from 'react'\nimport { FaCog } from 'react-icons/fa'\n\nimport { ContextMenuTrigger, ContextMenu, MenuItem } from 'react-contextmenu'\nimport { ShowModalAction } from '../Actions'\nimport { DispatchContext, UserMapContext } from '../App'\nimport { Modal } from '../modals'\nimport { fetchProfile, openOrCloseSpace, disconnect } from '../networking'\nimport { signOut } from '../authentication'\n\nexport default function MenuButtonView (props: { username: string, spaceIsClosed: boolean }) {\n  const dispatch = useContext(DispatchContext)\n  const { userMap, myId } = useContext(UserMapContext)\n\n  const user = userMap[myId]\n  const isMod = user && user.isMod\n\n  const logOut = () => {\n    const prompt = confirm('Are you sure you want to log out?')\n    // TODO: When a user disconnects via the /disconnect endpoint, it still shows that user as in the room. I suspect\n    // the same is true for banned users. Check on that.\n    if (prompt) {\n      disconnect(myId).then(() => {\n        signOut().then(() => {\n          window.location.reload()\n        })\n      }).catch((error) => {\n        console.log('error signing out', error)\n        window.location.reload()\n      })\n    }\n  }\n\n  const toggleSpaceAvailability = () => {\n    const doToggle = confirm(\n      `Are you sure you would like to ${props.spaceIsClosed ? 'open' : 'close'} the space for all non-mod users?`\n    )\n    if (doToggle) {\n      openOrCloseSpace(!props.spaceIsClosed)\n    }\n  }\n\n  const toggleSpaceItem = <MenuItem onClick={toggleSpaceAvailability}>{props.spaceIsClosed ? 'Open' : 'Close'} the Space</MenuItem>\n\n  const showProfile = () => {\n    fetchProfile(myId)\n  }\n\n  const showProfileEdit = () => {\n    dispatch(ShowModalAction(Modal.ProfileEdit))\n  }\n\n  const showSettings = () => {\n    dispatch(ShowModalAction(Modal.Settings))\n  }\n\n  const showServerSettings = () => {\n    dispatch(ShowModalAction(Modal.ServerSettings))\n  }\n\n  return (\n    <div id=\"menu-button\">\n      <ContextMenuTrigger id=\"topMenu\" holdToDisplay={0}>\n        <strong>{props.username}</strong> <FaCog />\n      </ContextMenuTrigger>\n      <ContextMenu id={'topMenu'}>\n        <MenuItem onClick={showProfile}>View Profile</MenuItem>\n        <MenuItem onClick={showProfileEdit}>Edit Profile</MenuItem>\n        <MenuItem onClick={showSettings}>Settings & Theme</MenuItem>\n        {isMod ? toggleSpaceItem : null}\n        {isMod ? <MenuItem onClick={showServerSettings}>Server Settings</MenuItem> : null}\n        <MenuItem onClick={logOut}>Log Out</MenuItem>\n      </ContextMenu>\n    </div>\n  )\n}\n","/* eslint-disable jsx-a11y/click-events-have-key-events */\n/* eslint-disable jsx-a11y/no-static-element-interactions */\nimport React, { useContext } from 'react'\nimport { Room } from '../room'\nimport { moveToRoom } from '../networking'\nimport { HideModalAction } from '../Actions'\nimport { DispatchContext } from '../App'\n\n/**\n * This renders a clickable ASCII map!\n *\n * The map itself is just plaintext ASCII pasted in here, generated using the\n * Mac app MonoDraw app (see the map.monopic file in the root of this repo)\n *\n * (In 2021, this was switched to the Windows/Mac/Linux app Playscii - that's\n * map2021.psci.)\n *\n * There are two additional data sources in here:\n *\n * 1. To make rooms clickable, there is an array of ClickableArea objects\n * that define clickable squares that move to a given roomId.\n * Coordinates are given using ASCII character coordinates, not pixels.\n *\n * 2. To add real-time presence numbers to rooms, there's an array of roomIds\n * that correspond to the number in parenthesis that lives in the ASCII map itself\n * This number is monotonically increasing. To add a new room, add its name to the\n * end of the array and then make the number you use in the ASCII map the array index.\n * The ASCII map is 0-indexed.\n */\n\n interface Props {\n  roomData: { [roomId: string]: Room };\n  currentRoomId: string\n  isMiniMap?: boolean\n }\n\n  interface ClickableArea {\n    x: number,\n    y: number,\n    height: number,\n    width: number,\n    roomId: string\n  }\n\nexport default function MapView (props: Props) {\n  const dispatch = useContext(DispatchContext)\n  const { roomData, currentRoomId } = props\n\n  // Pixel size of one ASCII character\n  let w, h\n  if (props.isMiniMap) {\n    w = 8\n    h = 13\n  } else {\n    w = 10\n    h = 21\n  }\n\n  // Scroll to make sure that the user's location is visible\n  // The empty array at the end means we only run this on first render, not every time it re-renders\n  // This ensures it only scrolls on load, not every time new presence data comes in\n  React.useEffect(() => {\n    // console.log('Attempting to scroll', `${props.isMiniMap ? 'minimap-' : ''}clickable-room-${currentRoomId}`)\n    const location = document.getElementById(`${props.isMiniMap ? 'minimap-' : ''}clickable-room-${currentRoomId}`)\n    if (location) {\n      // console.log(location)\n      location.scrollIntoView({ block: 'center', inline: 'center' })\n    } else {\n      // console.log('NO LOCATION')\n    }\n  }, (props.isMiniMap ? null : []))\n\n  if (!roomData) { return <div/> }\n\n  let map = mapText\n\n  presenceMapping.forEach((roomId, idx) => {\n    let replaceString = '[0]'\n\n    if (roomData[roomId] && roomData[roomId].users && roomData[roomId].users.length > 0) {\n      replaceString = `[${roomData[roomId].users.length}]`\n    }\n    replaceString = replaceString.padEnd(4, '.')\n    map = map.replace(`(${idx.toString().padStart(2, '0')})`, replaceString)\n  })\n\n  map = map.replace(/\\[([0-9]*)\\]/g, '($1)')\n\n  const handleClick = (e) => {\n    const roomId =\n      e.target && e.target.getAttribute && e.target.getAttribute('data-room')\n    if (roomId) {\n      moveToRoom(roomId)\n      dispatch(HideModalAction())\n    }\n  }\n\n  const clickableDivs = clickableAreas.map(a => {\n    return <div\n      style={{\n        position: 'absolute',\n        left: `${a.x * w}px`,\n        top: `${a.y * h}px`,\n        width: `${a.width * w}px`,\n        height: `${a.height * h}px`,\n        cursor: 'pointer'\n      }}\n      key={a.roomId}\n      onClick={handleClick}\n      data-room={a.roomId}\n      id={`${props.isMiniMap ? 'minimap-' : ''}clickable-room-${a.roomId}`} />\n  })\n\n  return <div className='map' style={{ position: 'relative', margin: '15px' }}>\n    {clickableDivs}\n    <pre style={{ letterSpacing: '2px', fontFamily: 'IBM Plex Mono' }}><code>\n      {map}\n    </code></pre>\n  </div>\n}\n\nconst mapText = `                                                                \n      ............................................                \n................      .................Theater....................   .Warrior..     .. Mage...        \n.Robot Labs.....      ...................(05).....................   ...(12)...     ...(13)...        \n...(00).........      ............................................   #     #        \n................      ............................................         #                #             \n................      ............................................############################             \n#      ............................................         #                #             \n#      ............................................   #     #        \n...............       ............................................   ..Rogue...     .Tourist..        \n.Space.Hangar...      ............................................   ...(14)...     ...(15)...        \n.Lounge.........      ............................................                \n...(01).........      ............................................                                        \n................      ............................................                                        \n..      ............................................                                        \n.Vending......###    ............................................                                        \n.Machine...... ##   #                                        \n...(02).......  ###                      #            \n..     ###        #  ..................Unconferencing.................. \n       ###      ...................####..................Lobby ..(16).................... \n         .................  ## \n.Office Of..         Destinations..Central Hall...     #       #     \n.Steam......         ..(06)...........(10)........  Cockatrice   #    ...Naga...   #   ..Tengu...  \n...(27).....         .................  ...(17)...##########...(18)...########...(19)...  \n#         ###        ...................     #       #     \n#   ###          ...................     #       #     \n................ ###            ...................  ..Dragon..   #    .Skeleton.   #   ...Yak....  \n.Adventurers....##              .....  ...(20)...##########...(21)...#########...(22)...  \n.Guild..........##               ...Swag Table....                   \n...(03).........    .....(11)........       \n................   ...Paint.. ..... .....................................      \n................   ...(07)... ...................###.................Bar ..(23).........Railing.      \n................   # ................... ......................................(25)..      \n#   # # ..............      \n#   ...Dyes...            #          ..Stools .........Stage...................      \n................  ##...(08)...            #          ....(24)..........(29)....................      \n.Office of......#### # .......................      \n.Transmutation..##  # .....Library....... ................................      \n...(04).........   ..SHOWER.. .......(28)........ .....................Back...(26)............      \n................   ...(09)... ................... ................................      \n           \n`\n\nconst presenceMapping = [\n  'robots',\n  'sfHub',\n  'vendingMachine',\n  'exploreHub',\n  'transmute',\n  'theater',\n  'destinations',\n  'doctorPaint',\n  'dyes',\n  'shower',\n  'hall',\n  'swag',\n  'warrior',\n  'mage',\n  'rogue',\n  'tourist',\n  'unconference',\n  'cockatrice',\n  'naga',\n  'tengu',\n  'dragon',\n  'skeleton',\n  'yak',\n  'bar',\n  'stools',\n  'railing',\n  'back',\n  'steam',\n  'library',\n  'barStage'\n]\n\nconst clickableAreas: ClickableArea[] = [\n  {\n    roomId: 'robots',\n    x: 0,\n    y: 1,\n    width: 18,\n    height: 7\n  },\n  {\n    roomId: 'sfHub',\n    x: 0,\n    y: 8,\n    width: 18,\n    height: 12\n  },\n  {\n    roomId: 'vendingMachine',\n    x: 1,\n    y: 14,\n    width: 14,\n    height: 5\n  },\n  {\n    roomId: 'exploreHub',\n    x: 0,\n    y: 25,\n    width: 18,\n    height: 9\n  },\n  {\n    roomId: 'transmute',\n    x: 0,\n    y: 34,\n    width: 18,\n    height: 7\n  },\n  {\n    roomId: 'theater',\n    x: 24,\n    y: 0,\n    width: 46,\n    height: 17\n  },\n  {\n    roomId: 'destinations',\n    x: 23,\n    y: 20,\n    width: 14,\n    height: 4\n  },\n  {\n    roomId: 'doctorPaint',\n    x: 21,\n    y: 29,\n    width: 12,\n    height: 4\n  },\n  {\n    roomId: 'dyes',\n    x: 21,\n    y: 33,\n    width: 12,\n    height: 4\n  },\n  {\n    roomId: 'shower',\n    x: 21,\n    y: 37,\n    width: 12,\n    height: 4\n  },\n  {\n    roomId: 'hall',\n    x: 34,\n    y: 18,\n    width: 21,\n    height: 16\n  },\n  {\n    roomId: 'swag',\n    x: 37,\n    y: 27,\n    width: 14,\n    height: 4\n  },\n  {\n    roomId: 'warrior',\n    x: 73,\n    y: 1,\n    width: 12,\n    height: 4\n  },\n  {\n    roomId: 'mage',\n    x: 90,\n    y: 1,\n    width: 12,\n    height: 4\n  },\n  {\n    roomId: 'rogue',\n    x: 73,\n    y: 8,\n    width: 12,\n    height: 4\n  },\n  {\n    roomId: 'tourist',\n    x: 90,\n    y: 8,\n    width: 12,\n    height: 4\n  },\n  {\n    roomId: 'unconference',\n    x: 57,\n    y: 17,\n    width: 52,\n    height: 4\n  },\n  {\n    roomId: 'cockatrice',\n    x: 57,\n    y: 21,\n    width: 12,\n    height: 4\n  },\n  {\n    roomId: 'naga',\n    x: 77,\n    y: 21,\n    width: 12,\n    height: 4\n  },\n  {\n    roomId: 'tengu',\n    x: 96,\n    y: 21,\n    width: 12,\n    height: 4\n  },\n  {\n    roomId: 'dragon',\n    x: 57,\n    y: 25,\n    width: 12,\n    height: 4\n  },\n  {\n    roomId: 'skeleton',\n    x: 77,\n    y: 25,\n    width: 12,\n    height: 4\n  },\n  {\n    roomId: 'yak',\n    x: 96,\n    y: 25,\n    width: 12,\n    height: 4\n  },\n  {\n    roomId: 'bar',\n    x: 56,\n    y: 29,\n    width: 48,\n    height: 12\n  },\n  {\n    roomId: 'stools',\n    x: 59,\n    y: 33,\n    width: 9,\n    height: 4\n  },\n  {\n    roomId: 'railing',\n    x: 93,\n    y: 30,\n    width: 9,\n    height: 4\n  },\n  {\n    roomId: 'back',\n    x: 78,\n    y: 37,\n    width: 14,\n    height: 3\n  },\n  {\n    roomId: 'steam',\n    x: 0,\n    y: 20,\n    width: 14,\n    height: 5\n  },\n  {\n    roomId: 'library',\n    x: 34,\n    y: 36,\n    width: 21,\n    height: 5\n  },\n  {\n    roomId: 'barStage',\n    x: 73,\n    y: 33,\n    width: 14,\n    height: 4\n  }\n]\n","import React, { useContext } from 'react'\nimport { ShowModalAction } from '../Actions'\nimport { DispatchContext } from '../App'\nimport { Modal } from '../modals'\nimport { Room } from '../room'\n\nimport MapView from './MapView'\n\n interface Props {\n  roomData: { [roomId: string]: Room };\n  currentRoomId: string\n }\n\nexport default function MiniMapView (props: Props) {\n  const dispatch = useContext(DispatchContext)\n\n  const handleClickCapture = (e) => {\n    dispatch(ShowModalAction(Modal.Map))\n    e.stopPropagation()\n  }\n\n  return (\n    <div id='mini-map' onClickCapture={handleClickCapture} style={{ cursor: 'pointer' }}>\n      <MapView roomData={props.roomData} currentRoomId={props.currentRoomId} isMiniMap={true} />\n    </div>\n  )\n}\n","import React, { useContext } from 'react'\nimport { Room } from '../room'\nimport MenuButtonView from './MenuButtonView'\n\nimport '../../style/nav.css'\nimport { IsMobileContext, DispatchContext } from '../App'\nimport { HideSideMenuAction, ShowModalAction } from '../Actions'\nimport { Modal } from '../modals'\nimport MiniMapView from './MiniMapView'\n\ninterface Props {\n  roomData: { [roomId: string]: Room };\n  currentRoomId: string\n  username: string;\n  spaceIsClosed?: boolean;\n}\n\nexport default function SideNavView (props: Props) {\n  const isMobile = useContext(IsMobileContext)\n  const dispatch = useContext(DispatchContext)\n\n  const close = () => {\n    dispatch(HideSideMenuAction())\n  }\n\n  const showMap = () => {\n    dispatch(ShowModalAction(Modal.Map))\n  }\n\n  const showHappeningNow = () => {\n    dispatch(ShowModalAction(Modal.HappeningNow))\n  }\n\n  return (\n    <nav id=\"side-menu\" role=\"navigation\" aria-label=\"List of rooms you can navigate to\">\n      {isMobile ? <button\n        onClick={close}\n        id='close-button'\n        className='close'\n      >x</button> : ''}\n      <MenuButtonView username={props.username} spaceIsClosed={props.spaceIsClosed} />\n      <button id='happening-now-button' onClick={showHappeningNow}>Happening Now</button>\n      <button id='nav-map-button' onClick={showMap}>Map</button>\n      <ul>\n        <MenuItem title=\"Schedule\" modal={Modal.Schedule} />\n        <MenuItem title=\"Room List\" modal={Modal.RoomList} />\n        <MenuItem title=\"Code of Conduct\" modal={Modal.CodeOfConduct} />\n        <MenuItem title=\"Help\" modal={Modal.Help} />\n      </ul>\n      {props.roomData && props.currentRoomId\n        ? <MiniMapView roomData={props.roomData} currentRoomId={props.currentRoomId}/>\n        : null\n      }\n    </nav>\n  )\n}\n\nconst MenuItem = (props: {title: string, modal: Modal}) => {\n  const dispatch = useContext(DispatchContext)\n\n  const handler = () => {\n    dispatch(ShowModalAction(props.modal))\n  }\n  return (\n    <li>\n      <button className='nav-item' onClick={handler}>\n        <strong>{props.title}</strong>\n      </button>\n    </li>\n  )\n}\n","import React, { useContext } from 'react'\nimport { FaThumbsUp, FaRegThumbsUp } from 'react-icons/fa'\nimport ReactTooltip from 'react-tooltip'\nimport Linkify from 'react-linkify'\n\nimport { RoomNote } from '../../server/src/roomNote'\nimport { UserMapContext } from '../App'\nimport { MinimalUser } from '../../server/src/user'\nimport { deleteRoomNote, unlikeRoomNote, likeRoomNote } from '../networking'\nimport NameView from './NameView'\n\nexport function NoteView (props: { note: RoomNote }) {\n  const { userMap, myId } = useContext(UserMapContext)\n  const n = props.note\n\n  const me: MinimalUser = userMap[myId]\n  const canDelete = me.isMod || n.authorId === myId\n  const canLike = n.authorId !== myId\n\n  const onClickDelete = () => {\n    if (confirm('Are you sure you would like to delete this?')) {\n      deleteRoomNote(n.id)\n    }\n  }\n\n  const hasLiked = n.likes && n.likes.includes(myId)\n  const likes = n.likes ? n.likes.length : 0\n  let likeNames\n\n  if (hasLiked) {\n    likeNames = n.likes.map(l => userMap[l].username).join(', ')\n  }\n\n  const onClickLike = () => {\n    if (!canLike) return\n    if (hasLiked) {\n      unlikeRoomNote(n.id)\n    } else {\n      likeRoomNote(n.id)\n    }\n  }\n\n  const linkDecorator = (href, text, key) => (\n    <a href={href} key={key} target=\"_blank\" rel=\"noopener noreferrer\">\n      {text}\n    </a>\n  )\n\n  return (\n    <Linkify componentDecorator={linkDecorator}>\n      <div className='note'>\n        {canDelete ? <button onClick={onClickDelete} className='link-styled-button note-delete'>X</button> : ''}\n        {n.message} <br/>\n        <button className={`link-styled-button like-button ${hasLiked || !canLike ? 'liked' : 'unliked'}`} onClick={onClickLike} data-tip={likeNames}>\n          {likes}{hasLiked ? <FaThumbsUp /> : <FaRegThumbsUp />}\n          <ReactTooltip />\n        </button>\n        -<NameView userId={n.authorId} id={`noteAuthor-${n.id}`}/> <br/>\n      </div>\n    </Linkify>\n  )\n}\n","import React from 'react'\nimport { RoomNote } from '../../server/src/roomNote'\nimport { ServerSettings, toServerSettings } from '../../server/src/types'\nimport { addNoteToWall, deleteRoomNote, updateServerSettings } from '../networking'\nimport { NoteView } from './NoteView'\n\nimport '../../style/noteWall.css'\nimport { NoteWallData } from '../../server/src/rooms'\nimport { PublicUser } from '../../server/src/user'\n\n// TODO: insanely silly to hardcode these here, since they can easily fall out of sync\n// If you're reading this, these are the specific room ids for Roguelike Celebration 2021\n// and you should rip them out, probably?\nconst UNCONFERENCING_ROOM_IDS = ['cockatrice', 'dragon', 'naga', 'skeleton', 'tengu', 'yak']\n\nfunction numLikes (roomNote: RoomNote) {\n  return !roomNote.likes ? 0 : roomNote.likes.length\n}\n\nexport function NoteWallView (props: {notes: RoomNote[], noteWallData?: NoteWallData, user: PublicUser, serverSettings: ServerSettings}) {\n  const addNote = () => {\n    const promptText = props.noteWallData ? props.noteWallData.addNotePrompt : 'What do you type on the note wall?'\n    const message = prompt(promptText)\n    addNoteToWall(message)\n  }\n\n  const deleteAllNotes = () => {\n    const confirmation = confirm('Are you sure you want to delete all notes?')\n    if (confirmation) {\n      props.notes.map((note) => deleteRoomNote(note.id))\n    }\n  }\n\n  const setAsUnconferencingTopics = () => {\n    const confirmation = confirm('This will assign the top 6 rooms to the unconferencing rooms, are you sure?')\n    if (confirmation && props.notes.length > 0) {\n      const settingsCopy: ServerSettings = JSON.parse(JSON.stringify(props.serverSettings))\n      const sortedDescending = props.notes.sort((a, b) => numLikes(a) < numLikes(b) ? 1 : -1)\n      const newEntries = []\n      for (var i = 0; i < Math.min(sortedDescending.length, UNCONFERENCING_ROOM_IDS.length); i++) {\n        newEntries.push({\n          text: `Unconference: ${sortedDescending[i].message} in the ${UNCONFERENCING_ROOM_IDS[i]} room.`,\n          roomId: UNCONFERENCING_ROOM_IDS[i]\n        })\n      }\n      settingsCopy.happeningNowEntries = newEntries.concat(settingsCopy.happeningNowEntries)\n      updateServerSettings(settingsCopy)\n    }\n  }\n\n  const sortedNotes = (props.notes || []).sort((a, b) => {\n    const aLikes = a.likes ? a.likes.length : 0\n    const bLikes = b.likes ? b.likes.length : 0\n    return bLikes - aLikes\n  })\n\n  const noteViews = sortedNotes.map(n => <NoteView key={n.id} note={n} />)\n\n  const description = props.noteWallData ? props.noteWallData.noteWallDescription\n    : 'You are looking at a wall with space for people to place sticky notes.'\n  const buttonText = props.noteWallData ? props.noteWallData.addNoteLinkText : 'add a note'\n\n  const massDeleteButton = props.user && props.user.isMod ? (\n    <button onClick={deleteAllNotes}>Mod: Delete all notes</button>\n  ) : (\n    ''\n  )\n\n  const setAsUnconferencingTopicsButton = props.user && props.user.isMod ? (\n    <button onClick={setAsUnconferencingTopics}>Mod: Set as unconferencing topics</button>\n  ) : (\n    ''\n  )\n\n  return (\n    <div>\n      {massDeleteButton}\n      {setAsUnconferencingTopicsButton}\n      <div className='note-wall-description'>\n        {description}\n        <br/><br/>\n        If you&apos;d like, you can <button onClick={addNote} id='addNote' className='link-styled-button'>{buttonText}</button>.\n      </div>\n      {noteViews}\n    </div>\n  )\n}\n","/* eslint-disable jsx-a11y/click-events-have-key-events */\n/* eslint-disable jsx-a11y/no-noninteractive-element-interactions */\n/* eslint-disable react/prop-types */\n\nimport React, { useContext, useEffect } from 'react'\nimport { HideModalAction } from '../Actions'\nimport { DispatchContext } from '../App'\nimport ReactDOM from 'react-dom'\n\ninterface Props {\n    fullScreen: boolean\n}\n\nexport const ModalView: React.FunctionComponent<Props> = (props) => {\n  const dispatch = useContext(DispatchContext)\n\n  useEffect(() => {\n    function keyListener (e) {\n      if (e.keyCode === 27) {\n        dispatch(HideModalAction())\n      }\n    }\n\n    document.addEventListener('keydown', keyListener)\n\n    return () => document.removeEventListener('keydown', keyListener)\n  })\n\n  const close = (e) => {\n    if (e.target.id === 'modal-wrapper' || e.target.id === 'close-button') {\n      dispatch(HideModalAction())\n    }\n  }\n\n  // createPortal means we can shove the modal in the top-level document body,\n  // instead of as part of our view hierarchy\n  return ReactDOM.createPortal(\n    <div id='modal-wrapper' onClick={close} role='dialog' aria-modal={true}>\n      <div id='modal' className={props.fullScreen ? 'full-screen' : null}>\n        <button\n          onClick={close}\n          id='close-button'\n          className='close'\n        >\n            x\n        </button>\n        {props.children}\n      </div>\n    </div>,\n    document.body\n  )\n}\n","import React, { useContext, useEffect } from 'react'\nimport { SetKeepCameraWhenMovingAction } from '../Actions'\nimport { DispatchContext } from '../App'\n\ninterface Props {\n  keepCameraWhenMoving: boolean;\n}\n\nexport default function VideoAudioSettingsView (props: Props) {\n  const dispatch = useContext(DispatchContext)\n\n  const handleKeepCameraWhenMovingSelection = (event: React.ChangeEvent<HTMLInputElement>) => {\n    const newValue = event.target.value === 'true'\n    dispatch(SetKeepCameraWhenMovingAction(newValue))\n  }\n\n  return (\n    <div className=\"videoAudioSettingsContainer\">\n      <form className=\"form\" id=\"video-audio-selection-form\">\n        <label htmlFor=\"video-audio-selection-form\" className=\"form-header\">\n          Video/Audio Options:\n        </label>\n        <div className=\"radio\">\n          <input\n            type=\"radio\"\n            id=\"keep-camera-when-moving\"\n            value=\"true\"\n            checked={props.keepCameraWhenMoving === true}\n            onChange={handleKeepCameraWhenMovingSelection}\n          />\n          Keep video/audio status when moving rooms\n        </div>\n        <div className=\"radio\">\n          <input\n            type=\"radio\"\n            id=\"keep-camera-when-moving\"\n            value=\"false\"\n            checked={props.keepCameraWhenMoving === false}\n            onChange={handleKeepCameraWhenMovingSelection}\n          />\n          Always leave video/audio when moving rooms\n        </div>\n      </form>\n    </div>\n  )\n}\n","import React, { useContext, useEffect } from 'react'\n\nimport '../../style/profileEditView.css'\nimport { SetUseSimpleNamesAction, SetCaptionsEnabledAction } from '../Actions'\nimport { DispatchContext, SettingsContext } from '../App'\n\nimport { currentTheme, setTheme } from '../storage'\nimport VideoAudioSettingsView from './VideoAudioSettingsView'\n\ninterface Props {\n  keepCameraWhenMoving: boolean;\n  captionsEnabled: boolean;\n}\n\nexport default function SettingsView (props: Props) {\n  const dispatch = useContext(DispatchContext)\n  const { useSimpleNames } = useContext(SettingsContext)\n\n  // Set the selection of the radio group upon opening the modal\n  const [selectedTheme, setSelectedTheme] = React.useState('default')\n\n  useEffect(() => {\n    (async () => {\n      setSelectedTheme(await currentTheme())\n    })()\n  })\n\n  // Handle what happens when you change the modal\n  /// change the value in local storage\n  /// then change the actual theme\n  const handleThemeSelection = (event: React.ChangeEvent<HTMLInputElement>) => {\n    console.log(selectedTheme, event.target.value)\n    document.body.classList.replace(selectedTheme, event.target.value)\n    setSelectedTheme(event.target.value)\n    setTheme(event.target.value)\n  }\n\n  const handleSimpleNamesSelection = (simple: boolean) => {\n    dispatch(SetUseSimpleNamesAction(simple))\n  }\n\n  const handleCaptionChoice = (e) => {\n    if (e.target.value === 'captions-enabled') {\n      dispatch(SetCaptionsEnabledAction(true))\n    } else if (e.target.value === 'captions-disabled') {\n      dispatch(SetCaptionsEnabledAction(false))\n    }\n  }\n\n  return (\n    <div className=\"settingsContainer\">\n      <div className=\"form\" id=\"themeSelectionForm\">\n        <label htmlFor=\"themeSelectionForm\" className=\"form-header\">\n          Select Theme:\n        </label>\n        <div className=\"radio\">\n          <input\n            type=\"radio\"\n            id=\"default-theme\"\n            value=\"default\"\n            checked={selectedTheme === 'default'}\n            onChange={handleThemeSelection}\n          />\n          <label htmlFor=\"default-theme\">Default (Dark)</label>\n        </div>\n        <div className=\"radio\">\n          <input\n            type=\"radio\"\n            id=\"solarized-dark\"\n            value=\"solarized-dark\"\n            checked={selectedTheme === 'solarized-dark'}\n            onChange={handleThemeSelection}\n          />\n          <label htmlFor=\"solarized-dark\">Solarized Dark</label>\n        </div>\n        <div className=\"radio\">\n          <input\n            type=\"radio\"\n            id=\"solarized-light\"\n            value=\"solarized-light\"\n            checked={selectedTheme === 'solarized-light'}\n            onChange={handleThemeSelection}\n          />\n          <label htmlFor=\"solarized-light\">Solarized Light</label>\n        </div>\n      </div>\n      <div className=\"form\" id=\"simpleNamesSelectionForm\">\n        <label htmlFor=\"simpleNamesSelectionForm\" className='form-header'>Username Display Mode:</label>\n        <div className=\"radio\">\n          <label>\n            <input\n              type=\"radio\"\n              name=\"simpleNameSelection\"\n              id=\"useDefaultName\"\n              checked={!useSimpleNames}\n              onChange={() => handleSimpleNamesSelection(false)}\n            />\n            Use Default Names (shows colors, fonts, and polymorph potion emojis)\n          </label>\n        </div>\n        <div className=\"radio\">\n          <label>\n            <input\n              type=\"radio\"\n              name=\"simpleNameSelection\"\n              id=\"useSimpleName\"\n              checked={useSimpleNames}\n              onChange={() => handleSimpleNamesSelection(true)}\n            />\n            Use Simple Names (text only)\n          </label>\n        </div>\n      </div>\n      <div className=\"form\" id=\"captionsEnabled\">\n        <label\n          htmlFor=\"captionsEnabled\"\n          className=\"form-header\"\n          style={{ marginBottom: 0 }}\n        >\n          Enable Captions (Experimental):\n        </label>\n        <span style={{ marginBottom: '1em' }}>\n          This will automatically transcribe spoken audio as messages in the\n          text chat.\n        </span>\n        <div className=\"radio\">\n          <input\n            type=\"radio\"\n            id=\"captions-enabled\"\n            value=\"captions-enabled\"\n            checked={props.captionsEnabled}\n            onChange={handleCaptionChoice}\n          />\n          <label htmlFor=\"captions-enabled\">Enabled</label>\n        </div>\n        <div className=\"radio\">\n          <input\n            type=\"radio\"\n            id=\"captions-disabled\"\n            value=\"captions-disabled\"\n            checked={!props.captionsEnabled}\n            onChange={handleCaptionChoice}\n          />\n          <label htmlFor=\"captions-disabled\">Disabled</label>\n        </div>\n      </div>\n      <VideoAudioSettingsView\n        keepCameraWhenMoving={props.keepCameraWhenMoving}\n      />\n    </div>\n  )\n}\n","/* eslint-disable jsx-a11y/no-onchange */\nimport React, { useContext, useEffect } from 'react'\nimport { DispatchContext } from '../App'\nimport { HideModalAction, StartVideoChatAction } from '../Actions'\nimport LocalMediaView from './LocalMediaView'\nimport { DeviceInfo, useMediaChatContext } from '../videochat/mediaChatContext'\nimport VideoAudioSettingsView from './VideoAudioSettingsView'\n\ninterface Props {\n  initialVideoDeviceId?: string;\n  initialAudioDeviceId?: string;\n\n  userIsSpeaking: boolean\n\n  roomId: string\n\n  showJoinButton?: boolean\n  hideVideo?: boolean\n  keepCameraWhenMoving: boolean\n}\n\nexport default function MediaSelectorView (props: Props) {\n  const dispatch = useContext(DispatchContext)\n  const { prepareMediaDevices, cameras, mics, currentMic, setCurrentMic, currentCamera, setCurrentCamera, publishMedia, publishAudio, publishingCamera, publishingMic, unpublishMedia } = useMediaChatContext()\n\n  useEffect(() => {\n    const run = async () => {\n      // This should maybe some \"hasSetUpDevices\" flag in the context or whatever,\n      // but checking for the existence of a device seems valid for now.\n      if (!currentMic) {\n        await prepareMediaDevices()\n        console.log('Prepared for media chat')\n      }\n    }\n    run()\n\n    // This code contains an *extremely* cursed bug.\n    // For some reason, unpublishMedia nondeterministically sometimes gets\n    // called in a context where `localVideoTrack` isn't defined,\n    // and thus we can't turn off the user's camera.\n    // Rather than descend into madness, I'm hacking around that in other ways in some cases.\n    // But leaving this in to help when it does.\n    return () => {\n      if (!publishingCamera || !publishingMic) {\n        unpublishMedia()\n      }\n    }\n  }, [])\n\n  const deviceToOption = (d: DeviceInfo) => {\n    return (\n      <option value={d.id} key={d.id}>\n        {d.name}\n      </option>\n    )\n  }\n\n  // TODO: These audio/video changes immediately affect your outgoing stream.\n  // Eventually, they shouldn't.\n  const onVideoChange = (e) => {\n    setCurrentCamera(e.target.value)\n  }\n\n  const onAudioChange = (e) => {\n    setCurrentMic(e.target.value)\n  }\n\n  const clickJoin = () => {\n    dispatch(HideModalAction())\n  }\n\n  let video\n  if (!props.hideVideo) {\n    video = (\n      <><label htmlFor=\"#video-select\">Webcam</label><select\n        name=\"Video\"\n        id=\"video-select\"\n        onChange={onVideoChange}\n        defaultValue={currentCamera && currentCamera.id}\n      >\n        {(cameras || []).map(deviceToOption)}\n      </select><br /></>\n    )\n  }\n\n  // HACK ALERT: Here because I couldn't figure out the CSS. Somebody who knows css please help, my code is dying. I\n  // think it's in videoChat.css that this should be put.\n  const mediaSelectorStyle = {\n    display: 'flex',\n    'flex-direction': 'column'\n  }\n\n  return (\n    <div id='media-selector' style={mediaSelectorStyle}>\n      <div>\n        {props.hideVideo ? '' : <LocalMediaView speaking={props.userIsSpeaking} hideUI={true}/>}\n        <div className='selects'>\n          {video}\n          <label htmlFor=\"#audio-select\">Audio</label>\n          <select\n            name=\"Audio\"\n            id=\"audio-select\"\n            onChange={onAudioChange}\n            defaultValue={currentMic && currentMic.id}\n          >\n            {(mics || []).map(deviceToOption)}\n          </select>\n        </div>\n      </div>\n      <div>\n        <VideoAudioSettingsView keepCameraWhenMoving={props.keepCameraWhenMoving} />\n      </div>\n      <button id=\"join\" onClick={clickJoin}>Use These Devices</button>\n    </div>\n  )\n}\n","import React from 'react'\n\nexport default function CodeOfConductView () {\n  return (\n    <div id='code-of-conduct'>\n      <p>Our goal is to have a fun and welcoming celebration of roguelike games, so we have a formalized code of conduct that sets these expectations.</p>\n      <p><a href='https://roguelike.club/code.html' target='_blank' rel='noreferrer'>Read our Code of Conduct.</a></p>\n      <p>If you&apos;re being harassed, notice someone being harassed, or have any other concerns related to the code of conduct, you have a few options:</p>\n      <ul>\n        <li>Type <code>/mod</code> into the chat box, followed by a message, to contact all moderators.</li>\n        <li>Email <a href=\"mailto:contact@roguelike.club\">contact@roguelike.club</a>.</li>\n        <li>If you have a report or concern related to an organizer, please contact a different member of the <a href=\"https://roguelike.club/who.html\" target=\"_blank\" rel=\"noreferrer\">organizing team</a> outside of this tool (via email, Twitter DM, Discord, or some other service).</li>\n      </ul>\n    </div>\n  )\n}\n","import React from 'react'\n\nconst SOCIAL_TIME = 'Social Time'\n\nexport interface ScheduleEntry {\n  time: Date,\n  text: string,\n  roomIds: string[]\n  breakoutRoomId?: string\n}\n\nfunction ScheduleEntry (time: string, day: number, text: string, roomIds?: string[], breakoutRoomId?: string) {\n  const dayOneDate = (time) => new Date(`2021-10-16T${time}:00.000-07:00`)\n  const dayTwoDate = (time) => new Date(`2021-10-17T${time}:00.000-07:00`)\n\n  if (day === 1) {\n    return {\n      time: dayOneDate(time), text: text, roomIds: roomIds, breakoutRoomId: breakoutRoomId\n    }\n  } else if (day === 2) {\n    return {\n      time: dayTwoDate(time), text: text, roomIds: roomIds, breakoutRoomId: breakoutRoomId\n    }\n  } else {\n    console.error('Your static data is messed up, somehow.')\n  }\n}\n\n// Saturday entries\n/*\nexport const ScheduleEntries = [\n  ScheduleEntry('09:00', 1, 'Doors Open'),\n  ScheduleEntry('09:15', 1, 'Kickoff', ['theater']),\n  ScheduleEntry('09:30', 1, 'Michael Brough: Possibility of Roguelike Elements', ['theater'], 'mage'),\n  ScheduleEntry('10:00', 1, 'Jeremiah Reid: Juice Your Turns', ['theater'], 'rogue'),\n  ScheduleEntry('10:30', 1, SOCIAL_TIME),\n  ScheduleEntry('11:00', 1, 'Brenda Romero: Dynamic Relationships and Traits in Empire of Sin', ['theater'], 'mage'),\n  ScheduleEntry('11:15', 1, 'Jasmine Otto: Cyclic Plot Generation in a Mixed-Initiative Narrative Instrument', ['theater'], 'rogue'),\n  ScheduleEntry('11:30', 1, 'Francesco Cottone: Chronicles of Stampadia and other postcards from an alternate world', ['theater'], 'tourist'),\n  ScheduleEntry('11:45', 1, 'Atty Vohra: Automating D&D Combat Prep with Roguelike Principles', ['theater'], 'warrior'),\n  ScheduleEntry('12:00', 1, SOCIAL_TIME),\n  ScheduleEntry('13:00', 1, 'Arvi Teikari: Why Noita Became a Roguelite (and Why I Liked That a Lot)', ['theater'], 'mage'),\n  ScheduleEntry('13:30', 1, 'Shawn Main: You May Already Be a Roguelike', ['theater'], 'rogue'),\n  ScheduleEntry('14:00', 1, SOCIAL_TIME),\n  ScheduleEntry('14:30', 1, 'Jason Grinblat: Before you fix a leak ask if it\\'s a fountain (a paean for bugs and edge cases)', ['theater'], 'tourist'),\n  ScheduleEntry('15:00', 1, 'Allie Signet & Joe Maliksi, Society for Internet Blaseball Research: SIBR - Sports, Splorts, and Statistics: Why Data Accessibility Matters in Blaseball and Beyond', ['theater'], 'mage'),\n  ScheduleEntry('15:30', 1, 'Evan Debenham: Community-Driven Roguelike Development', ['theater'], 'warrior'),\n  ScheduleEntry('16:00', 1, SOCIAL_TIME),\n  ScheduleEntry('17:00', 1, 'Spencer Egart: Tooling for Roguelikes and Procgen', ['theater'], 'rogue'),\n  ScheduleEntry('17:15', 1, 'Thomas Robertson: Towards a New Understanding of Procedural Super Attacks', ['theater'], 'warrior'),\n  ScheduleEntry('17:30', 1, 'Dylan White: The Cost of Magic', ['theater'], 'mage'),\n  ScheduleEntry('17:45', 1, 'Qristy Overton: Exhibition: Attempting Brogue on a Dance Mat', ['theater'], 'tourist'),\n  ScheduleEntry('18:00', 1, SOCIAL_TIME),\n  ScheduleEntry('18:15', 1, 'Unconferencing', ['unconference']),\n  ScheduleEntry('19:00', 1, SOCIAL_TIME),\n  ScheduleEntry('20:45', 1, 'Doors Close')\n]\n*/\n\nexport const ScheduleEntries = [\n  ScheduleEntry('09:00', 2, 'Doors Open'),\n  ScheduleEntry('09:15', 2, 'Kickoff', ['theater']),\n  ScheduleEntry('09:30', 2, 'Michael Langford: For the Squishies  Making Roguelikes Accessible to (Younger) Children and their Parents', ['theater'], 'warrior'),\n  ScheduleEntry('09:45', 2, 'Youns Rabii: Pokemon Glitch - Story of A Roguelike With No Author', ['theater'], 'tourist'),\n  ScheduleEntry('10:00', 2, 'Sraka-Lillian: Procedural Phonology: Generating Name Generators', ['theater'], 'rogue'),\n  ScheduleEntry('10:15', 1, SOCIAL_TIME),\n  ScheduleEntry('10:30', 2, 'Unconferencing', ['unconference']),\n  ScheduleEntry('11:30', 2, 'Alice Lai: All Together Now: Creating Multiplicative Power in Hades', ['theater'], 'warrior'),\n  ScheduleEntry('12:00', 2, 'Brian Cronin: Off The Rails - Lessons Learned from Monster Train Development', ['theater'], 'rogue'),\n  ScheduleEntry('12:30', 2, SOCIAL_TIME),\n  ScheduleEntry('13:30', 2, 'Chris McCormick: Building Juicy Minimal Roguelikes in the Browser', ['theater'], 'mage'),\n  ScheduleEntry('14:00', 2, 'Rich Wilson: Roguelikes, Immersive Sims, and the Church of the Simulation', ['theater'], 'rogue'),\n  ScheduleEntry('14:30', 2, 'Xalavier Nelson Jr.: Building an Economic Flesh Simulation Will Make You Disassociate from Reality', ['theater'], 'tourist'),\n  ScheduleEntry('15:00', 2, SOCIAL_TIME),\n  ScheduleEntry('15:30', 2, 'Kristen Yu: Video Game Quest Theory for Improved Procedural Content Generation', ['theater'], 'mage'),\n  ScheduleEntry('16:00', 2, 'Ally Brinken & Michelle Webb, En Rogue: Whos the Boss (And How and Why)?', ['theater'], 'warrior'),\n  ScheduleEntry('16:30', 2, 'John Harris: The Lost Roguelikes', ['theater'], 'rogue'),\n  ScheduleEntry('17:00', 2, SOCIAL_TIME),\n  ScheduleEntry('17:30', 2, 'Nick McConnell: Things I\\'ve Learnt from Maintaining Angband', ['theater'], 'rogue'),\n  ScheduleEntry('17:45', 2, 'Nathan Savant: One Quest To Rule Them All: Quest Design in Non-Games Media', ['theater'], 'warrior'),\n  ScheduleEntry('18:00', 2, 'Noah Swartz: The Tombs of Atuan: The Original Roguelike?', ['theater'], 'mage'),\n  ScheduleEntry('18:15', 2, SOCIAL_TIME),\n  ScheduleEntry('19:00', 2, 'Doors Close')\n]\n\nexport default function ScheduleView () {\n  const formatter = new Intl.DateTimeFormat('en', { hour: 'numeric', minute: 'numeric' })\n  const userTimeZone = formatter.resolvedOptions().timeZone\n\n  const rows = ScheduleEntries.flatMap(r => {\n    if (r.text === SOCIAL_TIME) {\n      return [(<tr key={formatter.format(r.time) + 'hr1'}><th className='break' colSpan={2}><hr /></th></tr>),\n        (<tr key={formatter.format(r.time) + 'text'}><td className='time'>{formatter.format(r.time)}</td><td className='segment'>Social Time</td></tr>),\n        (<tr key={formatter.format(r.time) + 'hr2'}><th className='break' colSpan={2}><hr /></th></tr>)]\n    } else {\n      return [(\n        <tr key={formatter.format(r.time)}>\n          <td className='time'>{formatter.format(r.time)}</td>\n          <td className='segment'>{r.text}</td>\n        </tr>\n      )]\n    }\n  })\n\n  return (\n    <div id='Schedule'>\n      <h1>Schedule</h1>\n      <p>Times below should be in your local time zone. We believe your time zone is {userTimeZone}.</p>\n      <table>\n        <tbody>\n          {rows}\n        </tbody>\n      </table>\n    </div>\n  )\n}\n","import React from 'react'\nimport { SlashCommands } from '../SlashCommands'\n\nexport default function HelpView () {\n  const rows = SlashCommands.map(command => {\n    return (\n      <tr key={command.type}>\n        <td>{command.invocations.join(', ')}</td>\n        <td>{command.description}</td>\n      </tr>\n    )\n  })\n\n  return (\n    <div>\n      <h1>Welcome!</h1>\n      <p>Welcome to the Roguelike Celebration social space! This is an open-source chat app / virtual world built specifically for Roguelike Celebration.</p>\n      <p>You can access this reference at any time by clicking the <strong>Help</strong> button in the left sidebar or by typing <strong>/help</strong> into the chat box.</p>\n      <p>If you have questions, feedback, or need to report a code of conduct violation, you can contact us via the <strong>/mod</strong> command.</p>\n      <h2>Command Reference</h2>\n      <p>You can enter any of these commands by typing directly into the chat box.</p>\n      <table>\n        {rows}\n      </table>\n    </div>\n  )\n}\n","import React, { useContext } from 'react'\nimport { ShowModalAction } from '../Actions'\nimport { DispatchContext } from '../App'\nimport { Modal } from '../modals'\nimport { Room } from '../room'\nimport MapView from './MapView'\n\n interface Props {\n  roomData: { [roomId: string]: Room };\n  currentRoomId: string\n }\n\nexport default function MapModalView (props: Props) {\n  const dispatch = useContext(DispatchContext)\n\n  const showList = () => {\n    dispatch(ShowModalAction(Modal.RoomList))\n  }\n  return (\n    <div>\n      <h1>Map</h1>\n      <p>Click on a room to move there!</p>\n      <p>If you find the map difficult to use, you can also view a <button className='link-styled-button' onClick={showList}>list of all rooms</button>.</p>\n      <MapView roomData={props.roomData} currentRoomId={props.currentRoomId} />\n    </div>\n  )\n}\n","// Note - we're doing firebase 8 because the firebaseui stuff doesn't work with 9, big F\nimport { currentUser, sendSignInLinkToEmail } from '../authentication'\nimport StyledFirebaseAuth from 'react-firebaseui/StyledFirebaseAuth'\nimport React from 'react'\nimport firebase from 'firebase/app'\nimport 'firebase/auth'\n\nconst uiConfig = {\n  callbacks: {\n    // The documentation on the firebaseui README appears somewhat borked at time of writing; the structure of\n    // AuthResult doesn't line up with itself! If you go back to that README treat it with caution.\n    signInSuccessWithAuthResult: function (authResult, redirectUrl) {\n      const user = currentUser()\n      if (user.shouldVerifyEmail) {\n        sendSignInLinkToEmail(user.email)\n      }\n      return true\n    }\n  },\n  signInOptions: [\n    firebase.auth.EmailAuthProvider.PROVIDER_ID,\n    firebase.auth.GoogleAuthProvider.PROVIDER_ID,\n    firebase.auth.TwitterAuthProvider.PROVIDER_ID\n  ]\n}\n\nexport default function LoggedOutView () {\n  return (\n    <div>\n      <header role=\"banner\">\n        <h1>Welcome to Roguelike Celebration 2021!</h1>\n      </header>\n      <main role=\"main\">\n        <p>\n          This is a social space for attendees of{' '}\n          <a href='https://roguelike.club'>Roguelike Celebration</a>, a\n          community-generated weekend of talks, games, and conversations about\n          roguelikes and related topics, including procedural generation and\n          game design. It&apos;s for fans, players, developers, scholars, and\n          everyone else!\n        </p>\n        <StyledFirebaseAuth uiConfig={uiConfig} firebaseAuth={firebase.auth()} />\n        <p>\n          If you log in via email, we will require you to verify that email address.\n        </p>\n        <p>\n          No matter which service you log in with, we do not access any data\n          other than what is needed to authenticate you. If it would make you\n          more comfortable, feel free to sign up for and use a throwaway\n          account on one of these services.\n        </p>\n        <p>\n          After logging in, you will have the opportunity to pick whatever chat handle you would\n          like before entering the space.\n        </p>\n        <p>\n          By entering the space, you agree to our{' '}\n          <a href={'https://roguelike.club/code.html'}>Code of Conduct</a>.\n        </p>\n      </main>\n    </div>\n  )\n}\n","import React from 'react'\n\nexport default function WelcomeModalView (props: {}) {\n  return (\n    <div>\n      <h1>This isn&apos;t a normal chat app!</h1>\n      <p>\n        In the Roguelike Celebration conference space, you can only send/receive\n        messages <strong>in the chat room you are currently in</strong>.\n      </p>\n      <p>\n        You can move from virtual room to virtual room to talk to different\n        people.\n      </p>\n      <p>\n        You may see or hear others on videochat, but they can&apos;t see or hear you\n        unless you explicitly turn on your audio or video.\n      </p>\n      <p>\n        Our hope is to facilitate smaller group conversations, to capture the feel of an in-person conference, and to give\n        you a fun and playful space to explore with your fellow attendees.\n      </p>\n      <p>\n        Happy wandering, and be wary of reading scrolls without identifying them\n        first ;)\n      </p>\n      <p>-The Roguelike Celebration team</p>\n    </div>\n  )\n}\n","import React from 'react'\n\nexport default function GoHomeView () {\n  return (\n    <div id='go-home'>\n      <h1>A magical force repels you from the entrance</h1>\n      <p>Roguelike Celebration is currently closed! Check the <a href=\"https://roguelike.club/event2021.html\" target=\"_blank\" rel=\"noreferrer\">schedule</a> to see when our doors will be open again.</p>\n      <p>We look forward to celebrating again with you soon :)</p>\n    </div>\n  )\n}\n","import React from 'react'\n\nexport default function YouAreBannedView () {\n  return (\n    <div id='you-are-banned'>\n      <h1>You are banned</h1>\n      <p>You have been banned from the social space. If you believe you have been banned in error, please email <b>contact at roguelike.club</b>.</p>\n    </div>\n  )\n}\n","import React from 'react'\nimport { FaVideo } from 'react-icons/fa'\nimport { moveToRoom } from '../networking'\n\nimport { Room } from '../room'\n\ninterface Props {\n    rooms: Room[]\n}\n\nexport default function RoomListView (props: Props) {\n  const list = props.rooms.map((r) => {\n    return r.hidden ? '' : <RoomListItem room={r} key={`room-sidebar-${r.id}`} />\n  })\n\n  return (\n    <div>\n      <h1>List of Rooms</h1>\n      <ul>\n        {list}\n      </ul>\n    </div>\n  )\n}\n\nconst RoomListItem = (props: { room: Room }) => {\n  const { room } = props\n\n  const onClick = () => {\n    moveToRoom(room.id)\n  }\n  const userCount = room.users ? `(${room.users.length})` : ''\n  const videoIcon = room.videoUsers && room.videoUsers.length > 0 ? <FaVideo /> : ''\n\n  return (\n    <li style={{ listStyle: 'none' }}>\n      <button onClick={onClick} className=\"link-styled-button\">\n        <strong>{room.displayName}</strong> {userCount} {videoIcon}\n      </button>\n    </li>\n  )\n}\n","import React, { useState } from 'react'\nimport { HappeningNowEntry, ServerSettings, toServerSettings } from '../../server/src/types'\nimport { resetRoomData, updateServerSettings } from '../networking'\nimport { Room } from '../room'\n\nexport default function ServerSettingsView (props: { serverSettings: ServerSettings, roomData: { [roomId: string]: Room } }) {\n  const [newSettings, setNewSettings] = useState(JSON.stringify(props.serverSettings, null, 2))\n\n  const [addHappeningNowText, setAddHappeningNowText] = useState('')\n  const [addHappeningNowRoomId, setAddHappeningNowRoomId] = useState('')\n  const [addHappeningNowExternalLink, setAddHappeningNowExternalLink] = useState('')\n\n  const submit = () => {\n    let parsedNewSettings\n    try {\n      parsedNewSettings = toServerSettings(JSON.parse(newSettings))\n    } catch (e) {\n      alert('JSON parse error: ' + e.toString())\n      return\n    }\n\n    if (!parsedNewSettings) {\n      alert('New settings were valid json but had invalid properties, please check for typos!')\n    } else {\n      updateServerSettings(parsedNewSettings)\n    }\n  }\n\n  const deleteHappeningNowEntry = (entry: HappeningNowEntry) => {\n    const confirmation = confirm('Are you sure you want to delete the happening now note?')\n    if (confirmation) {\n      // Ugh I don't feel like googling more about how to work arrays, let's just do the dumb thing\n      const settingsCopy: ServerSettings = JSON.parse(JSON.stringify(props.serverSettings))\n      settingsCopy.happeningNowEntries = props.serverSettings.happeningNowEntries.filter((i) => i.text !== entry.text)\n      updateServerSettings(settingsCopy)\n    }\n  }\n\n  const addEntry = () => {\n    if (addHappeningNowText.length === 0) {\n      alert('You need to have text!')\n      return\n    } else if (addHappeningNowRoomId.length > 0 && addHappeningNowExternalLink.length > 0) {\n      alert('You cannot have roomId and external link')\n      return\n    } else if (addHappeningNowRoomId.length > 0 && !props.roomData[addHappeningNowRoomId]) {\n      alert('No such room as ' + addHappeningNowRoomId)\n      return\n    }\n\n    const settingsCopy: ServerSettings = JSON.parse(JSON.stringify(props.serverSettings))\n    settingsCopy.happeningNowEntries.push({\n      text: addHappeningNowText,\n      roomId: addHappeningNowRoomId.length > 0 ? addHappeningNowRoomId : undefined,\n      externalLink: addHappeningNowExternalLink.length > 0 ? addHappeningNowExternalLink : undefined\n    })\n    updateServerSettings(settingsCopy)\n  }\n\n  const clickedResetRoomData = async () => {\n    if (!confirm(\"Are you sure you'd like to reset room data?\")) return\n    await resetRoomData()\n  }\n\n  return (\n    <div className='serverSettingsContainer'>\n      <button onClick={clickedResetRoomData}>Reset Room Data</button>\n      <h1>Happening Now Controls</h1>\n      <h2>Current Entries</h2>\n      {\n        props.serverSettings.happeningNowEntries.map((e) => {\n          return <li key={e.text}>\n            {JSON.stringify(e)}\n            <button id={'delete-' + e.text} onClick={() => deleteHappeningNowEntry(e)}>Delete</button>\n          </li>\n        })\n      }\n      <div className='form' id='addHappeningNowForm'>\n        <div className=\"field\">\n          <label htmlFor=\"add-happening-now-text\">Text</label>\n          <input\n            type=\"text\"\n            id=\"add-happening-now-text\"\n            value={addHappeningNowText}\n            onChange={(e) => setAddHappeningNowText(e.currentTarget.value)}\n          />\n        </div>\n        <div className=\"field\">\n          <label htmlFor=\"add-happening-now-room-id\">Room ID (blank if you want to link to an external site)</label>\n          <input\n            type=\"text\"\n            id=\"add-happening-now-room-id\"\n            value={addHappeningNowRoomId}\n            onChange={(e) => setAddHappeningNowRoomId(e.currentTarget.value)}\n          />\n        </div>\n        <div className=\"field\">\n          <label htmlFor=\"add-happening-now-external-link\">External Link (blank if you want to link to a room)</label>\n          <input\n            type=\"text\"\n            id=\"add-happening-now-external-link\"\n            value={addHappeningNowExternalLink}\n            onChange={(e) => setAddHappeningNowExternalLink(e.currentTarget.value)}\n          />\n        </div>\n        <button id='add-entry' onClick={addEntry} className='submit'>Add Entry</button>\n      </div>\n\n      <h1>Manual Controls (Finnicky)</h1>\n      <h3 id='old-settings-header'>Old settings:</h3>\n      <pre id='old-settings-pretty'>{JSON.stringify(props.serverSettings, null, 2)}</pre>\n      <h3 id='new-settings-header'>New settings:</h3>\n      <div className='form' id='serverSettingsForm'>\n        <textarea id='new-settings-textarea'\n          defaultValue={newSettings}\n          cols={50}\n          rows={30}\n          onChange={(e) => setNewSettings(e.currentTarget.value)}\n        />\n        <button\n          // shep: issue #45, double checking that spaces didn't sneak into handle.\n          onClick={(e) => {\n            submit()\n          }}\n          className='submit'>\n            Save Changes\n        </button>\n      </div>\n    </div>\n  )\n}\n","import React from 'react'\n\nexport default function ClientDeployedModal () {\n  return (\n    <div id='client-deployed'>\n      <h1>New Version Available!</h1>\n      <p>We just updated the social space with new features and bugfixes!</p>\n      <p>Please reload this page whenever is convenient so you can be running the latest code.</p>\n      <button onClick={() => window.location.reload()}>Reload</button>\n    </div>\n  )\n}\n","import React, { useContext } from 'react'\nimport { HappeningNowEntry } from '../../server/src/types'\nimport { HideModalAction } from '../Actions'\nimport { DispatchContext } from '../App'\nimport { moveToRoom } from '../networking'\nimport { Room } from '../room'\nimport { ScheduleEntries } from './ScheduleView'\n\n// Apparently reverse() does an actual reversal! WELL. All right then, Javascript.\nconst ReversedScheduleEntries = [...ScheduleEntries].reverse()\n\nexport default function HappeningNowView (props: { roomData: { [roomId: string]: Room }, entries: HappeningNowEntry[] }) {\n  const dispatch = useContext(DispatchContext)\n\n  // To test this functionality, just set it at some appropriate date in the conference time\n  // const now = new Date(`2021-10-16T10:35:00.000-07:00`)\n  const now = new Date()\n  const currentlyScheduledIdx = ReversedScheduleEntries.findIndex((entry) => entry.time < now)\n  const currentlyScheduled = ReversedScheduleEntries[currentlyScheduledIdx]\n\n  const moveAndClose = (roomId: string) => {\n    if (!props.roomData[roomId]) {\n      console.error('Can\\'t go to room ' + roomId + ' from link in happening now view, no such room!')\n    } else {\n      moveToRoom(roomId)\n      dispatch(HideModalAction())\n    }\n  }\n\n  const buildScheduledRoomList = (roomIds: string[]) => {\n    return <ul>\n      {roomIds.map((id) => {\n        return <li key={id}>\n          <button id={`button-happening-now${id}`} onClick={() => moveAndClose(id)} className='link-styled-button'>\n            {props.roomData[id] ? props.roomData[id].displayName : 'unknown room'}\n          </button>\n        </li>\n      })}\n    </ul>\n  }\n\n  let currentlyScheduledElement\n  if (currentlyScheduled) {\n    if (currentlyScheduled.text === 'Social Time') {\n      var i = currentlyScheduledIdx + 1\n      const socialTimeOptions = []\n      while (ReversedScheduleEntries[i] && ReversedScheduleEntries[i].breakoutRoomId) {\n        const breakoutEntry = ReversedScheduleEntries[i]\n        const breakoutRoomId = breakoutEntry.breakoutRoomId\n        const discussString = `Discuss ${breakoutEntry.text} in `\n        socialTimeOptions.push(\n          <li key={breakoutRoomId}>\n            {discussString}\n            <button id={`button-happening-now${breakoutRoomId}`} onClick={() => moveAndClose(breakoutRoomId)} className='link-styled-button'>\n              {props.roomData[breakoutRoomId] ? props.roomData[breakoutRoomId].displayName : 'unknown room'}\n            </button>\n          </li>\n        )\n        i++\n      }\n      socialTimeOptions.push(<li key={'option-chat'}>Chat!</li>)\n      socialTimeOptions.push(<li key={'option-explore'}>Explore the space!</li>)\n      socialTimeOptions.push(<li key={'option-hunt'}>Hunt for secrets!</li>)\n      socialTimeOptions.push(<li key={'option-free'}>Just remember to beware the grues.</li>)\n      currentlyScheduledElement = <div id = 'currently-scheduled-div'>\n        <strong>Social Time</strong>\n        <ul>\n          {socialTimeOptions}\n        </ul>\n      </div>\n    } else {\n      currentlyScheduledElement = <div id ='currently-scheduled-div'>\n        {currentlyScheduled.text}\n        {currentlyScheduled.roomIds ? buildScheduledRoomList(currentlyScheduled.roomIds) : ''}\n      </div>\n    }\n  } else {\n    currentlyScheduledElement = <strong>You&apos;re in early! Check the schedule for when the doors officially open.</strong>\n  }\n\n  return (\n    <div id='happening-now'>\n      <h1>Happening Now</h1>\n      <h2>From The Schedule</h2>\n      {currentlyScheduledElement}\n      <h2>Other Live Activities</h2>\n      <ul>\n        {\n          props.entries.map((e) => {\n            if (e.roomId) {\n              return <li key={e.text}>\n                <button id={`button-${e.text}`} onClick={() => moveAndClose(e.roomId)} className='link-styled-button'>{e.text}</button>\n              </li>\n            } else if (e.externalLink) {\n              return <li key={e.text}>\n                <a className='nav-item' href={e.externalLink} target='_blank' rel='nofollow noopener noreferrer'>{e.text}</a>\n              </li>\n            } else {\n              return <li key={e.text}>{e.text}</li>\n            }\n          })\n        }\n      </ul>\n    </div>\n  )\n}\n","import React from 'react'\nimport PageVisibility from 'react-page-visibility'\nimport { AuthenticateAction } from '../Actions'\nimport { currentUser, sendSignInLinkToEmail, signOut } from '../authentication'\n\ninterface Props {\n  userEmail: string;\n  dispatch: any;\n}\n\nexport default function VerifyEmailView (props: Props) {\n  // For some reason, this doesn't work - dispatch ends up as null. So I injected it into props. This is weird and if\n  // whoever's reading this has a good explanation I'd love to hear it! -Travis\n  // const dispatch = useContext(DispatchContext)\n  const dispatch = props.dispatch\n\n  const handleVisibilityChange = (visibility) => {\n    const user = currentUser()\n    if (visibility && user && !user.shouldVerifyEmail) {\n      dispatch(AuthenticateAction(user.id, user.id, user.providerId, false))\n    }\n  }\n\n  const goToAuth = () => {\n    signOut().then(() => {\n      dispatch(AuthenticateAction(undefined, undefined, undefined, undefined))\n    })\n  }\n\n  return (\n    <PageVisibility onChange={handleVisibilityChange}>\n      <div>\n        <header role=\"banner\">\n          <h1>Please verify your email!</h1>\n        </header>\n        <main role=\"main\">\n          <p>\n            You&apos;re currently attempting to log in as <strong>{props.userEmail}</strong>, but your email is not yet\n            verified. Please follow the link in your email to complete the registration process.\n          </p>\n          <p>\n            <strong>If you have verified your email and this page has not automatically logged you in, please refresh\n              the page manually.</strong>\n          </p>\n          <button\n            onClick={(e) => {\n              sendSignInLinkToEmail(props.userEmail)\n            }}>\n              Resend Verification Email\n          </button>\n          <br/>\n          <button onClick={goToAuth}>\n              Use a Different Provider or Email\n          </button>\n        </main>\n      </div>\n    </PageVisibility>\n  )\n}\n","import React, { useContext } from 'react'\nimport { DispatchContext } from '../App'\nimport { AuthenticateAction, HideSideMenuAction } from '../Actions'\nimport config from '../config'\nimport firebase from 'firebase/app'\nimport 'firebase/auth'\n\nexport default function EmailVerifiedView () {\n  const user = firebase.auth().currentUser\n\n  if (!user.emailVerified) {\n    firebase.auth().signInWithEmailLink(user.email, window.location.href).then(() => {\n      // A crude way of forcing a rerender, because I don't want to go through the trouble of making an action.\n      window.location.reload()\n    })\n  }\n\n  if (!user.emailVerified) {\n    return (\n      <div>\n        <header role=\"banner\">\n          <h1>Attempting to verify email.</h1>\n        </header>\n        <main role=\"main\">\n          <p>\n            Please wait while your email is verified.\n          </p>\n        </main>\n      </div>\n    )\n  } else {\n    return (\n      <div>\n        <header role=\"banner\">\n          <h1>Your email has been successfully verified!</h1>\n        </header>\n        <main role=\"main\">\n          <p>\n            You may now close this window and go back to the main app.\n          </p>\n        </main>\n      </div>\n    )\n  }\n}\n","import React from 'react'\n\nexport default function RiddleModalView (props: {riddles: string[]}) {\n  const riddleViews = props.riddles.map(function (val, index) { return <p className='riddle' key={'riddle-' + index}>{val}</p> })\n  const riddleTitle = (props.riddles.length > 1 ? 'The engraved riddles read...' : 'The engraved riddle reads...')\n\n  return (\n    <div id='riddle-modal' className='riddle-div'>\n      <h1>{riddleTitle}</h1>\n      {riddleViews}\n    </div>\n  )\n}\n","import * as sdk from 'microsoft-cognitiveservices-speech-sdk'\n\nimport {\n  ResultReason,\n  CancellationReason\n} from 'microsoft-cognitiveservices-speech-sdk'\nimport { Dispatch } from 'react'\nimport { Action, SendCaptionAction } from './Actions'\nimport { fetchCognitiveServicesKey } from './networking'\n\nlet recognizer: sdk.SpeechRecognizer | undefined\nlet speechConfig: sdk.SpeechConfig | undefined\n\nexport async function setUpSpeechRecognizer (\n  deviceId: string,\n  dispatch: Dispatch<Action>\n): Promise<void> {\n  console.log('Starting recognition')\n  if (recognizer) {\n    await recognizer.stopContinuousRecognitionAsync()\n  }\n\n  if (!speechConfig) {\n    const { cognitiveServicesKey, cognitiveServicesRegion } = await fetchCognitiveServicesKey()\n    speechConfig = sdk.SpeechConfig.fromSubscription(\n      cognitiveServicesKey,\n      cognitiveServicesRegion\n    )\n  }\n\n  const audioConfig = sdk.AudioConfig.fromMicrophoneInput(deviceId)\n  recognizer = new sdk.SpeechRecognizer(speechConfig, audioConfig)\n\n  recognizer.recognizing = (s, e) => {\n    console.log('RECOGNIZING: ', e.result.text)\n  }\n  recognizer.recognized = (s, e) => {\n    if (e.result.reason === ResultReason.RecognizedSpeech) {\n      console.log(`RECOGNIZED: Text=${e.result.text}`)\n      if (e.result.text !== '') {\n        dispatch(SendCaptionAction(e.result.text))\n      }\n    } else if (e.result.reason === ResultReason.NoMatch) {\n      console.log('NOMATCH: Speech could not be recognized.')\n    }\n  }\n\n  recognizer.canceled = (s, e) => {\n    console.log(`CANCELED: Reason=${e.reason}`)\n\n    if (e.reason === CancellationReason.Error) {\n      console.log(`\"CANCELED: ErrorCode=${e.errorCode}`)\n      console.log(`\"CANCELED: ErrorDetails=${e.errorDetails}`)\n      console.log('CANCELED: Did you update the subscription info?')\n    }\n\n    recognizer.stopContinuousRecognitionAsync()\n  }\n\n  recognizer.sessionStopped = (s, e) => {\n    console.log('\\n    Session stopped event.')\n    recognizer.stopContinuousRecognitionAsync()\n  }\n\n  recognizer.startContinuousRecognitionAsync()\n}\n\nexport async function stopSpeechRecognizer () {\n  await recognizer.stopContinuousRecognitionAsync()\n}\n","import * as React from 'react'\nimport { useState, useEffect, useContext } from 'react'\nimport * as Twilio from 'twilio-video'\nimport { HideModalAction, MediaReceivedSpeakingDataAction, RefreshReactAction, StartVideoChatAction, StopVideoChatAction } from '../Actions'\n\nimport { DispatchContext } from '../App'\n\nimport { fetchTwilioToken } from '../networking'\nimport { setUpSpeechRecognizer, stopSpeechRecognizer } from '../speechRecognizer'\nimport { DeviceInfo, MediaChatContext } from './mediaChatContext'\nimport ParticipantTracks from './twilio/ParticipantTracks'\nimport VideoTrack from './twilio/VideoTrack'\n\nexport const TwilioChatContextProvider = (props: {\n  active: boolean;\n  children: React.ReactNode;\n}) => {\n  const dispatch = useContext(DispatchContext)\n\n  const [token, setToken] = useState<string>()\n  const [roomId, setRoomId] = useState<string>()\n  const [room, setRoom] = useState<Twilio.Room>()\n  const [joinCallFailed, setJoinCallFailed] = useState<boolean>(false)\n\n  const [micEnabled, setMicEnabled] = useState<boolean>(true)\n  const [cameraEnabled, setCameraEnabled] = useState<boolean>(true)\n\n  const [cameras, setCameras] = useState<DeviceInfo[]>([])\n  const [mics, setMics] = useState<DeviceInfo[]>([])\n\n  const [currentMic, setCurrentMicInternal] = useState<DeviceInfo>()\n  const [currentCamera, setCurrentCameraInternal] = useState<DeviceInfo>()\n\n  // These are separate from current to handle the case of the media selector\n  // where we need both mic and camera enabled, but may not want to show\n  // the camera in the background\n  const [publishingCamera, setPublishingCamera] = useState<boolean>()\n  const [publishingMic, setPublishingMic] = useState<boolean>()\n\n  const [remoteParticipants, setRemoteParticipants] = useState<Map<String, Twilio.Participant>>()\n\n  const [localVideoTrack, setLocalVideoTrack] = useState<Twilio.LocalVideoTrack>()\n  const [localAudioTrack, setLocalAudioTrack] = useState<Twilio.LocalAudioTrack>()\n\n  const [localStreamView, setLocalStreamView] = useState<React.ReactNode>()\n\n  const fetchLocalAudioTrack = async () => {\n    if (localAudioTrack) {\n      return localAudioTrack\n    }\n\n    const trackObj: any = {}\n    if (currentMic) {\n      trackObj.audio = { deviceId: currentMic.id }\n    }\n\n    const track = await Twilio.createLocalAudioTrack(trackObj)\n    setLocalAudioTrack(track)\n  }\n\n  const fetchLocalVideoTrack = async () => {\n    console.log('[TWILIO] Fetching local video track')\n\n    const options: Twilio.CreateLocalTrackOptions = { // TODO: Shrink size if mobile\n      height: 720,\n      frameRate: 24,\n      width: 1280\n    }\n\n    if (currentCamera) {\n      options.deviceId = { exact: currentCamera.id }\n    }\n\n    const track = await Twilio.createLocalVideoTrack(options)\n    setLocalVideoTrack(track)\n    setLocalStreamView(<VideoTrack track={track} />)\n\n    if (publishingCamera) {\n      publishVideo()\n    }\n  }\n\n  const startTranscription = () => {\n    if (!currentMic) return\n    setUpSpeechRecognizer(currentMic.id, dispatch)\n  }\n\n  const stopTranscription = () => {\n    stopSpeechRecognizer()\n  }\n\n  const publishMedia = () => {\n    // If we don't have a room we should no-op instead of attempting to publish\n    if (!room) { return }\n    publishAudio()\n    publishVideo()\n  }\n\n  const publishAudio = async () => {\n    if (room) {\n      dispatch(StartVideoChatAction())\n      setPublishingMic(true)\n      if (localAudioTrack) {\n        room.localParticipant.publishTrack(localAudioTrack)\n        await localAudioTrack.restart()\n        startTranscription()\n      }\n    }\n  }\n\n  const publishVideo = () => {\n    if (!room) {\n      return\n    }\n\n    setPublishingCamera(true)\n\n    if (localVideoTrack) {\n      localVideoTrack.restart()\n      localVideoTrack.enable(true)\n      room.localParticipant.publishTrack(localVideoTrack)\n\n      if (!localStreamView) {\n        setLocalStreamView(<VideoTrack track={localVideoTrack} />)\n      }\n    }\n  }\n\n  const unpublishMedia = () => {\n    console.log('In unpublish', localVideoTrack)\n\n    dispatch(StopVideoChatAction())\n    setPublishingCamera(false)\n    setPublishingMic(false)\n\n    if (localAudioTrack) {\n      localAudioTrack.stop()\n      stopSpeechRecognizer()\n\n      if (room) {\n        room.localParticipant.unpublishTrack(localAudioTrack)\n      }\n    }\n\n    if (localVideoTrack) {\n      // We shouldn't need to be so aggressive,\n      // but track.stop() alone isn't doing it\n      // and I can't be bothered to test which exact combo works\n      localVideoTrack.stop()\n      localVideoTrack.detach()\n      localVideoTrack.disable()\n      localVideoTrack.mediaStreamTrack.stop()\n\n      if (room) {\n        room.localParticipant.unpublishTrack(localVideoTrack)\n      }\n    }\n\n    // setLocalStreamView(undefined)\n  }\n\n  useEffect(() => {\n    if (!props.active) return\n    console.log('[TWILIO] In useeffect for camera')\n    if (!currentCamera) return\n    console.log('[TWILIO] Has camera')\n    fetchLocalVideoTrack()\n  }, [currentCamera])\n\n  useEffect(() => {\n    if (!props.active) return\n    if (!currentMic) return\n    fetchLocalAudioTrack()\n  }, [currentMic])\n\n  useEffect(() => {\n    if (!props.active) return\n    if (micEnabled) {\n      startTranscription()\n    } else {\n      stopTranscription()\n    }\n  }, [micEnabled])\n\n  useEffect(() => {\n    if (!props.active) return\n    console.log('[TWILIO] In token roomId useEffect')\n    // The initial token might get set after calling joinCall\n    // This calls joinCall when we're ready after that initial setup\n    if (token && roomId && !room) {\n      console.log('[TWILIO] Joining room')\n      joinCall(roomId, true)\n    }\n  }, [token, roomId])\n\n  async function prepareForMediaChat () {\n    if (token) return\n    return fetchTwilioToken()\n      .then((token) => { setToken(token) })\n  }\n\n  async function prepareMediaDevices () {\n    const mapToDeviceInfo = (d: MediaDeviceInfo): DeviceInfo => {\n      console.log(d)\n      return {\n        id: d.deviceId,\n        name: d.label\n      }\n    }\n\n    try {\n      // This is just to try to force the prompt early enough\n      const stream = await navigator.mediaDevices.getUserMedia({ video: true, audio: true })\n      stream.getTracks().forEach(t => t.stop())\n\n      await navigator.mediaDevices.enumerateDevices()\n        .then((devices) => {\n          console.log('[TWILIO] Fetched devices')\n\n          const cameras = devices\n            .filter(d => d.kind === 'videoinput')\n            .map(mapToDeviceInfo)\n\n          const mics = devices\n            .filter(d => d.kind === 'audioinput')\n            .map(mapToDeviceInfo)\n\n          setCameras(cameras)\n          setMics(mics)\n\n          console.log('[TWILIO] Setting current camera', cameras[0])\n          setCurrentCameraInternal(cameras[0])\n          setCurrentMicInternal(mics[0])\n        })\n    } catch (e) {\n      console.log('[TWILIO] Error fetching media devices', e)\n      alert(\"We couldn't fetch your audio and video devices. This usually means another application is using your primary webcam or mic. Close anything that might be accessing them and try again. If that fails, confirm you haven't denied webcam/mic permission to this website in your browser.\")\n      dispatch(HideModalAction())\n    }\n  }\n\n  async function joinCall (roomId: string, shouldPublishTracks: boolean) {\n    if (!props.active) {\n      console.warn('joinCall was called while text-only mode was on')\n      return\n    }\n    // A useEffect hook will re-call this once the token exists\n    if (!token) {\n      setRoomId(roomId)\n      return\n    }\n\n    // We're real sloppy re: calling this multiple times\n    if (room && room.name === roomId) return\n\n    if (room && room.name !== roomId) {\n      // Remove from previous room\n      room.disconnect()\n    }\n\n    try {\n      const opts: Twilio.ConnectOptions = {\n        name: roomId,\n        tracks: [],\n        maxAudioBitrate: 16000, // For music remove this line\n        bandwidthProfile: {\n          video: {\n            mode: 'grid',\n            maxTracks: 10,\n            renderDimensions: {\n              high: { height: 1080, width: 1920 },\n              standard: { height: 720, width: 1280 },\n              low: { height: 176, width: 144 }\n            }\n          }\n        },\n        preferredVideoCodecs: [{ codec: 'VP8', simulcast: true }],\n        dominantSpeaker: true\n      }\n\n      if (shouldPublishTracks && localVideoTrack) {\n        // This cast shouldn't be necessary, but I'm not sure how to fix it\n        // (Because we define tracks as [] above, TS doesn't know if it's\n        // LocalTrack[] or MediaStreamTrack[])\n        (opts.tracks as Twilio.LocalTrack[]).push(localVideoTrack)\n      }\n\n      if (shouldPublishTracks && localAudioTrack) {\n        (opts.tracks as Twilio.LocalTrack[]).push(localAudioTrack)\n      }\n\n      // This is to prevent a possible race condition where the user has the leave room setting on, switches rooms,\n      // and then quickly rejoins. Because Twilio.connect can take seconds to resolve, this would lead to the user\n      // joining the *previous* room before the Twilio.connect resolved and booted them with non-functioning tracks\n      // into the new room.\n      setRoom(undefined)\n      // TODO: We should have error handling for various Twilio error codes, probably.\n      // throw 'Uncomment this to simulate a Twilio failure.'\n      const newRoom = await Twilio.connect(token, opts)\n      setJoinCallFailed(false)\n\n      // Note that dominantSpeaker can be set to null\n      newRoom.on('dominantSpeakerChanged', (participant: Twilio.Participant) => {\n        if (participant) {\n          dispatch(MediaReceivedSpeakingDataAction(participant.identity))\n        } else {\n          dispatch(MediaReceivedSpeakingDataAction(null))\n        }\n      })\n\n      // TODO: I worry this will send a single video/audio frame if disabled on start? To test\n      newRoom.localParticipant.videoTracks.forEach(publication => {\n        if (cameraEnabled) {\n          publication.track.enable()\n        } else {\n          publication.track.disable()\n        }\n      })\n\n      newRoom.localParticipant.audioTracks.forEach(publication => {\n        if (micEnabled) {\n          publication.track.enable()\n        } else {\n          publication.track.disable()\n        }\n      })\n\n      console.log('[TWILIO] In room?', newRoom)\n      console.log('[TWILIO] Attached participant count:', newRoom.participants.size)\n\n      setLocalStreamView(<ParticipantTracks participant={newRoom.localParticipant} displayVideo={cameraEnabled} displayAudio={micEnabled} />)\n      setRemoteParticipants(newRoom.participants)\n\n      // Required so that when a user who is in the room begins publishing, it shows the user on the client, as the\n      // client participant state can be out of sync with Twilio's state.\n      newRoom.on('trackPublished', (publication: Twilio.RemoteTrackPublication, participant: Twilio.RemoteParticipant) => {\n        dispatch(RefreshReactAction())\n      })\n\n      // I believe there's a race condition when another user leaves the video/audio channels between the draws due to\n      // the event and the Twilio resolution, so sometimes the client re-renders before the person has finished\n      // unpublishing. I'm not a huge fan of how many times we're pushing out the renders for the video chat, but to\n      // properly sync everything up can wait, given that the conf is in...like, less than two weeks now.\n      newRoom.on('trackUnpublished', (publication: Twilio.RemoteTrackPublication, participant: Twilio.RemoteParticipant) => {\n        dispatch(RefreshReactAction())\n      })\n\n      newRoom.on('participantConnected', () => {\n        setRemoteParticipants(newRoom.participants)\n        // HACK ALERT: setRemoteParticipants(...) does not trigger a re-render of the MediaView, hence I force it here.\n        // This function actually resolves *after* the room presence changes, so the client thinks nobody else is in\n        // the MUD room and doesn't bring up the chat client. This then resolves, but the client still doesn't see the\n        // user, so forcing a re-render surfaces that.\n        dispatch(RefreshReactAction())\n      })\n\n      newRoom.on('participantDisconnected', () => {\n        setRemoteParticipants(newRoom.participants)\n        // HACK ALERT: setRemoteParticipants(...) does not trigger a re-render of the MediaView, hence I force it here.\n        // This function actually resolves *after* the room presence changes, so the client thinks nobody else is in\n        // the MUD room and doesn't bring up the chat client. This then resolves, but the client still doesn't see the\n        // user, so forcing a re-render surfaces that.\n        dispatch(RefreshReactAction())\n      })\n\n      window.addEventListener('beforeunload', (event) => {\n        newRoom.disconnect()\n      })\n\n      setRoom(newRoom)\n    } catch (e) {\n      console.log('[TWILIO] Could not connect to room', e)\n      setLocalStreamView(null)\n      setJoinCallFailed(true)\n    }\n  }\n\n  function leaveCall () {\n    console.log('[TWILIO] In leave call', localVideoTrack)\n    if (room) room.disconnect()\n    if (localVideoTrack) localVideoTrack.stop()\n    if (localAudioTrack) localAudioTrack.stop()\n    stopTranscription()\n  }\n\n  return (\n    <MediaChatContext.Provider\n      value={{\n        prepareForMediaChat,\n        prepareMediaDevices,\n\n        cameras,\n        mics,\n\n        currentMic,\n        currentCamera,\n\n        publishingCamera,\n        publishingMic,\n\n        // TODO: Should this function be moved elsewhere?\n        // Should this logic live in a useEffect hook?\n        setCurrentCamera: async (id: string) => {\n          console.log(`[TWILIO] Setting current camera from ${currentCamera.id} (${currentCamera.name}) to ${id}`)\n          if (currentCamera && currentCamera.id !== id) {\n            console.log('[TWILIO] Removing old camera', room)\n            localVideoTrack.stop()\n            if (room) {\n              // TODO: room.unpublishTrack(localVideoTrack) wasn't working for some reason\n              // This blunt approach works for now, but will need changing if we\n              // e.g. add in screen sharing\n              /*\n              room.localParticipant.videoTracks.forEach(publication => {\n                publication.unpublish()\n              })\n              */\n              // TODO: There were huge issues with inconsistency with async timing issues leading to different media\n              // being shown to others versus shown to you - that is, users thought they were using the wrong camera.\n              // Booting the user out whenever they fiddle with their camera is brutal, but fixes it.\n              dispatch(StopVideoChatAction())\n              unpublishMedia()\n            }\n          }\n          setCurrentCameraInternal(cameras.find((c) => c.id === id))\n          localVideoTrack.restart()\n          return null\n        },\n        setCurrentMic: (id: string) => {\n          if (currentMic && currentMic.id !== id) {\n            localAudioTrack.stop()\n            if (room) {\n              /* room.localParticipant.audioTracks.forEach(publication => {\n                publication.unpublish()\n              }) */\n              dispatch(StopVideoChatAction())\n              unpublishMedia()\n            }\n          }\n          setCurrentMicInternal(mics.find(c => c.id === id))\n          localAudioTrack.restart()\n          return null\n        },\n\n        localStreamView,\n\n        publishMedia,\n        unpublishMedia,\n        publishAudio,\n\n        inCall: !!room,\n        joinCallFailed: joinCallFailed,\n        joinCall,\n        leaveCall,\n\n        callParticipants: remoteParticipants,\n\n        micEnabled,\n        setMicEnabled: (enabled: boolean) => {\n          setMicEnabled(enabled)\n          if (!room) return\n\n          room.localParticipant.audioTracks.forEach(publication => {\n            if (enabled) {\n              publication.track.enable()\n            } else {\n              // TODO: Might want to stop/unpublish\n              // to turn off light\n              publication.track.disable()\n            }\n          })\n        },\n\n        cameraEnabled,\n        setCameraEnabled: (enabled: boolean) => {\n          setCameraEnabled(enabled)\n          if (!room) return\n\n          room.localParticipant.videoTracks.forEach(publication => {\n            if (enabled) {\n              publication.track.enable()\n            } else {\n              publication.track.disable()\n            }\n          })\n        }\n      }}\n    >\n      {props.children}\n    </MediaChatContext.Provider>\n  )\n}\n","import React, { useEffect, createContext } from 'react'\n\nimport RoomView from './components/RoomView'\nimport ChatView from './components/ChatView'\nimport InputView from './components/InputView'\nimport { connect, checkIsRegistered, getServerSettings } from './networking'\nimport reducer, { State, defaultState } from './reducer'\nimport {\n  AuthenticateAction,\n  Action,\n  IsRegisteredAction,\n  LoadMessageArchiveAction,\n  ShowSideMenuAction,\n  SendMessageAction,\n  SpaceIsClosedAction,\n  PlayerBannedAction,\n  SetKeepCameraWhenMovingAction,\n  SetTextOnlyModeAction,\n  SetNumberOfFacesAction,\n  SetUseSimpleNamesAction,\n  SetCaptionsEnabledAction\n} from './Actions'\nimport ProfileView from './components/ProfileView'\nimport { useReducerWithThunk } from './useReducerWithThunk'\nimport MediaChatView from './components/MediaChatView'\nimport ProfileEditView from './components/ProfileEditView'\nimport SideNavView from './components/SideNavView'\nimport { IconContext } from 'react-icons/lib'\nimport { Modal } from './modals'\nimport { NoteWallView } from './components/NoteWallView'\nimport { ModalView } from './components/ModalView'\nimport SettingsView from './components/SettingsView'\nimport MediaSelectorView from './components/MediaSelectorView'\nimport CodeOfConductView from './components/CodeOfConductView'\nimport ScheduleView from './components/ScheduleView'\nimport HelpView from './components/HelpView'\nimport MapModalView from './components/MapModalView'\nimport LoggedOutView from './components/LoggedOutView'\nimport WelcomeModalView from './components/WelcomeModalView'\nimport GoHomeView from './components/GoHomeView'\nimport YouAreBannedView from './components/YouAreBannedView'\nimport RoomListView from './components/RoomListView'\nimport RainbowGateModalView from './components/feature/RainbowGateViews'\nimport DullDoorModalView from './components/feature/DullDoorViews'\nimport ServerSettingsView from './components/ServerSettingsView'\nimport ClientDeployedModal from './components/ClientDeployedModal'\nimport FullRoomIndexModalView from './components/feature/FullRoomIndexViews'\nimport HappeningNowView from './components/HappeningNowView'\nimport VerifyEmailView from './components/VerifyEmailView'\nimport EmailVerifiedView from './components/EmailVerifiedView'\nimport RiddleModalView from './components/RiddleModal'\nimport * as Storage from './storage'\nimport { TwilioChatContextProvider } from './videochat/twilioChatContext'\nimport { currentUser, onAuthenticationStateChange } from './authentication'\nimport _ from 'lodash'\n\nexport const DispatchContext = createContext(null)\nexport const UserMapContext = createContext(null)\nexport const SettingsContext = createContext(null)\nexport const IsMobileContext = createContext(null)\nexport const RoomDataContext = createContext(null)\n\nconst App = () => {\n  const [state, dispatch] = useReducerWithThunk<Action, State>(\n    reducer,\n    defaultState\n  )\n\n  useEffect(() => {\n    // TODO: This flow has a lot of confusing, potentially duplicated messages that I'm not sure are necessary\n    // I (Em) started a refactor at one point, but abandoned it since it became too irrelevant from my task\n    onAuthenticationStateChange(async (user) => {\n      if (!user) {\n        dispatch(AuthenticateAction(undefined, undefined, undefined, undefined))\n      } else if (user.shouldVerifyEmail) {\n        const userId = user.id\n        const providerId = user.providerId\n        dispatch(AuthenticateAction(userId, userId, providerId, true))\n      } else {\n        const user = currentUser()\n        const userId = user.id\n        const providerId = user.providerId\n\n        const { registeredUsername, spaceIsClosed, isMod, isBanned } = await checkIsRegistered()\n        if (!registeredUsername) {\n          // If email, use ID to not leak, otherwise use service's default display name (for Twitter, their handle)\n          const defaultDisplayName = user.email\n            ? userId\n            : user.displayName\n          dispatch(\n            AuthenticateAction(userId, defaultDisplayName, providerId, false)\n          )\n          return\n        }\n\n        // TODO: I thiiiink we want this to be in an 'else'\n        dispatch(\n          AuthenticateAction(userId, registeredUsername, providerId, false)\n        )\n\n        if (isBanned) {\n          dispatch(\n            PlayerBannedAction({\n              id: userId,\n              username: registeredUsername,\n              isBanned: isBanned\n            })\n          )\n          dispatch(IsRegisteredAction())\n          return\n        }\n\n        if (spaceIsClosed) {\n          dispatch(SpaceIsClosedAction())\n\n          if (!isMod) {\n            // non-mods shouldn't subscribe to SignalR if the space is closed\n            dispatch(IsRegisteredAction())\n            return\n          }\n        }\n\n        const messageArchive = await Storage.getMessages()\n        if (messageArchive) {\n          dispatch(\n            LoadMessageArchiveAction(\n              messageArchive.messages,\n              messageArchive.whispers\n            )\n          )\n        }\n\n        const useSimpleNames = await Storage.getUseSimpleNames()\n        dispatch(SetUseSimpleNamesAction(useSimpleNames))\n        const keepCameraWhenMoving = await Storage.getKeepCameraWhenMoving()\n        dispatch(SetKeepCameraWhenMovingAction(keepCameraWhenMoving))\n        const textOnlyMode = await Storage.getTextOnlyMode()\n        dispatch(SetTextOnlyModeAction(textOnlyMode, false))\n        const captionsEnabled = await Storage.getCaptionsEnabled()\n        dispatch(SetCaptionsEnabledAction(captionsEnabled))\n\n        dispatch(IsRegisteredAction())\n        connect(userId, dispatch)\n        getServerSettings(dispatch)\n\n        // WARNING: Prior to the \"calculate number of faces for videochat\" code,\n        // there was a no-op resize handler here.\n        // window.addEventListener('resize', () => {})\n        // I frankly have no idea what this was doing,\n        // and worry my changes will cause unexpected errors\n        // -Em, 10/12/2021\n        window.addEventListener('resize', () => {})\n        const onResize = () => {\n          // It seems like a smell to do this in here and have to grab into #main,\n          // but I think it's fine?\n          const VideoWidth = 180\n          const $main = document.getElementById('main')\n          // Addendum: in Firefox on Windows sometimes we get into this function with 'main' as null!\n          if ($main) {\n            const numberOfFaces = Math.floor($main.clientWidth / VideoWidth) - 1\n            dispatch(SetNumberOfFacesAction(numberOfFaces))\n          } else {\n            console.warn('Attempted to call onResize when \\'main\\' element was null; will default to show no faces')\n          }\n        }\n\n        // Our initial paint time is stupid slow\n        // but waiting a long time seems to ensure that #main exists\n        setTimeout(onResize, 2000)\n        window.addEventListener('resize', _.throttle(onResize, 100, { trailing: true }))\n      }\n    })\n  }, [])\n\n  const isMobile = window.outerWidth < 500\n\n  const profile = state.visibleProfile ? (\n    <ProfileView user={state.visibleProfile} whispers={state.whispers} />\n  ) : (\n    ''\n  )\n\n  // This is kind of janky!\n  if (currentUser() && currentUser().isSignInWithEmailLink(window.location.href)) {\n    return <EmailVerifiedView />\n  }\n\n  if (!state.checkedAuthentication) {\n    return <div />\n  }\n\n  if (state.checkedAuthentication && state.mustVerifyEmail) {\n    return <VerifyEmailView\n      userEmail={currentUser().email}\n      dispatch={dispatch}\n    />\n  }\n\n  if (state.checkedAuthentication && !state.authenticated) {\n    return <LoggedOutView />\n  }\n\n  if (!state.hasRegistered) {\n    // Fetching the handle like this is silly.\n    return (\n      <ProfileEditView\n        isFTUE={true}\n        defaultHandle={state.userMap[state.userId].username}\n        user={state.profileData}\n        prepopulateTwitterWithDefaultHandle={state.authenticationProvider === 'twitter'}\n      />\n    )\n  }\n\n  if (state.isClosed && !state.userMap[state.userId].isMod) {\n    return <GoHomeView />\n  } else if (state.isBanned) {\n    return <YouAreBannedView />\n  }\n\n  // It's slightly weird we now construct this here and pass it as a prop to RoomView instead of constructing it there.\n  // Shrug, the conf is in 2 days.\n  let videoChatView\n  if (state.roomData && state.roomId && state.roomData[state.roomId] && state.roomData[state.roomId].mediaChat) {\n    videoChatView = (\n      <MediaChatView\n        visibleSpeakers={state.visibleSpeakers}\n        currentSpeaker={state.currentSpeaker}\n        numberOfFaces={state.numberOfFaces}\n        inMediaChat={state.inMediaChat}\n        textOnlyMode={state.textOnlyMode}\n        audioOnlyMode={state.audioOnlyMode}\n        currentUser={state.userMap[state.userId]}\n      />\n    )\n  }\n\n  let innerModalView, modalView\n\n  // TODO: If we get more modal options than just a size boolean, make this an options object.\n  let modalIsFullScreen = false\n\n  switch (state.activeModal) {\n    case Modal.ProfileEdit: {\n      innerModalView = (\n        <ProfileEditView\n          isFTUE={false}\n          defaultHandle={state.userMap[state.userId].username}\n          user={state.profileData}\n        />\n      )\n      break\n    }\n    case Modal.NoteWall: {\n      const room = state.roomData[state.roomId]\n      innerModalView = (\n        <NoteWallView notes={room.notes} noteWallData={room.noteWallData} user={state.profileData} serverSettings={state.serverSettings} />\n      )\n      break\n    }\n    case Modal.Settings: {\n      innerModalView = <SettingsView keepCameraWhenMoving={state.keepCameraWhenMoving} captionsEnabled={state.captionsEnabled} />\n      break\n    }\n    case Modal.MediaSelector: {\n      console.log('Opening media selector')\n      // TODO: Fix this userIsSpeaking (it was...broken in the first place but if we're bordering we should do it here)\n      innerModalView = (\n        <MediaSelectorView\n          showJoinButton={!state.inMediaChat || state.activeModalOptions.showJoinButton}\n          hideVideo={state.activeModalOptions.hideVideo}\n          userIsSpeaking={false}\n          roomId={state.roomId}\n          keepCameraWhenMoving={state.keepCameraWhenMoving}\n        />\n      )\n      break\n    }\n    case Modal.CodeOfConduct: {\n      innerModalView = <CodeOfConductView />\n      break\n    }\n    case Modal.Schedule: {\n      innerModalView = <ScheduleView />\n      break\n    }\n    case Modal.Map: {\n      modalIsFullScreen = true\n      innerModalView = (\n        <MapModalView roomData={state.roomData} currentRoomId={state.roomId} />\n      )\n      break\n    }\n    case Modal.RoomList: {\n      innerModalView = <RoomListView rooms={Object.values(state.roomData)} />\n      break\n    }\n    case Modal.Help: {\n      innerModalView = <HelpView />\n      break\n    }\n    case Modal.Welcome: {\n      innerModalView = <WelcomeModalView />\n      break\n    }\n    case Modal.ServerSettings: {\n      innerModalView = <ServerSettingsView serverSettings={state.serverSettings} roomData={state.roomData}/>\n      break\n    }\n    case Modal.ClientDeployed: {\n      innerModalView = <ClientDeployedModal />\n      break\n    }\n    case Modal.HappeningNow: {\n      innerModalView = <HappeningNowView roomData={state.roomData} entries={state.serverSettings.happeningNowEntries}/>\n      break\n    }\n    case Modal.FeatureRainbowGate: {\n      innerModalView = <RainbowGateModalView />\n      break\n    }\n    case Modal.FeatureDullDoor: {\n      innerModalView = <DullDoorModalView />\n      break\n    }\n    case Modal.FeatureFullRoomIndex: {\n      innerModalView = <FullRoomIndexModalView rooms={Object.values(state.roomData)}/>\n      break\n    }\n    case Modal.Riddles: {\n      const room = state.roomData[state.roomId]\n      innerModalView = <RiddleModalView riddles={room.riddles}/>\n      break\n    }\n  }\n\n  if (innerModalView) {\n    modalView = <ModalView fullScreen={modalIsFullScreen}>{innerModalView}</ModalView>\n  }\n\n  const showMenu = () => {\n    dispatch(ShowSideMenuAction())\n  }\n\n  const shouldShowMenu = !isMobile || state.mobileSideMenuIsVisible\n\n  // TODO: userMapContext should actually do the thing\n  return (\n    <IconContext.Provider value={{ style: { verticalAlign: 'middle' } }}>\n      <DispatchContext.Provider value={dispatch}>\n        <TwilioChatContextProvider active={!state.textOnlyMode}>\n          <IsMobileContext.Provider value={isMobile}>\n            <SettingsContext.Provider value={{ useSimpleNames: state.useSimpleNames }}>\n              <UserMapContext.Provider\n                value={{ userMap: state.userMap, myId: state.userId }}\n              >\n                <RoomDataContext.Provider value={state.roomData}>\n                  <div\n                    id={\n                      state.visibleProfile && !isMobile ? 'app-profile-open' : 'app'\n                    }\n                  >\n                    {shouldShowMenu ? (\n                      <span>\n                        <SideNavView\n                          roomData={state.roomData}\n                          currentRoomId={state.roomId}\n                          username={state.userMap[state.userId].username}\n                          spaceIsClosed={state.isClosed}\n                        />\n                        {/* Once we moved the sidebar to be position:fixed, we still\n                      needed something to take up its space in the CSS grid.\n                      This should be fixable via CSS, but sigh, it's 3 days before the event */}\n                        <div id=\"side-nav-placeholder\" />\n                      </span>\n                    ) : (\n                      <button id=\"show-menu\" onClick={showMenu}>\n                        <span role=\"img\" aria-label=\"menu\">\n                          \n                        </span>\n                      </button>\n                    )}\n                    {modalView}\n                    <div id=\"main\" role=\"main\">\n                      {state.roomData[state.roomId] ? (\n                        <RoomView\n                          room={state.roomData[state.roomId]}\n                          userId={state.userId}\n                          roomData={state.roomData}\n                          inMediaChat={state.inMediaChat}\n                          keepCameraWhenMoving={state.keepCameraWhenMoving}\n                          textOnlyMode={state.textOnlyMode}\n                          mediaChatView={videoChatView}\n                          hasDismissedAModal={state.hasDismissedAModal}\n                        />\n                      ) : null}\n                      <ChatView\n                        messages={state.messages}\n                        autoscrollChat={state.autoscrollChat}\n                        serverSettings={state.serverSettings}\n                        captionsEnabled={state.captionsEnabled}\n                      />\n                      <InputView\n                        prepopulated={state.prepopulatedInput}\n                        sendMessage={(message) =>\n                          dispatch(SendMessageAction(message))\n                        }\n                      />\n                    </div>\n                    {profile}\n                  </div>\n                </RoomDataContext.Provider>\n              </UserMapContext.Provider>\n            </SettingsContext.Provider>\n          </IsMobileContext.Provider>\n        </TwilioChatContextProvider>\n      </DispatchContext.Provider>\n    </IconContext.Provider>\n  )\n}\n\nexport default App\n","import * as React from 'react'\nimport * as ReactDOM from 'react-dom'\n\nimport App from './App'\nimport { currentTheme } from './storage'\n\nwindow.addEventListener('DOMContentLoaded', async () => {\n  ReactDOM.render(<App />, document.getElementById('root') as HTMLElement)\n  document.body.classList.add(await currentTheme())\n})\n"],"names":["$2a197d4f608fa3a6465a2f3645d91abf$var$isHappeningNowEntry","obj","text","String","roomId","externalLink","ValidColors","ValidFontRewards","$2a197d4f608fa3a6465a2f3645d91abf$export$d6cec79eba360c39","$2a197d4f608fa3a6465a2f3645d91abf$export$791e49fbaee75ea9","$0ab838c5afad036d99db4684627e1df8$export$e29dc9d0b3156690","messages","timestamp","$1qt4A$localforage","setItem","$0ab838c5afad036d99db4684627e1df8$var$messagesKey","$0ab838c5afad036d99db4684627e1df8$var$messageTimestampKey","Date","$0ab838c5afad036d99db4684627e1df8$export$b0ec3a30689a15f8","getItem","$0ab838c5afad036d99db4684627e1df8$var$rainbowGateKey","$0ab838c5afad036d99db4684627e1df8$export$6cc5ef8058a12688","value","$0ab838c5afad036d99db4684627e1df8$var$wasColoredEnteringKey","$0ab838c5afad036d99db4684627e1df8$export$a1e521263aeca5b5","$0ab838c5afad036d99db4684627e1df8$var$themeKey","$0ab838c5afad036d99db4684627e1df8$export$69edaf18c0511430","textOnlyMode","$0ab838c5afad036d99db4684627e1df8$var$textOnlyModeKey","$0ab838c5afad036d99db4684627e1df8$var$whisperKey","$0ab838c5afad036d99db4684627e1df8$var$useSimpleNamesKey","$0ab838c5afad036d99db4684627e1df8$var$keepCameraWhenMovingKey","$0ab838c5afad036d99db4684627e1df8$var$captionsEnabledKey","$ab5b6b469d9a2f53c3f68b1f1f4f2efb$export$d0df0905342a2aee","dispatch","$1qt4A$react","useContext","$8791d6f52d5819afb52c0630af87050d$export$9f652a6947b66421","id","className","createElement","onClick","async","visits","$0ab838c5afad036d99db4684627e1df8$export$ffec8796fff546bc","$3Wbh2","UpdateProfileColorAction","anEnum","enumValues","Object","values","Math","floor","random","length","randomEnum","ShowModalAction","$1qZWk","Modal","FeatureRainbowGate","userMap","myId","$1qt4A$useContext","$8791d6f52d5819afb52c0630af87050d$export$f7589c21cbdaef5e","setVisits","$1qt4A$useState","$1qt4A$useEffect","nameColor","$0a0d01af8e2324daf13b4ab9b3b6c0dd$export$b8a2ea075432b203","user","FeatureDullDoor","wasColoredEntering","setWasColoredEntering","$0ab838c5afad036d99db4684627e1df8$export$865401b7b6d9e2a5","HideModalAction","$41d15e40c9ce0f04a683ce7ac2520cd1$export$d358d052fffacdcf","FeatureFullRoomIndex","props","key","rooms","map","e","displayName","shortName","$d242012856b34ef5d8b1afe83fbb4858$export$98e23135daf3d467","generateFood","$3Loy2","pickUpRandomItemFromList","pickUpPuppy","pickUpItem","drinkPolymorph","sendChatMessage","$1qt4A$v4","drinkCancellation","getFortune","readPoster","displayMessageFromList","readClosedSign","getGameRec","pentagramHighTech","$d242012856b34ef5d8b1afe83fbb4858$var$pentagramAction","pentagramMinimalist","pentagramComical","pentagramNormal","hearPickupLine","watchRobot","font","updateFontReward","displayMessage","$a525784c833eebcfdbe2d3b85b7dd388$export$2972a848b7747dfa","_","Error","$136de75e0400a5f2fd7013f182dc974e$export$802aca7cf3aadbf","createContext","prepareForMediaChat","console","log","prepareMediaDevices","publishMedia","publishAudio","unpublishMedia","publishingCamera","publishingMic","cameras","mics","setCurrentCamera","setCurrentMic","currentMic","undefined","currentCamera","localStreamView","inCall","joinCallFailed","joinCall","leaveCall","callParticipants","cameraEnabled","micEnabled","setCameraEnabled","enabled","setMicEnabled","$136de75e0400a5f2fd7013f182dc974e$export$5f360cfba6a20588","$09a3441c0feae0d48a50137d8ecb8cc6$export$9099ad97b570f7c","item","dropItem","useSimpleNames","$8791d6f52d5819afb52c0630af87050d$export$77e26b0bd53d222f","userId","username","isMod","isBanned","player","playerIsMod","handleProfile","data","fetchProfile","banButton","$1qt4A$MenuItem","confirm","BanToggleAction","modButton","ModToggleAction","fontReward","customStyle","nowrap","pronouns","style","$1qt4A$ContextMenuTrigger","renderTag","holdToDisplay","polymorph","$1qt4A$ContextMenu","$1qt4A$reacttooltip","$faae6e746b7f3c2b3e83fa17e2bdeea4$export$9099ad97b570f7c","users","audioUsers","videoUsers","mediaUsers","Array","from","filter","p","audioTracks","size","identity","videoTracks","u","names","userViews","idx","$90b629751dd3f758ce0c9b79c686b931$export$9099ad97b570f7c","includes","$1qt4A$FaVolumeUp","$1qt4A$FaVideo","arr","slice","sep","reduce","xs","x","i","concat","$814c7fc8a3d2236c24164ceb76676a6e$export$ff6f9ae274b66c1a","announcements","onChosen","chosen","setChosen","Fragment","identifyAndSelect","selectedId","Number","valueOf","identified","find","info","streamId","onBlur","target","announcement","toString","$787591f149bca91805d74dce0e1c6e61$export$6da0c54d420de4fd","offline","peer","chatBuffer","setChatBuffer","requestingStream","setRequestingStream","stream","setStream","leave","streamStopCount","width","marginBottom","htmlFor","type","spellCheck","peerId","disabled","disconnect","requestFullscreen","ref","result","requestStream","$1qt4A$InputLevel","Gamepad","Mouse","Keyboard","toggleStream","stream1","join","$1qt4A$Rainway","connectingRuntime","setConnectingRuntime","runtime","setRuntime","peers","setPeers","setPeerId","connecting","setConnecting","connectError","setConnectError","makePeer","rt","$1qt4A$RainwayRuntime","initialize","apiKey","$715TH","default","RAINWAY_API_KEY","externalId","onRuntimeConnectionLost","rt1","error","onConnectionRequest","request","accept","onPeerMessage","ch","onPeerDataChannel","onPeerError","warn","onPeerStateChange","state","$1qt4A$RainwayPeerState","New","ps","Failed","onStreamAnnouncement","addAnnouncement","onStreamStop","streams","some","s","logSink","level","message","placeholder","onChange","connect","BigInt","createDataChannel","$1qt4A$RainwayChannelMode","Reliable","listStreams","replace","room","fullDescriptionVisible","setFullDescriptionVisible","mediaChat","hasDismissedAModal","keepCameraWhenMoving","leaveVideoChat","StopVideoChatAction","showNoteWall","NoteWall","noteWallView","hasNoteWall","noteWallData","$1qt4A$createElement","roomWallDescription","noteWallButton","JSON","stringify","$1qt4A$FaChevronUp","$1qt4A$FaChevronDown","getAttribute","moveToRoom","itemName","actionName","dangerouslySetInnerHTML","__html","$eff8625751ef5024a6f395a95f0a01fd$var$parseDescription","description","roomData","$eff8625751ef5024a6f395a95f0a01fd$export$af11fdaa7e0d53ef","$d73a7ad90054e43471fe69c7f5db2469$export$9099ad97b570f7c","specialFeatures","riddles","Riddles","mediaChatView","match","streamRef","$1qt4A$useRef","captionsRef","margin","title","height","src","frameBorder","allow","allowFullScreen","MessageType","$081118fa52f8c690b09433b7cc5505c3$export$8842eda039fa1d5f","$081118fa52f8c690b09433b7cc5505c3$export$778d708441736e4e","Chat","Emote","Shout","Dance","Caption","$081118fa52f8c690b09433b7cc5505c3$export$316d94e652aac09f","messageId","$081118fa52f8c690b09433b7cc5505c3$export$45313e3148e42d7","$081118fa52f8c690b09433b7cc5505c3$export$4b00e027a81f4247","senderIsSelf","Whisper","$081118fa52f8c690b09433b7cc5505c3$export$1462c2540a30e721","$081118fa52f8c690b09433b7cc5505c3$export$2d882037bf823912","command","Command","$4d25182c92271b22c85229ec7035b9ec$var$formatter","Intl","DateTimeFormat","hour","minute","component","Connected","$4d25182c92271b22c85229ec7035b9ec$var$ConnectedMessageView","Disconnected","$4d25182c92271b22c85229ec7035b9ec$var$DisconnectedMessageView","Entered","$4d25182c92271b22c85229ec7035b9ec$var$EnteredView","Left","$4d25182c92271b22c85229ec7035b9ec$var$LeftView","MovedRoom","$4d25182c92271b22c85229ec7035b9ec$var$MovedView","SameRoom","$4d25182c92271b22c85229ec7035b9ec$var$SameView","$4d25182c92271b22c85229ec7035b9ec$var$ChatMessageView","$4d25182c92271b22c85229ec7035b9ec$var$WhisperView","$4d25182c92271b22c85229ec7035b9ec$var$ShoutView","$4d25182c92271b22c85229ec7035b9ec$var$EmoteView","$4d25182c92271b22c85229ec7035b9ec$var$DanceView","$4d25182c92271b22c85229ec7035b9ec$var$CaptionView","$4d25182c92271b22c85229ec7035b9ec$var$ErrorView","Mod","$4d25182c92271b22c85229ec7035b9ec$var$ModMessageView","$4d25182c92271b22c85229ec7035b9ec$var$CommandView","date","msgIndex","hideTimestamp","format","$4d25182c92271b22c85229ec7035b9ec$var$handleDeleteMessage","deleteMessage","$4d25182c92271b22c85229ec7035b9ec$var$linkDecorator","href","rel","$4d25182c92271b22c85229ec7035b9ec$var$DeletableMessageView","$1qt4A$reactlinkify","componentDecorator","mouseButton","children","fromId","$8791d6f52d5819afb52c0630af87050d$export$d566d33d86336347","fromButton","hidden","fromName","toId","toButton","toName","to","openProfile","role","useEffect","lastMessage","document","querySelector","autoscrollChat","scrollTop","offsetTop","parentNode","shouldShowOlderMessages","setShouldShowOlderMessages","useState","shouldRemoveMessage","m","serverSettings","movementMessagesHideRoomIds","numUsersInRoom","movementMessagesHideThreshold","msg","captionsEnabled","lastIndexOfMovedMessage","$1qt4A$findLastIndex","currentRoomMessages","shownMessages","onScroll","messageWindow","isScrolledToBottom","scrollHeight","clientHeight","ActivateAutoscrollAction","DeactivateAutoscrollAction","previousMessage","getTime","shouldShowInterstitial","$4d25182c92271b22c85229ec7035b9ec$export$9099ad97b570f7c","input","setInput","sendMessage","getElementById","focus","prepopulated","$1qt4A$emojify","currentTarget","onKeyPress","autoComplete","$239972febef7f0243c0436450e567c10$var$SlashCommand","name","invocations","singleParameter","SlashCommandType","$239972febef7f0243c0436450e567c10$export$14694e926c7f97a5","$239972febef7f0243c0436450e567c10$export$2cd537a7ddeff3ce","Help","Move","ContactMod","Look","Interact","FIREBASE_CONFIG","$00d00685c5d3a80cf7221158eb131a4e$export$db8e392eecc8976c","firebaseApp","$1qt4A$firebaseapp","initializeApp","authenticated","checkedAuthentication","hasRegistered","whispers","visibleSpeakers","inMediaChat","activeModal","None","activeModalOptions","happeningNowEntries","spaceIsClosed","numberOfFaces","$00d00685c5d3a80cf7221158eb131a4e$export$9099ad97b570f7c","oldState","action","parse","prepopulatedInput","ActionType","ReceivedMyProfile","profileData","ReceivedServerSettings","UpdatedCurrentRoom","oldRoomId","Welcome","$00d00685c5d3a80cf7221158eb131a4e$var$addMessage","$081118fa52f8c690b09433b7cc5505c3$export$51e0a138cdbf3498","UpdatedRoomData","UpdatedPresence","keys","forEach","PlayerConnected","push","PlayerDisconnected","$081118fa52f8c690b09433b7cc5505c3$export$6ac0f7373afabc62","PlayerEntered","$081118fa52f8c690b09433b7cc5505c3$export$22b53a18e340c8f2","PlayerLeft","$081118fa52f8c690b09433b7cc5505c3$export$ab6e7f6fce4ee8f9","ChatMessage","CaptionMessage","whisperMessage","$00d00685c5d3a80cf7221158eb131a4e$var$saveWhisper","ModMessage","$081118fa52f8c690b09433b7cc5505c3$export$9dfa393034454223","DeleteMessage","$00d00685c5d3a80cf7221158eb131a4e$var$deleteMessage","targetMessageId","$081118fa52f8c690b09433b7cc5505c3$export$b3ae0cbd60f93c51","$081118fa52f8c690b09433b7cc5505c3$export$2e901d851d138f55","$081118fa52f8c690b09433b7cc5505c3$export$28186bb3d1c7e2fd","UserMap","visibleProfile","PlayerBanned","PlayerUnbanned","UpdateProfileColor","color","updateProfileColor","UpdateFontReward","MediaReceivedSpeakingData","currentSpeaker","oldestIndex","oldestTime","SetNumberOfFaces","StartVideoChat","StopVideoChat","SendMessage","trimmedMessage","trim","beginsWithSlash","exec","matching","invocation","startsWith","$1CoyE","MESSAGE_MAX_LENGTH","split","MESSAGE_MAX_WORD_LENGTH","commandStr","parsedUsernameMessage","SendCaption","sendCaption","StartWhisper","ShowProfile","HideProfile","ShowModal","ShowModalWithOptions","modal","options","ShowSideMenu","mobileSideMenuIsVisible","HideSideMenu","DeactivateAutoscroll","ActivateAutoscroll","SetUseSimpleNames","$0ab838c5afad036d99db4684627e1df8$export$c75426b68f516947","SetKeepCameraWhenMoving","$0ab838c5afad036d99db4684627e1df8$export$65e7c79c8525744b","SetCaptionsEnabled","$0ab838c5afad036d99db4684627e1df8$export$a88ffad62dc8e00a","SetTextOnlyMode","refresh","then","window","location","reload","SetAudioOnlyMode","audioOnlyMode","Authenticate","authenticationProvider","provider","mustVerifyEmail","IsRegistered","BanToggle","toggleUserBan","ModToggle","toggleUserMod","LoadMessageArchive","NoteAdd","notes","note","NoteRemove","n","noteId","NoteUpdateLikes","likes","NoteUpdateRoom","SpaceIsClosed","isClosed","SpaceOpenedOrClosed","CommandMessage","$0ab838c5afad036d99db4684627e1df8$export$b5904ee2ea7c6929","$22f5c59dd494ba312a67dfeed417029a$var$ProfileWhisperView","otherUser","whisperMessages","realName","twitterHandle","url","askMeAbout","HideProfileAction","$5d8c0ef7811962f2350daa36a485a5d4$export$9099ad97b570f7c","SendMessageAction","$1qt4A$FaUser","textAlign","hideUI","$1qt4A$FaVideoSlash","$1qt4A$FaVolumeMute","MediaSelector","$1qt4A$FaCog","track","audioEl","current","attach","setAttribute","body","appendChild","detach","el","remove","isLocal","priority","mediaStreamTrack","setMediaStreamTrack","handleStarted","on","off","$64d7d4d66971e6429af1ad2035770748$export$9099ad97b570f7c","dimensions","setDimensions","handleDimensionsChanged","track1","$c08ca7ee7082f94a062a9884db20c273$export$9099ad97b570f7c","isPortrait","muted","setPriority","isFrontFacing","getSettings","facingMode","transform","objectFit","publication","isLocalParticipant","videoOnly","videoPriority","setTrack","removeTrack","$c41c9397be97098525edc9d8313b7475$export$9099ad97b570f7c","kind","$8bd1fd4b611e7c0320af8f713f8660c5$export$9099ad97b570f7c","$d0b3a5eb6544a4f6d83426ca88c7fc0d$export$9099ad97b570f7c","participant","displayVideo","displayAudio","publications","setPublications","tracks","publicationAdded","prevPublications","publicationRemoved","$8600130c989bf68b8d4c57c832853566$export$9099ad97b570f7c","videoPublications","audioPublications","finalPublications","$6bd29315db20ac64ee35c6a600d3c73c$export$9099ad97b570f7c","playVideo","setPlayVideo","renderAsFace","playAudio","setPlayAudio","border","isDominant","$fca75816eb7ab26ac3f2bc7c04743272$export$9099ad97b570f7c","hasVideoTracks","placeholderAvatar","$5d1c9a5ef0ffd79864d7d8e073fac2ef$export$9099ad97b570f7c","showMediaSelector","chatButtons","leaveButtonLabel","SetTextOnlyModeAction","canJoinVideoChat","ShowModalWithOptionsAction","hideVideo","offscreenLabel","totalCount","SetAudioOnlyModeAction","disableTextMode","marginLeft","playerVideo","$247bc07bda9210629acaccda0ca9a58e$export$9099ad97b570f7c","speaking","participants","videoParticipantIds","audioParticipantIds","shift","videoParticipants","$0324cbacac62b5aa5c2f2b0fdea55586$export$9099ad97b570f7c","audioParticipants","currentUser","offscreenCount","$382fe6ac57d014d1d8942128aa06e6c0$var$crushSpaces","defaultHandle","prepopulateTwitterWithDefaultHandle","handle","setHandle","setRealName","setPronouns","setDescription","setAskMeAbout","setUrl","twitter","setTwitter","isFTUE","marginTop","localeCompare","updateProfile","hostname","SERVER_HOSTNAME","toggleSpaceItem","openOrCloseSpace","ProfileEdit","Settings","ServerSettings","$1REsD","signOut","catch","currentRoomId","w","h","isMiniMap","scrollIntoView","block","inline","$17b39333051ac6c91e15267fe895b7da$var$mapText","$17b39333051ac6c91e15267fe895b7da$var$presenceMapping","replaceString","padEnd","padStart","handleClick","clickableDivs","$17b39333051ac6c91e15267fe895b7da$var$clickableAreas","a","position","left","top","y","cursor","letterSpacing","fontFamily","onClickCapture","Map","stopPropagation","$17b39333051ac6c91e15267fe895b7da$export$9099ad97b570f7c","isMobile","$8791d6f52d5819afb52c0630af87050d$export$d1f8493de3b79ff7","HideSideMenuAction","$5de9767b454e653da16062eb491aabdd$export$9099ad97b570f7c","HappeningNow","$d6f8d93e81493d2f441f84767cb0beb5$var$MenuItem","Schedule","RoomList","CodeOfConduct","$f4af79cc6edfd04a6afa8563d4e9d524$export$9099ad97b570f7c","$dbf5cb8f76d3f9827a15fcf4be7641dc$export$e1a1893ca523e152","canDelete","authorId","canLike","hasLiked","likeNames","l","deleteRoomNote","unlikeRoomNote","likeRoomNote","$1qt4A$FaThumbsUp","$1qt4A$FaRegThumbsUp","$1697310038cd980cbde208598c272d78$var$UNCONFERENCING_ROOM_IDS","$1697310038cd980cbde208598c272d78$var$numLikes","roomNote","$1697310038cd980cbde208598c272d78$export$d6d3a20c46c3f26e","noteViews","sort","b","aLikes","noteWallDescription","buttonText","addNoteLinkText","massDeleteButton","setAsUnconferencingTopicsButton","settingsCopy","sortedDescending","newEntries","min","updateServerSettings","promptText","addNotePrompt","prompt","addNoteToWall","$fb8af0e51904493b7887fd1ad70b3a08$export$924a7d7136bc2091","keyListener","keyCode","addEventListener","removeEventListener","close","$1qt4A$reactdom","createPortal","fullScreen","handleKeepCameraWhenMovingSelection","event","newValue","SetKeepCameraWhenMovingAction","checked","selectedTheme","setSelectedTheme","handleThemeSelection","classList","theme","$0ab838c5afad036d99db4684627e1df8$export$4fe6b6a240f01bb0","handleSimpleNamesSelection","simple","SetUseSimpleNamesAction","handleCaptionChoice","SetCaptionsEnabledAction","$070dd344294111e6a4a7afa8de488b5d$export$9099ad97b570f7c","run","deviceToOption","d","video","defaultValue","display","userIsSpeaking","$f410f86fc7b1eb572d5e95b2a1c6ed11$var$ScheduleEntry","time","day","roomIds","breakoutRoomId","time1","dayTwoDate","$f410f86fc7b1eb572d5e95b2a1c6ed11$export$fceef558649e6397","formatter","userTimeZone","resolvedOptions","timeZone","rows","flatMap","r","colSpan","$ea01c535eedffcc7a9a11480ce5dbe42$var$uiConfig","callbacks","signInSuccessWithAuthResult","authResult","redirectUrl","shouldVerifyEmail","sendSignInLinkToEmail","email","signInOptions","auth","EmailAuthProvider","PROVIDER_ID","GoogleAuthProvider","TwitterAuthProvider","$1qt4A$reactfirebaseuiStyledFirebaseAuth","uiConfig","firebaseAuth","list","$3dc9c6e8efbb99d2ddbd6c8910472468$var$RoomListItem","userCount","videoIcon","listStyle","newSettings","setNewSettings","addHappeningNowText","setAddHappeningNowText","addHappeningNowRoomId","setAddHappeningNowRoomId","addHappeningNowExternalLink","setAddHappeningNowExternalLink","submit","parsedNewSettings","every","$2a197d4f608fa3a6465a2f3645d91abf$export$dd9c3052d7aa062e","alert","resetRoomData","entry","deleteHappeningNowEntry","cols","$e8c1b64c9310e58dcfad6349e75fdc77$var$ReversedScheduleEntries","reverse","now","currentlyScheduledIdx","findIndex","currentlyScheduled","moveAndClose","currentlyScheduledElement","socialTimeOptions","breakoutEntry","discussString","entries","$1qt4A$reactpagevisibility","visibility","AuthenticateAction","providerId","userEmail","emailVerified","signInWithEmailLink","riddleViews","val","index","riddleTitle","$b3905b16eb4692196031988200b22a3b$var$recognizer","$b3905b16eb4692196031988200b22a3b$var$speechConfig","$b3905b16eb4692196031988200b22a3b$export$ac82d96b8e6f6059","stopContinuousRecognitionAsync","$063937ab506278213b0ae028793d0d4c$export$7fc4b01ba6272b61","token","setToken","setRoomId","setRoom","setJoinCallFailed","setCameras","setMics","setCurrentMicInternal","setCurrentCameraInternal","setPublishingCamera","setPublishingMic","remoteParticipants","setRemoteParticipants","localVideoTrack","setLocalVideoTrack","localAudioTrack","setLocalAudioTrack","setLocalStreamView","startTranscription","deviceId","cognitiveServicesKey","cognitiveServicesRegion","fetchCognitiveServicesKey","$1qt4A$SpeechConfig","fromSubscription","audioConfig","$1qt4A$AudioConfig","fromMicrophoneInput","$1qt4A$SpeechRecognizer","recognizing","recognized","reason","$1qt4A$ResultReason","RecognizedSpeech","SendCaptionAction","NoMatch","canceled","$1qt4A$CancellationReason","errorCode","errorDetails","sessionStopped","startContinuousRecognitionAsync","$b3905b16eb4692196031988200b22a3b$export$3bf82eea8420f6d0","stopTranscription","StartVideoChatAction","localParticipant","publishTrack","restart","publishVideo","enable","stop","unpublishTrack","disable","roomId1","shouldPublishTracks","active","opts","maxAudioBitrate","bandwidthProfile","mode","maxTracks","renderDimensions","high","standard","low","preferredVideoCodecs","codec","simulcast","dominantSpeaker","newRoom","$1qt4A$connect","MediaReceivedSpeakingDataAction","RefreshReactAction","frameRate","exact","$1qt4A$createLocalVideoTrack","fetchLocalVideoTrack","trackObj","audio","$1qt4A$createLocalAudioTrack","fetchLocalAudioTrack","Provider","fetchTwilioToken","token1","mapToDeviceInfo","label","navigator","mediaDevices","getUserMedia","getTracks","t","enumerateDevices","devices","cameras1","mics1","c","$1qt4A$createContext","$8791d6f52d5819afb52c0630af87050d$export$9099ad97b570f7c","$7zAPm","useReducerWithThunk","onAuthenticationStateChange","user1","registeredUsername","checkIsRegistered","defaultDisplayName","PlayerBannedAction","IsRegisteredAction","SpaceIsClosedAction","messageArchive","err","$0ab838c5afad036d99db4684627e1df8$export$ca17a3c854de247d","LoadMessageArchiveAction","$0ab838c5afad036d99db4684627e1df8$export$4455bbc670767fbf","$0ab838c5afad036d99db4684627e1df8$export$9b8c234266723bd3","$0ab838c5afad036d99db4684627e1df8$export$37f6a4a4e50a9e8d","$0ab838c5afad036d99db4684627e1df8$export$ec5faae163a0aa9a","getServerSettings","onResize","$main","clientWidth","SetNumberOfFacesAction","setTimeout","$1qt4A$lodash","throttle","trailing","outerWidth","profile","$22f5c59dd494ba312a67dfeed417029a$export$9099ad97b570f7c","isSignInWithEmailLink","$c2936714bdd8164c01bbe0409da6cb83$export$9099ad97b570f7c","$6413a0abbc1e1e32860b98470406a41c$export$9099ad97b570f7c","$ea01c535eedffcc7a9a11480ce5dbe42$export$9099ad97b570f7c","$382fe6ac57d014d1d8942128aa06e6c0$export$9099ad97b570f7c","$8c1dd74cc7c7357de960c8d5e0ec2aef$export$9099ad97b570f7c","$50b9789cc46e8493202b7712ba0e5f97$export$9099ad97b570f7c","videoChatView","innerModalView","modalView","$2f41a850433811f55661c8b3dea88379$export$9099ad97b570f7c","modalIsFullScreen","$229ac4903a321782c49f910651119b21$export$9099ad97b570f7c","$acb843129630c1f57084900ca8671573$export$9099ad97b570f7c","showJoinButton","$f87cc1cf2b07e9a8b5218de39586993b$export$9099ad97b570f7c","$f410f86fc7b1eb572d5e95b2a1c6ed11$export$9099ad97b570f7c","$37a6a5f37cb4b115c6ad103f4f184148$export$9099ad97b570f7c","$3dc9c6e8efbb99d2ddbd6c8910472468$export$9099ad97b570f7c","$d90d57c462b3c4dc9e2450652fb39e7c$export$9099ad97b570f7c","$5e60260bb40ed88c4a0fb550d5363bd1$export$9099ad97b570f7c","$1183c70a667bb840e80013e81082bacf$export$9099ad97b570f7c","ClientDeployed","$fffeaa997d2d7172db39ed78531c23b3$export$9099ad97b570f7c","$e8c1b64c9310e58dcfad6349e75fdc77$export$9099ad97b570f7c","$ab5b6b469d9a2f53c3f68b1f1f4f2efb$export$9099ad97b570f7c","$0a0d01af8e2324daf13b4ab9b3b6c0dd$export$9099ad97b570f7c","$41d15e40c9ce0f04a683ce7ac2520cd1$export$9099ad97b570f7c","$aaa1dc765ca71fbf36fadcd9deec9f55$export$9099ad97b570f7c","shouldShowMenu","$1qt4A$IconContext","verticalAlign","$d6f8d93e81493d2f441f84767cb0beb5$export$9099ad97b570f7c","ShowSideMenuAction","$eff8625751ef5024a6f395a95f0a01fd$export$9099ad97b570f7c","$9a9b57b4a80125afc5540d96d5e59661$export$9099ad97b570f7c","$1qt4A$render","add"],"version":3,"file":"index.2c0df1d1.js.map","sourceRoot":"../"}